#ifdef OMC_BASE_FILE
#define OMC_FILE OMC_BASE_FILE
#else
#define OMC_FILE "/home/mahge/dev/OpenModelica/OMCompiler/Compiler/boot/build/tmp/ComponentReference.c"
#endif
#include "omc_simulation_settings.h"
#include "ComponentReference.h"
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT0,1,11) {&DAE_Type_T__UNKNOWN__desc,}};
#define _OMC_LIT0 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT0)
#define _OMC_LIT1_data "$pDER"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT1,5,_OMC_LIT1_data);
#define _OMC_LIT1 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT1)
#define _OMC_LIT2_data "["
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT2,1,_OMC_LIT2_data);
#define _OMC_LIT2 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT2)
#define _OMC_LIT3_data ","
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT3,1,_OMC_LIT3_data);
#define _OMC_LIT3 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT3)
#define _OMC_LIT4_data ":"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT4,1,_OMC_LIT4_data);
#define _OMC_LIT4 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT4)
#define _OMC_LIT5_data "%d"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT5,2,_OMC_LIT5_data);
#define _OMC_LIT5 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT5)
#define _OMC_LIT6_data "]"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT6,1,_OMC_LIT6_data);
#define _OMC_LIT6 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT6)
#define _OMC_LIT7_data "der("
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT7,4,_OMC_LIT7_data);
#define _OMC_LIT7 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT7)
#define _OMC_LIT8_data ")"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT8,1,_OMC_LIT8_data);
#define _OMC_LIT8 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT8)
#define _OMC_LIT9_data "previous("
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT9,9,_OMC_LIT9_data);
#define _OMC_LIT9 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT9)
#define _OMC_LIT10_data "."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT10,1,_OMC_LIT10_data);
#define _OMC_LIT10 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT10)
#define _OMC_LIT11_data "$DER"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT11,4,_OMC_LIT11_data);
#define _OMC_LIT11 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT11)
#define _OMC_LIT12_data "$CLKPRE"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT12,7,_OMC_LIT12_data);
#define _OMC_LIT12 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT12)
#define _OMC_LIT13_data "_P"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT13,2,_OMC_LIT13_data);
#define _OMC_LIT13 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT13)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT14,1,5) {&ErrorTypes_MessageType_TRANSLATION__desc,}};
#define _OMC_LIT14 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT14)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT15,1,4) {&ErrorTypes_Severity_ERROR__desc,}};
#define _OMC_LIT15 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT15)
#define _OMC_LIT16_data "Subscript '%s' for dimension %s (size = %s) of %s is out of bounds."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT16,67,_OMC_LIT16_data);
#define _OMC_LIT16 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT16)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT17,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT16}};
#define _OMC_LIT17 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT17)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT18,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(99)),_OMC_LIT14,_OMC_LIT15,_OMC_LIT17}};
#define _OMC_LIT18 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT18)
#define _OMC_LIT19_data "$P"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT19,2,_OMC_LIT19_data);
#define _OMC_LIT19 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT19)
#define _OMC_LIT20_data "function ComponentReference.makeCrefsFromSubScriptExp for:"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT20,58,_OMC_LIT20_data);
#define _OMC_LIT20 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT20)
#define _OMC_LIT21_data "\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT21,1,_OMC_LIT21_data);
#define _OMC_LIT21 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT21)
#define _OMC_LIT22_data "/home/mahge/dev/OpenModelica/OMCompiler/Compiler/FrontEnd/ComponentReference.mo"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT22,79,_OMC_LIT22_data);
#define _OMC_LIT22 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT22)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT23_6,1605721860.0);
#define _OMC_LIT23_6 MMC_REFREALLIT(_OMC_LIT_STRUCT23_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT23,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT22,MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(3563)),MMC_IMMEDIATE(MMC_TAGFIXNUM(7)),MMC_IMMEDIATE(MMC_TAGFIXNUM(3563)),MMC_IMMEDIATE(MMC_TAGFIXNUM(118)),_OMC_LIT23_6}};
#define _OMC_LIT23 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT23)
#define _OMC_LIT24_data "function ComponentReference.makeCrefsFromSubScriptLst for:"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT24,58,_OMC_LIT24_data);
#define _OMC_LIT24 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT24)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT25_6,1605721860.0);
#define _OMC_LIT25_6 MMC_REFREALLIT(_OMC_LIT_STRUCT25_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT25,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT22,MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(3519)),MMC_IMMEDIATE(MMC_TAGFIXNUM(9)),MMC_IMMEDIATE(MMC_TAGFIXNUM(3519)),MMC_IMMEDIATE(MMC_TAGFIXNUM(120)),_OMC_LIT25_6}};
#define _OMC_LIT25 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT25)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT26,1,3) {&DAE_Subscript_WHOLEDIM__desc,}};
#define _OMC_LIT26 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT26)
#define _OMC_LIT27_data "failtrace"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT27,9,_OMC_LIT27_data);
#define _OMC_LIT27 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT27)
#define _OMC_LIT28_data "Sets whether to print a failtrace or not."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT28,41,_OMC_LIT28_data);
#define _OMC_LIT28 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT28)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT29,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT28}};
#define _OMC_LIT29 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT29)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT30,5,3) {&Flags_DebugFlag_DEBUG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),_OMC_LIT27,MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),_OMC_LIT29}};
#define _OMC_LIT30 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT30)
#define _OMC_LIT31_data "- ComponentReference.expandCref failed on "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT31,42,_OMC_LIT31_data);
#define _OMC_LIT31 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT31)
#define _OMC_LIT32_data "{"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT32,1,_OMC_LIT32_data);
#define _OMC_LIT32 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT32)
#define _OMC_LIT33_data ", "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT33,2,_OMC_LIT33_data);
#define _OMC_LIT33 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT33)
#define _OMC_LIT34_data "}\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT34,2,_OMC_LIT34_data);
#define _OMC_LIT34 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT34)
#define _OMC_LIT35_data "}"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT35,1,_OMC_LIT35_data);
#define _OMC_LIT35 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT35)
#define _OMC_LIT36_data "_L"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT36,2,_OMC_LIT36_data);
#define _OMC_LIT36 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT36)
#define _OMC_LIT37_data "_R"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT37,2,_OMC_LIT37_data);
#define _OMC_LIT37 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT37)
#define _OMC_LIT38_data "_"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT38,1,_OMC_LIT38_data);
#define _OMC_LIT38 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT38)
#define _OMC_LIT39_data "__"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT39,2,_OMC_LIT39_data);
#define _OMC_LIT39 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT39)
#define _OMC_LIT40_data ""
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT40,0,_OMC_LIT40_data);
#define _OMC_LIT40 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT40)
#define _OMC_LIT41_data "WARNING - Expression.replaceCref_SliceSub setting subscript last, not containing dimension\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT41,91,_OMC_LIT41_data);
#define _OMC_LIT41 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT41)
#define _OMC_LIT42_data "- Expression.replaceCref_SliceSub failed\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT42,41,_OMC_LIT42_data);
#define _OMC_LIT42 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT42)
#define _OMC_LIT43_data "function ComponentReference.crefApplySubs to non array\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT43,55,_OMC_LIT43_data);
#define _OMC_LIT43 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT43)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT44_6,1605721860.0);
#define _OMC_LIT44_6 MMC_REFREALLIT(_OMC_LIT_STRUCT44_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT44,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT22,MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(2497)),MMC_IMMEDIATE(MMC_TAGFIXNUM(9)),MMC_IMMEDIATE(MMC_TAGFIXNUM(2497)),MMC_IMMEDIATE(MMC_TAGFIXNUM(105)),_OMC_LIT44_6}};
#define _OMC_LIT44 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT44)
#define _OMC_LIT45_data "$START"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT45,6,_OMC_LIT45_data);
#define _OMC_LIT45 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT45)
#define _OMC_LIT46_data "$PRE"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT46,4,_OMC_LIT46_data);
#define _OMC_LIT46 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT46)
#define _OMC_LIT47_data "$AUX"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT47,4,_OMC_LIT47_data);
#define _OMC_LIT47 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT47)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT48,2,4) {&DAE_Type_T__REAL__desc,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT48 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT48)
#define _OMC_LIT49_data "$concealed"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT49,10,_OMC_LIT49_data);
#define _OMC_LIT49 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT49)
#define _OMC_LIT50_data "Cpp"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT50,3,_OMC_LIT50_data);
#define _OMC_LIT50 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT50)
#define _OMC_LIT51_data "-ComponentReference.crefType failed on Cref:"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT51,44,_OMC_LIT51_data);
#define _OMC_LIT51 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT51)
#define _OMC_LIT52_data "ComponentReference.crefType failed on cref: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT52,44,_OMC_LIT52_data);
#define _OMC_LIT52 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT52)
#define _OMC_LIT53_data "ComponentReference.crefTypeFull2 failed on cref: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT53,49,_OMC_LIT53_data);
#define _OMC_LIT53 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT53)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT54,2,3) {&DAE_Exp_ICONST__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(1))}};
#define _OMC_LIT54 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT54)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT55,2,5) {&DAE_Subscript_INDEX__desc,_OMC_LIT54}};
#define _OMC_LIT55 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT55)
#define _OMC_LIT56_data "traverseCref failed!"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT56,20,_OMC_LIT56_data);
#define _OMC_LIT56 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT56)
#define _OMC_LIT57_data "$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT57,1,_OMC_LIT57_data);
#define _OMC_LIT57 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT57)
#define _OMC_LIT58_data " ["
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT58,2,_OMC_LIT58_data);
#define _OMC_LIT58 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT58)
#define _OMC_LIT59_data "] ."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT59,3,_OMC_LIT59_data);
#define _OMC_LIT59 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT59)
#define _OMC_LIT60_data "] __"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT60,4,_OMC_LIT60_data);
#define _OMC_LIT60 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT60)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT61,2,0) {_OMC_LIT36,_OMC_LIT37}};
#define _OMC_LIT61 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT61)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT62,2,0) {_OMC_LIT2,_OMC_LIT6}};
#define _OMC_LIT62 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT62)
#define _OMC_LIT63_data "/* iter index "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT63,14,_OMC_LIT63_data);
#define _OMC_LIT63 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT63)
#define _OMC_LIT64_data " */"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT64,3,_OMC_LIT64_data);
#define _OMC_LIT64 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT64)
#define _OMC_LIT65_data "NONE()"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT65,6,_OMC_LIT65_data);
#define _OMC_LIT65 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT65)
#define _OMC_LIT66_data "SOME("
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT66,5,_OMC_LIT66_data);
#define _OMC_LIT66 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT66)
#define _OMC_LIT67_data "modelicaOutput"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT67,14,_OMC_LIT67_data);
#define _OMC_LIT67 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT67)
#define _OMC_LIT68_data "m"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT68,1,_OMC_LIT68_data);
#define _OMC_LIT68 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT68)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT69,1,1) {_OMC_LIT68}};
#define _OMC_LIT69 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT69)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT70,1,4) {&Flags_FlagVisibility_EXTERNAL__desc,}};
#define _OMC_LIT70 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT70)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT71,2,4) {&Flags_FlagData_BOOL__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(0))}};
#define _OMC_LIT71 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT71)
#define _OMC_LIT72_data "Enables valid modelica output for flat modelica."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT72,48,_OMC_LIT72_data);
#define _OMC_LIT72 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT72)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT73,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT72}};
#define _OMC_LIT73 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT73)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT74,8,3) {&Flags_ConfigFlag_CONFIG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(21)),_OMC_LIT67,_OMC_LIT69,_OMC_LIT70,_OMC_LIT71,MMC_REFSTRUCTLIT(mmc_none),_OMC_LIT73}};
#define _OMC_LIT74 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT74)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT75,1,7) {&DAE_ComponentRef_WILD__desc,}};
#define _OMC_LIT75 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT75)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT76,1,3) {&Absyn_Subscript_NOSUB__desc,}};
#define _OMC_LIT76 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT76)
#define _OMC_LIT77_data "ComponentReference.unelabCref failed on: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT77,41,_OMC_LIT77_data);
#define _OMC_LIT77 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT77)
#define _OMC_LIT78_data "dummy"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT78,5,_OMC_LIT78_data);
#define _OMC_LIT78 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT78)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT79,4,4) {&DAE_ComponentRef_CREF__IDENT__desc,_OMC_LIT78,_OMC_LIT0,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT79 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT79)
#include "util/modelica.h"
#include "ComponentReference_includes.h"
#if !defined(PROTECTED_FUNCTION_STATIC)
#define PROTECTED_FUNCTION_STATIC
#endif
PROTECTED_FUNCTION_STATIC void omc_ComponentReference_printSubscriptBoundsError(threadData_t *threadData, modelica_metatype _inSubscriptExp, modelica_metatype _inDimension, modelica_integer _inIndex, modelica_metatype _inCref, modelica_metatype _inInfo);
PROTECTED_FUNCTION_STATIC void boxptr_ComponentReference_printSubscriptBoundsError(threadData_t *threadData, modelica_metatype _inSubscriptExp, modelica_metatype _inDimension, modelica_metatype _inIndex, modelica_metatype _inCref, modelica_metatype _inInfo);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_printSubscriptBoundsError,2,0) {(void*) boxptr_ComponentReference_printSubscriptBoundsError,0}};
#define boxvar_ComponentReference_printSubscriptBoundsError MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_printSubscriptBoundsError)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ComponentReference_subscriptExpOutOfBounds(threadData_t *threadData, modelica_integer _inDimSize, modelica_metatype _inSubscriptExp);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_subscriptExpOutOfBounds(threadData_t *threadData, modelica_metatype _inDimSize, modelica_metatype _inSubscriptExp);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_subscriptExpOutOfBounds,2,0) {(void*) boxptr_ComponentReference_subscriptExpOutOfBounds,0}};
#define boxvar_ComponentReference_subscriptExpOutOfBounds MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_subscriptExpOutOfBounds)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ComponentReference_checkCrefSubscriptBounds(threadData_t *threadData, modelica_metatype _inSubscript, modelica_metatype _inDimension, modelica_integer _inIndex, modelica_metatype _inWholeCref, modelica_metatype _inInfo);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_checkCrefSubscriptBounds(threadData_t *threadData, modelica_metatype _inSubscript, modelica_metatype _inDimension, modelica_metatype _inIndex, modelica_metatype _inWholeCref, modelica_metatype _inInfo);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_checkCrefSubscriptBounds,2,0) {(void*) boxptr_ComponentReference_checkCrefSubscriptBounds,0}};
#define boxvar_ComponentReference_checkCrefSubscriptBounds MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_checkCrefSubscriptBounds)
PROTECTED_FUNCTION_STATIC void omc_ComponentReference_checkCrefSubscriptsBounds4(threadData_t *threadData, modelica_metatype _inSubscripts, modelica_metatype _inDimensions, modelica_integer _inIndex, modelica_metatype _inWholeCref, modelica_metatype _inInfo);
PROTECTED_FUNCTION_STATIC void boxptr_ComponentReference_checkCrefSubscriptsBounds4(threadData_t *threadData, modelica_metatype _inSubscripts, modelica_metatype _inDimensions, modelica_metatype _inIndex, modelica_metatype _inWholeCref, modelica_metatype _inInfo);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_checkCrefSubscriptsBounds4,2,0) {(void*) boxptr_ComponentReference_checkCrefSubscriptsBounds4,0}};
#define boxvar_ComponentReference_checkCrefSubscriptsBounds4 MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_checkCrefSubscriptsBounds4)
PROTECTED_FUNCTION_STATIC void omc_ComponentReference_checkCrefSubscriptsBounds3(threadData_t *threadData, modelica_metatype _inCrefType, modelica_metatype _inSubscripts, modelica_metatype _inWholeCref, modelica_metatype _inInfo);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_checkCrefSubscriptsBounds3,2,0) {(void*) boxptr_ComponentReference_checkCrefSubscriptsBounds3,0}};
#define boxvar_ComponentReference_checkCrefSubscriptsBounds3 MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_checkCrefSubscriptsBounds3)
PROTECTED_FUNCTION_STATIC void omc_ComponentReference_checkCrefSubscriptsBounds2(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _inWholeCref, modelica_metatype _inInfo);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_checkCrefSubscriptsBounds2,2,0) {(void*) boxptr_ComponentReference_checkCrefSubscriptsBounds2,0}};
#define boxvar_ComponentReference_checkCrefSubscriptsBounds2 MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_checkCrefSubscriptsBounds2)
PROTECTED_FUNCTION_STATIC modelica_integer omc_ComponentReference_identifierCount__tail(threadData_t *threadData, modelica_metatype _inCref, modelica_integer _inAccumCount);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_identifierCount__tail(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _inAccumCount);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_identifierCount__tail,2,0) {(void*) boxptr_ComponentReference_identifierCount__tail,0}};
#define boxvar_ComponentReference_identifierCount__tail MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_identifierCount__tail)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_implode__tail(threadData_t *threadData, modelica_metatype _inParts, modelica_metatype _inAccumCref);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_implode__tail,2,0) {(void*) boxptr_ComponentReference_implode__tail,0}};
#define boxvar_ComponentReference_implode__tail MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_implode__tail)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_explode__tail(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _inParts);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_explode__tail,2,0) {(void*) boxptr_ComponentReference_explode__tail,0}};
#define boxvar_ComponentReference_explode__tail MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_explode__tail)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_expandArrayCref1(threadData_t *threadData, modelica_metatype _inCr, modelica_metatype _inSubscripts, modelica_metatype _inAccumSubs, modelica_metatype _inAccumCrefs);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_expandArrayCref1,2,0) {(void*) boxptr_ComponentReference_expandArrayCref1,0}};
#define boxvar_ComponentReference_expandArrayCref1 MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_expandArrayCref1)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_expandCref2(threadData_t *threadData, modelica_string _inId, modelica_metatype _inType, modelica_metatype _inSubscripts, modelica_metatype _inDimensions);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_expandCref2,2,0) {(void*) boxptr_ComponentReference_expandCref2,0}};
#define boxvar_ComponentReference_expandCref2 MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_expandCref2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_expandCrefQual(threadData_t *threadData, modelica_metatype _inHeadCrefs, modelica_metatype _inRestCrefs);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_expandCrefQual,2,0) {(void*) boxptr_ComponentReference_expandCrefQual,0}};
#define boxvar_ComponentReference_expandCrefQual MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_expandCrefQual)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_expandCrefLst(threadData_t *threadData, modelica_metatype _inCrefs, modelica_metatype _varLst, modelica_metatype _inCrefsAcc);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_expandCrefLst,2,0) {(void*) boxptr_ComponentReference_expandCrefLst,0}};
#define boxvar_ComponentReference_expandCrefLst MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_expandCrefLst)
PROTECTED_FUNCTION_STATIC modelica_integer omc_ComponentReference_crefDepth1(threadData_t *threadData, modelica_metatype _inCref, modelica_integer _iDepth);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_crefDepth1(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _iDepth);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_crefDepth1,2,0) {(void*) boxptr_ComponentReference_crefDepth1,0}};
#define boxvar_ComponentReference_crefDepth1 MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_crefDepth1)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_toStringList__tail(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _inAccumStrings);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_toStringList__tail,2,0) {(void*) boxptr_ComponentReference_toStringList__tail,0}};
#define boxvar_ComponentReference_toStringList__tail MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_toStringList__tail)
PROTECTED_FUNCTION_STATIC void omc_ComponentReference_printComponentRef2(threadData_t *threadData, modelica_string _inString, modelica_metatype _inSubscriptLst);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_printComponentRef2,2,0) {(void*) boxptr_ComponentReference_printComponentRef2,0}};
#define boxvar_ComponentReference_printComponentRef2 MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_printComponentRef2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_removeSliceSubs(threadData_t *threadData, modelica_metatype _subs);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_removeSliceSubs,2,0) {(void*) boxptr_ComponentReference_removeSliceSubs,0}};
#define boxvar_ComponentReference_removeSliceSubs MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_removeSliceSubs)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_replaceSliceSub(threadData_t *threadData, modelica_metatype _inSubs, modelica_metatype _inSub);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_replaceSliceSub,2,0) {(void*) boxptr_ComponentReference_replaceSliceSub,0}};
#define boxvar_ComponentReference_replaceSliceSub MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_replaceSliceSub)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ComponentReference_containWholeDim3(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _ad);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_containWholeDim3(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _ad);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_containWholeDim3,2,0) {(void*) boxptr_ComponentReference_containWholeDim3,0}};
#define boxvar_ComponentReference_containWholeDim3 MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_containWholeDim3)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ComponentReference_containWholeDim2(threadData_t *threadData, modelica_metatype _inRef, modelica_metatype _inType);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_containWholeDim2(threadData_t *threadData, modelica_metatype _inRef, modelica_metatype _inType);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_containWholeDim2,2,0) {(void*) boxptr_ComponentReference_containWholeDim2,0}};
#define boxvar_ComponentReference_containWholeDim2 MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_containWholeDim2)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ComponentReference_crefEqualWithoutSubs2(threadData_t *threadData, modelica_boolean _refEq, modelica_metatype _icr1, modelica_metatype _icr2);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_crefEqualWithoutSubs2(threadData_t *threadData, modelica_metatype _refEq, modelica_metatype _icr1, modelica_metatype _icr2);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_crefEqualWithoutSubs2,2,0) {(void*) boxptr_ComponentReference_crefEqualWithoutSubs2,0}};
#define boxvar_ComponentReference_crefEqualWithoutSubs2 MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_crefEqualWithoutSubs2)
PROTECTED_FUNCTION_STATIC modelica_integer omc_ComponentReference_crefLexicalCompareSubsAtEnd2(threadData_t *threadData, modelica_metatype _inSubs1, modelica_metatype _inSubs2);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_crefLexicalCompareSubsAtEnd2(threadData_t *threadData, modelica_metatype _inSubs1, modelica_metatype _inSubs2);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_crefLexicalCompareSubsAtEnd2,2,0) {(void*) boxptr_ComponentReference_crefLexicalCompareSubsAtEnd2,0}};
#define boxvar_ComponentReference_crefLexicalCompareSubsAtEnd2 MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_crefLexicalCompareSubsAtEnd2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_toExpCrefSubs(threadData_t *threadData, modelica_metatype _absynSubs);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_toExpCrefSubs,2,0) {(void*) boxptr_ComponentReference_toExpCrefSubs,0}};
#define boxvar_ComponentReference_toExpCrefSubs MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_toExpCrefSubs)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_unelabSubscripts(threadData_t *threadData, modelica_metatype _inSubscriptLst);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_unelabSubscripts,2,0) {(void*) boxptr_ComponentReference_unelabSubscripts,0}};
#define boxvar_ComponentReference_unelabSubscripts MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_unelabSubscripts)
PROTECTED_FUNCTION_STATIC modelica_integer omc_ComponentReference_hashSubscript(threadData_t *threadData, modelica_metatype _sub);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_hashSubscript(threadData_t *threadData, modelica_metatype _sub);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_hashSubscript,2,0) {(void*) boxptr_ComponentReference_hashSubscript,0}};
#define boxvar_ComponentReference_hashSubscript MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_hashSubscript)
PROTECTED_FUNCTION_STATIC modelica_integer omc_ComponentReference_hashSubscripts2(threadData_t *threadData, modelica_metatype _dims, modelica_metatype _subs, modelica_integer _factor);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_hashSubscripts2(threadData_t *threadData, modelica_metatype _dims, modelica_metatype _subs, modelica_metatype _factor);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_hashSubscripts2,2,0) {(void*) boxptr_ComponentReference_hashSubscripts2,0}};
#define boxvar_ComponentReference_hashSubscripts2 MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_hashSubscripts2)
PROTECTED_FUNCTION_STATIC modelica_integer omc_ComponentReference_hashSubscripts(threadData_t *threadData, modelica_metatype _tp, modelica_metatype _subs);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_hashSubscripts(threadData_t *threadData, modelica_metatype _tp, modelica_metatype _subs);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ComponentReference_hashSubscripts,2,0) {(void*) boxptr_ComponentReference_hashSubscripts,0}};
#define boxvar_ComponentReference_hashSubscripts MMC_REFSTRUCTLIT(boxvar_lit_ComponentReference_hashSubscripts)
DLLExport
modelica_metatype omc_ComponentReference_createDifferentiatedCrefName(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _inX, modelica_string _inMatrixName)
{
modelica_metatype _outCref = NULL;
modelica_metatype _subs = NULL;
modelica_boolean _debug;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_debug = 0;
_subs = omc_ComponentReference_crefLastSubs(threadData, _inCref);
_outCref = omc_ComponentReference_crefStripLastSubs(threadData, _inCref);
_outCref = omc_ComponentReference_replaceSubsWithString(threadData, _outCref);
_outCref = omc_ComponentReference_crefSetLastType(threadData, _outCref, _OMC_LIT0);
tmpMeta[0] = stringAppend(_OMC_LIT1,_inMatrixName);
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
_outCref = omc_ComponentReference_joinCrefs(threadData, _outCref, omc_ComponentReference_makeCrefIdent(threadData, tmpMeta[0], _OMC_LIT0, tmpMeta[1]));
_outCref = omc_ComponentReference_joinCrefs(threadData, _outCref, _inX);
_outCref = omc_ComponentReference_crefSetLastSubs(threadData, _outCref, _subs);
_outCref = omc_ComponentReference_crefSetLastType(threadData, _outCref, omc_ComponentReference_crefLastType(threadData, _inCref));
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_real omc_ComponentReference_getConsumedMemory(threadData_t *threadData, modelica_metatype _inCref, modelica_real *out_szTypes, modelica_real *out_szSubs)
{
modelica_real _szIdents;
modelica_real _szTypes;
modelica_real _szSubs;
modelica_metatype _cr = NULL;
modelica_boolean _b;
modelica_boolean tmp1_c0 __attribute__((unused)) = 0;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_szIdents = 0.0;
_szTypes = 0.0;
_szSubs = 0.0;
_cr = _inCref;
_b = 1;
while(1)
{
if(!_b) break;
{
modelica_metatype tmp4_1;
tmp4_1 = _cr;
{
int tmp4;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
case 4: {
_szIdents = _szIdents + omc_System_getSizeOfData(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr), 2))), NULL, NULL);
_szTypes = _szTypes + omc_System_getSizeOfData(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr), 3))), NULL, NULL);
_szSubs = _szSubs + omc_System_getSizeOfData(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr), 4))), NULL, NULL);
tmp1_c0 = 0;
tmpMeta[0+1] = _cr;
goto tmp3_done;
}
case 5: {
_szIdents = _szIdents + omc_System_getSizeOfData(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr), 2))), NULL, NULL);
_szTypes = _szTypes + omc_System_getSizeOfData(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr), 4))), NULL, NULL);
tmp1_c0 = 0;
tmpMeta[0+1] = _cr;
goto tmp3_done;
}
case 3: {
_szIdents = _szIdents + omc_System_getSizeOfData(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr), 2))), NULL, NULL);
_szTypes = _szTypes + omc_System_getSizeOfData(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr), 3))), NULL, NULL);
_szSubs = _szSubs + omc_System_getSizeOfData(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr), 4))), NULL, NULL);
tmp1_c0 = 1;
tmpMeta[0+1] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr), 5)));
goto tmp3_done;
}
default:
tmp3_default: OMC_LABEL_UNUSED; {
tmp1_c0 = 0;
tmpMeta[0+1] = _cr;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_b = tmp1_c0;
_cr = tmpMeta[0+1];
}
_return: OMC_LABEL_UNUSED
if (out_szTypes) { *out_szTypes = _szTypes; }
if (out_szSubs) { *out_szSubs = _szSubs; }
return _szIdents;
}
modelica_metatype boxptr_ComponentReference_getConsumedMemory(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype *out_szTypes, modelica_metatype *out_szSubs)
{
modelica_real _szTypes;
modelica_real _szSubs;
modelica_real _szIdents;
modelica_metatype out_szIdents;
_szIdents = omc_ComponentReference_getConsumedMemory(threadData, _inCref, &_szTypes, &_szSubs);
out_szIdents = mmc_mk_rcon(_szIdents);
if (out_szTypes) { *out_szTypes = mmc_mk_rcon(_szTypes); }
if (out_szSubs) { *out_szSubs = mmc_mk_rcon(_szSubs); }
return out_szIdents;
}
DLLExport
void omc_ComponentReference_writeSubscripts(threadData_t *threadData, modelica_complex _file, modelica_metatype _subs, modelica_integer _escape)
{
modelica_boolean _first;
modelica_integer _i;
modelica_metatype _exp = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_first = 1;
if(listEmpty(_subs))
{
goto _return;
}
omc_File_write(threadData, _file, _OMC_LIT2);
{
modelica_metatype _s;
for (tmpMeta[0] = _subs; !listEmpty(tmpMeta[0]); tmpMeta[0]=MMC_CDR(tmpMeta[0]))
{
_s = MMC_CAR(tmpMeta[0]);
if((!_first))
{
omc_File_write(threadData, _file, _OMC_LIT3);
}
else
{
_first = 0;
}
{
modelica_metatype tmp3_1;
tmp3_1 = _s;
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 7; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,0) == 0) goto tmp2_end;
omc_File_write(threadData, _file, _OMC_LIT4);
goto tmp2_done;
}
case 1: {
modelica_integer tmp5;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,1) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],0,1) == 0) goto tmp2_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
tmp5 = mmc_unbox_integer(tmpMeta[2]);
_i = tmp5;
omc_File_writeInt(threadData, _file, _i, _OMC_LIT5);
goto tmp2_done;
}
case 2: {
modelica_integer tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,1) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],0,1) == 0) goto tmp2_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
tmp6 = mmc_unbox_integer(tmpMeta[2]);
_i = tmp6;
omc_File_writeInt(threadData, _file, _i, _OMC_LIT5);
goto tmp2_done;
}
case 3: {
modelica_integer tmp7;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,3,1) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],0,1) == 0) goto tmp2_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
tmp7 = mmc_unbox_integer(tmpMeta[2]);
_i = tmp7;
omc_File_writeInt(threadData, _file, _i, _OMC_LIT5);
goto tmp2_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,1) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_exp = tmpMeta[1];
omc_File_write(threadData, _file, omc_ExpressionDump_printExpStr(threadData, _exp));
goto tmp2_done;
}
case 5: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,1) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_exp = tmpMeta[1];
omc_File_write(threadData, _file, omc_ExpressionDump_printExpStr(threadData, _exp));
goto tmp2_done;
}
case 6: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,3,1) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_exp = tmpMeta[1];
omc_File_write(threadData, _file, omc_ExpressionDump_printExpStr(threadData, _exp));
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
;
}
}
omc_File_write(threadData, _file, _OMC_LIT6);
_return: OMC_LABEL_UNUSED
return;
}
void boxptr_ComponentReference_writeSubscripts(threadData_t *threadData, modelica_metatype _file, modelica_metatype _subs, modelica_metatype _escape)
{
modelica_integer tmp1;
tmp1 = mmc_unbox_integer(_escape);
omc_ComponentReference_writeSubscripts(threadData, _file, _subs, tmp1);
return;
}
DLLExport
void omc_ComponentReference_writeCref(threadData_t *threadData, modelica_complex _file, modelica_metatype _cref, modelica_integer _escape)
{
modelica_metatype _c = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_c = _cref;
while(1)
{
if(!1) break;
{
modelica_metatype tmp3_1;
tmp3_1 = _c;
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 4; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
omc_File_writeEscape(threadData, _file, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_c), 2))), (modelica_integer)_escape);
omc_ComponentReference_writeSubscripts(threadData, _file, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_c), 4))), (modelica_integer)_escape);
goto _return;
goto goto_1;
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
if (4 != MMC_STRLEN(tmpMeta[1]) || strcmp(MMC_STRINGDATA(_OMC_LIT11), MMC_STRINGDATA(tmpMeta[1])) != 0) goto tmp2_end;
omc_File_write(threadData, _file, _OMC_LIT7);
omc_ComponentReference_writeCref(threadData, _file, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_c), 5))), (modelica_integer)_escape);
omc_File_write(threadData, _file, _OMC_LIT8);
goto _return;
goto goto_1;
goto tmp2_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
if (7 != MMC_STRLEN(tmpMeta[1]) || strcmp(MMC_STRINGDATA(_OMC_LIT12), MMC_STRINGDATA(tmpMeta[1])) != 0) goto tmp2_end;
omc_File_write(threadData, _file, _OMC_LIT9);
omc_ComponentReference_writeCref(threadData, _file, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_c), 5))), (modelica_integer)_escape);
omc_File_write(threadData, _file, _OMC_LIT8);
goto _return;
goto goto_1;
goto tmp2_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
omc_File_writeEscape(threadData, _file, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_c), 2))), (modelica_integer)_escape);
omc_ComponentReference_writeSubscripts(threadData, _file, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_c), 4))), (modelica_integer)_escape);
omc_File_write(threadData, _file, _OMC_LIT10);
tmpMeta[0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_c), 5)));
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_c = tmpMeta[0];
}
_return: OMC_LABEL_UNUSED
return;
}
void boxptr_ComponentReference_writeCref(threadData_t *threadData, modelica_metatype _file, modelica_metatype _cref, modelica_metatype _escape)
{
modelica_integer tmp1;
tmp1 = mmc_unbox_integer(_escape);
omc_ComponentReference_writeCref(threadData, _file, _cref, tmp1);
return;
}
DLLExport
modelica_string omc_ComponentReference_crefAppendedSubs(threadData_t *threadData, modelica_metatype _cref)
{
modelica_string _s = NULL;
modelica_string _s1 = NULL;
modelica_string _s2 = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_s1 = stringDelimitList(omc_ComponentReference_toStringList(threadData, _cref), _OMC_LIT13);
_s2 = stringDelimitList(omc_List_mapMap(threadData, omc_ComponentReference_crefSubs(threadData, _cref), boxvar_Expression_getSubscriptExp, boxvar_ExpressionDump_printExpStr), _OMC_LIT3);
tmpMeta[0] = stringAppend(_s1,_OMC_LIT2);
tmpMeta[1] = stringAppend(tmpMeta[0],_s2);
tmpMeta[2] = stringAppend(tmpMeta[1],_OMC_LIT6);
_s = tmpMeta[2];
_return: OMC_LABEL_UNUSED
return _s;
}
PROTECTED_FUNCTION_STATIC void omc_ComponentReference_printSubscriptBoundsError(threadData_t *threadData, modelica_metatype _inSubscriptExp, modelica_metatype _inDimension, modelica_integer _inIndex, modelica_metatype _inCref, modelica_metatype _inInfo)
{
modelica_string _sub_str = NULL;
modelica_string _dim_str = NULL;
modelica_string _idx_str = NULL;
modelica_string _cref_str = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_sub_str = omc_ExpressionDump_printExpStr(threadData, _inSubscriptExp);
_dim_str = omc_ExpressionDump_dimensionString(threadData, _inDimension);
_idx_str = intString(_inIndex);
_cref_str = omc_ComponentReference_printComponentRefStr(threadData, _inCref);
tmpMeta[0] = mmc_mk_cons(_sub_str, mmc_mk_cons(_idx_str, mmc_mk_cons(_dim_str, mmc_mk_cons(_cref_str, MMC_REFSTRUCTLIT(mmc_nil)))));
omc_Error_addSourceMessage(threadData, _OMC_LIT18, tmpMeta[0], _inInfo);
_return: OMC_LABEL_UNUSED
return;
}
PROTECTED_FUNCTION_STATIC void boxptr_ComponentReference_printSubscriptBoundsError(threadData_t *threadData, modelica_metatype _inSubscriptExp, modelica_metatype _inDimension, modelica_metatype _inIndex, modelica_metatype _inCref, modelica_metatype _inInfo)
{
modelica_integer tmp1;
tmp1 = mmc_unbox_integer(_inIndex);
omc_ComponentReference_printSubscriptBoundsError(threadData, _inSubscriptExp, _inDimension, tmp1, _inCref, _inInfo);
return;
}
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ComponentReference_subscriptExpOutOfBounds(threadData_t *threadData, modelica_integer _inDimSize, modelica_metatype _inSubscriptExp)
{
modelica_boolean _outOutOfBounds;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inSubscriptExp;
{
modelica_integer _i;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
modelica_integer tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,1) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmp6 = mmc_unbox_integer(tmpMeta[0]);
_i = tmp6;
tmp1 = ((_i < ((modelica_integer) 1)) || (_i > _inDimSize));
goto tmp3_done;
}
case 1: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outOutOfBounds = tmp1;
_return: OMC_LABEL_UNUSED
return _outOutOfBounds;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_subscriptExpOutOfBounds(threadData_t *threadData, modelica_metatype _inDimSize, modelica_metatype _inSubscriptExp)
{
modelica_integer tmp1;
modelica_boolean _outOutOfBounds;
modelica_metatype out_outOutOfBounds;
tmp1 = mmc_unbox_integer(_inDimSize);
_outOutOfBounds = omc_ComponentReference_subscriptExpOutOfBounds(threadData, tmp1, _inSubscriptExp);
out_outOutOfBounds = mmc_mk_icon(_outOutOfBounds);
return out_outOutOfBounds;
}
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ComponentReference_checkCrefSubscriptBounds(threadData_t *threadData, modelica_metatype _inSubscript, modelica_metatype _inDimension, modelica_integer _inIndex, modelica_metatype _inWholeCref, modelica_metatype _inInfo)
{
modelica_boolean _outIsValid;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;
tmp4_1 = _inSubscript;
tmp4_2 = _inDimension;
{
modelica_integer _idx;
modelica_integer _dim;
modelica_metatype _expl = NULL;
modelica_metatype _exp = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 3; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
modelica_integer tmp6;
modelica_integer tmp7;
modelica_boolean tmp8;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,1) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmp6 = mmc_unbox_integer(tmpMeta[0]);
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],0,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
tmp7 = mmc_unbox_integer(tmpMeta[2]);
_dim = tmp6;
_exp = tmpMeta[1];
_idx = tmp7;
tmp4 += 1;
tmp8 = ((_idx > ((modelica_integer) 0)) && (_idx <= _dim));
if (0 != tmp8) goto goto_2;
omc_ComponentReference_printSubscriptBoundsError(threadData, _exp, _inDimension, _inIndex, _inWholeCref, _inInfo);
tmp1 = 0;
goto tmp3_done;
}
case 1: {
modelica_integer tmp9;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,1) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmp9 = mmc_unbox_integer(tmpMeta[0]);
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],16,3) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 4));
_dim = tmp9;
_expl = tmpMeta[2];
_exp = omc_List_getMemberOnTrue(threadData, mmc_mk_integer(_dim), _expl, boxvar_ComponentReference_subscriptExpOutOfBounds);
omc_ComponentReference_printSubscriptBoundsError(threadData, _exp, _inDimension, _inIndex, _inWholeCref, _inInfo);
tmp1 = 0;
goto tmp3_done;
}
case 2: {
tmp1 = 1;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 3) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outIsValid = tmp1;
_return: OMC_LABEL_UNUSED
return _outIsValid;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_checkCrefSubscriptBounds(threadData_t *threadData, modelica_metatype _inSubscript, modelica_metatype _inDimension, modelica_metatype _inIndex, modelica_metatype _inWholeCref, modelica_metatype _inInfo)
{
modelica_integer tmp1;
modelica_boolean _outIsValid;
modelica_metatype out_outIsValid;
tmp1 = mmc_unbox_integer(_inIndex);
_outIsValid = omc_ComponentReference_checkCrefSubscriptBounds(threadData, _inSubscript, _inDimension, tmp1, _inWholeCref, _inInfo);
out_outIsValid = mmc_mk_icon(_outIsValid);
return out_outIsValid;
}
PROTECTED_FUNCTION_STATIC void omc_ComponentReference_checkCrefSubscriptsBounds4(threadData_t *threadData, modelica_metatype _inSubscripts, modelica_metatype _inDimensions, modelica_integer _inIndex, modelica_metatype _inWholeCref, modelica_metatype _inInfo)
{
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;modelica_metatype tmp3_2;
tmp3_1 = _inSubscripts;
tmp3_2 = _inDimensions;
{
modelica_metatype _sub = NULL;
modelica_metatype _rest_subs = NULL;
modelica_metatype _dim = NULL;
modelica_metatype _rest_dims = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 3; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
modelica_boolean tmp5;
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[0] = MMC_CAR(tmp3_1);
tmpMeta[1] = MMC_CDR(tmp3_1);
if (listEmpty(tmp3_2)) goto tmp2_end;
tmpMeta[2] = MMC_CAR(tmp3_2);
tmpMeta[3] = MMC_CDR(tmp3_2);
_sub = tmpMeta[0];
_rest_subs = tmpMeta[1];
_dim = tmpMeta[2];
_rest_dims = tmpMeta[3];
tmp5 = omc_ComponentReference_checkCrefSubscriptBounds(threadData, _sub, _dim, _inIndex, _inWholeCref, _inInfo);
if (1 != tmp5) goto goto_1;
_inSubscripts = _rest_subs;
_inDimensions = _rest_dims;
_inIndex = ((modelica_integer) 1) + _inIndex;
goto _tailrecursive;
;
goto tmp2_done;
}
case 1: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
goto tmp2_done;
}
case 2: {
if (!listEmpty(tmp3_2)) goto tmp2_end;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
;
_return: OMC_LABEL_UNUSED
return;
}
PROTECTED_FUNCTION_STATIC void boxptr_ComponentReference_checkCrefSubscriptsBounds4(threadData_t *threadData, modelica_metatype _inSubscripts, modelica_metatype _inDimensions, modelica_metatype _inIndex, modelica_metatype _inWholeCref, modelica_metatype _inInfo)
{
modelica_integer tmp1;
tmp1 = mmc_unbox_integer(_inIndex);
omc_ComponentReference_checkCrefSubscriptsBounds4(threadData, _inSubscripts, _inDimensions, tmp1, _inWholeCref, _inInfo);
return;
}
PROTECTED_FUNCTION_STATIC void omc_ComponentReference_checkCrefSubscriptsBounds3(threadData_t *threadData, modelica_metatype _inCrefType, modelica_metatype _inSubscripts, modelica_metatype _inWholeCref, modelica_metatype _inInfo)
{
modelica_metatype _dims = NULL;
modelica_metatype _subs = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_dims = omc_Types_getDimensions(threadData, _inCrefType);
_dims = listReverse(_dims);
_subs = listReverse(_inSubscripts);
omc_ComponentReference_checkCrefSubscriptsBounds4(threadData, _subs, _dims, ((modelica_integer) 1), _inWholeCref, _inInfo);
_return: OMC_LABEL_UNUSED
return;
}
PROTECTED_FUNCTION_STATIC void omc_ComponentReference_checkCrefSubscriptsBounds2(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _inWholeCref, modelica_metatype _inInfo)
{
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCref;
{
modelica_metatype _ty = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _rest_cr = NULL;
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_ty = tmpMeta[0];
_subs = tmpMeta[1];
_rest_cr = tmpMeta[2];
omc_ComponentReference_checkCrefSubscriptsBounds3(threadData, _ty, _subs, _inWholeCref, _inInfo);
_inCref = _rest_cr;
goto _tailrecursive;
;
goto tmp2_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_ty = tmpMeta[0];
_subs = tmpMeta[1];
omc_ComponentReference_checkCrefSubscriptsBounds3(threadData, _ty, _subs, _inWholeCref, _inInfo);
goto tmp2_done;
}
case 5: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,4) == 0) goto tmp2_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_ty = tmpMeta[0];
_subs = tmpMeta[1];
omc_ComponentReference_checkCrefSubscriptsBounds3(threadData, _ty, _subs, _inWholeCref, _inInfo);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
;
_return: OMC_LABEL_UNUSED
return;
}
DLLExport
void omc_ComponentReference_checkCrefSubscriptsBounds(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _inInfo)
{
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
omc_ComponentReference_checkCrefSubscriptsBounds2(threadData, _inCref, _inCref, _inInfo);
_return: OMC_LABEL_UNUSED
return;
}
PROTECTED_FUNCTION_STATIC modelica_integer omc_ComponentReference_identifierCount__tail(threadData_t *threadData, modelica_metatype _inCref, modelica_integer _inAccumCount)
{
modelica_integer _outIdCount;
modelica_integer tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inCref;
{
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_cr = tmpMeta[0];
_inCref = _cr;
_inAccumCount = ((modelica_integer) 1) + _inAccumCount;
goto _tailrecursive;
goto tmp3_done;
}
case 1: {
tmp1 = ((modelica_integer) 1) + _inAccumCount;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outIdCount = tmp1;
_return: OMC_LABEL_UNUSED
return _outIdCount;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_identifierCount__tail(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _inAccumCount)
{
modelica_integer tmp1;
modelica_integer _outIdCount;
modelica_metatype out_outIdCount;
tmp1 = mmc_unbox_integer(_inAccumCount);
_outIdCount = omc_ComponentReference_identifierCount__tail(threadData, _inCref, tmp1);
out_outIdCount = mmc_mk_icon(_outIdCount);
return out_outIdCount;
}
DLLExport
modelica_integer omc_ComponentReference_identifierCount(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_integer _outIdCount;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outIdCount = omc_ComponentReference_identifierCount__tail(threadData, _inCref, ((modelica_integer) 0));
_return: OMC_LABEL_UNUSED
return _outIdCount;
}
modelica_metatype boxptr_ComponentReference_identifierCount(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_integer _outIdCount;
modelica_metatype out_outIdCount;
_outIdCount = omc_ComponentReference_identifierCount(threadData, _inCref);
out_outIdCount = mmc_mk_icon(_outIdCount);
return out_outIdCount;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_implode__tail(threadData_t *threadData, modelica_metatype _inParts, modelica_metatype _inAccumCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[6] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inParts;
{
modelica_string _id = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _rest = NULL;
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],1,3) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 3));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 4));
_id = tmpMeta[3];
_ty = tmpMeta[4];
_subs = tmpMeta[5];
_rest = tmpMeta[2];
tmpMeta[1] = mmc_mk_box5(3, &DAE_ComponentRef_CREF__QUAL__desc, _id, _ty, _subs, _inAccumCref);
_cr = tmpMeta[1];
_inParts = _rest;
_inAccumCref = _cr;
goto _tailrecursive;
goto tmp2_done;
}
case 1: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[0] = _inAccumCref;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_implode__reverse(threadData_t *threadData, modelica_metatype _inParts)
{
modelica_metatype _outCref = NULL;
modelica_metatype _first = NULL;
modelica_metatype _rest = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = _inParts;
if (listEmpty(tmpMeta[0])) MMC_THROW_INTERNAL();
tmpMeta[1] = MMC_CAR(tmpMeta[0]);
tmpMeta[2] = MMC_CDR(tmpMeta[0]);
_first = tmpMeta[1];
_rest = tmpMeta[2];
_outCref = omc_ComponentReference_implode__tail(threadData, _rest, _first);
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_implode(threadData_t *threadData, modelica_metatype _inParts)
{
modelica_metatype _outCref = NULL;
modelica_metatype _first = NULL;
modelica_metatype _rest = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outCref = omc_ComponentReference_implode__reverse(threadData, listReverse(_inParts));
_return: OMC_LABEL_UNUSED
return _outCref;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_explode__tail(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _inParts)
{
modelica_metatype _outParts = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCref;
{
modelica_metatype _first_cr = NULL;
modelica_metatype _rest_cr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_rest_cr = tmpMeta[1];
_first_cr = omc_ComponentReference_crefFirstCref(threadData, _inCref);
tmpMeta[1] = mmc_mk_cons(_first_cr, _inParts);
_inCref = _rest_cr;
_inParts = tmpMeta[1];
goto _tailrecursive;
goto tmp2_done;
}
case 1: {
tmpMeta[1] = mmc_mk_cons(_inCref, _inParts);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outParts = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outParts;
}
DLLExport
modelica_metatype omc_ComponentReference_explode(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_metatype _outParts = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_outParts = listReverse(omc_ComponentReference_explode__tail(threadData, _inCref, tmpMeta[0]));
_return: OMC_LABEL_UNUSED
return _outParts;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_expandArrayCref1(threadData_t *threadData, modelica_metatype _inCr, modelica_metatype _inSubscripts, modelica_metatype _inAccumSubs, modelica_metatype _inAccumCrefs)
{
modelica_metatype _outCrefs = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inSubscripts;
{
modelica_metatype _sub = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _rest_subs = NULL;
modelica_metatype _crefs = NULL;
modelica_metatype _cref = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 3; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
if (listEmpty(tmpMeta[1])) goto tmp2_end;
tmpMeta[3] = MMC_CAR(tmpMeta[1]);
tmpMeta[4] = MMC_CDR(tmpMeta[1]);
_sub = tmpMeta[3];
_subs = tmpMeta[4];
_rest_subs = tmpMeta[2];
tmpMeta[1] = mmc_mk_cons(_subs, _rest_subs);
_crefs = omc_ComponentReference_expandArrayCref1(threadData, _inCr, tmpMeta[1], _inAccumSubs, _inAccumCrefs);
tmpMeta[1] = mmc_mk_cons(_sub, _inAccumSubs);
_inSubscripts = _rest_subs;
_inAccumSubs = tmpMeta[1];
_inAccumCrefs = _crefs;
goto _tailrecursive;
goto tmp2_done;
}
case 1: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
tmpMeta[0] = _inAccumCrefs;
goto tmp2_done;
}
case 2: {
_cref = omc_ComponentReference_crefSetLastSubs(threadData, _inCr, _inAccumSubs);
tmpMeta[1] = mmc_mk_cons(_cref, _inAccumCrefs);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCrefs = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCrefs;
}
DLLExport
modelica_metatype omc_ComponentReference_expandArrayCref(threadData_t *threadData, modelica_metatype _inCr, modelica_metatype _inDims)
{
modelica_metatype _outCrefs = NULL;
modelica_metatype _lasttype = NULL;
modelica_metatype _tmpcref = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_lasttype = omc_ComponentReference_crefLastType(threadData, _inCr);
_lasttype = omc_Types_liftTypeWithDims(threadData, _lasttype, _inDims);
_tmpcref = omc_ComponentReference_crefSetLastType(threadData, _inCr, _lasttype);
_outCrefs = omc_ComponentReference_expandCref(threadData, _tmpcref, 0);
_return: OMC_LABEL_UNUSED
return _outCrefs;
}
DLLExport
modelica_metatype omc_ComponentReference_replaceLast(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _inNewLast)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCref;
{
modelica_string _ident = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cref = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_ident = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_cref = tmpMeta[4];
_cref = omc_ComponentReference_replaceLast(threadData, _cref, _inNewLast);
tmpMeta[1] = mmc_mk_box5(3, &DAE_ComponentRef_CREF__QUAL__desc, _ident, _ty, _subs, _cref);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[0] = _inNewLast;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_makeCrefsFromSubScriptExp(threadData_t *threadData, modelica_metatype _inExp)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inExp;
{
modelica_metatype _op = NULL;
modelica_metatype _cr1 = NULL;
modelica_metatype _cr2 = NULL;
modelica_string _str = NULL;
modelica_metatype _e1 = NULL;
modelica_metatype _e2 = NULL;
modelica_metatype _enum_lit = NULL;
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 3: {
_str = omc_ExpressionDump_printExpStr(threadData, _inExp);
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[2] = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, _str, _OMC_LIT0, tmpMeta[1]);
tmpMeta[0] = tmpMeta[2];
goto tmp2_done;
}
case 9: {
tmpMeta[0] = omc_Expression_expCref(threadData, _inExp);
goto tmp2_done;
}
case 10: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,7,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_e1 = tmpMeta[1];
_op = tmpMeta[2];
_e2 = tmpMeta[3];
_str = omc_ExpressionDump_binopSymbol(threadData, _op);
_cr1 = omc_ComponentReference_makeCrefsFromSubScriptExp(threadData, _e1);
_cr2 = omc_ComponentReference_makeCrefsFromSubScriptExp(threadData, _e2);
_outCref = omc_ComponentReference_prependStringCref(threadData, _str, _cr1);
tmpMeta[0] = omc_ComponentReference_joinCrefs(threadData, _outCref, _cr2);
goto tmp2_done;
}
case 8: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,5,2) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_enum_lit = tmpMeta[1];
_str = omc_System_stringReplace(threadData, omc_AbsynUtil_pathString(threadData, _enum_lit, _OMC_LIT10, 1, 0), _OMC_LIT10, _OMC_LIT19);
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[2] = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, _str, _OMC_LIT0, tmpMeta[1]);
tmpMeta[0] = tmpMeta[2];
goto tmp2_done;
}
default:
tmp2_default: OMC_LABEL_UNUSED; {
_str = omc_ExpressionDump_dumpExpStr(threadData, _inExp, ((modelica_integer) 0));
tmpMeta[1] = stringAppend(_OMC_LIT20,_str);
tmpMeta[2] = stringAppend(tmpMeta[1],_OMC_LIT21);
omc_Error_addInternalError(threadData, tmpMeta[2], _OMC_LIT23);
goto goto_1;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_makeCrefsFromSubScriptLst(threadData_t *threadData, modelica_metatype _inSubscriptLst, modelica_metatype _inPreCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outCref = _inPreCref;
{
modelica_metatype _subScript;
for (tmpMeta[0] = _inSubscriptLst; !listEmpty(tmpMeta[0]); tmpMeta[0]=MMC_CDR(tmpMeta[0]))
{
_subScript = MMC_CAR(tmpMeta[0]);
{
modelica_metatype tmp3_1;
tmp3_1 = _subScript;
{
modelica_metatype _cr = NULL;
modelica_metatype _e = NULL;
modelica_string _str = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,1) == 0) goto tmp2_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_e = tmpMeta[2];
_cr = omc_ComponentReference_makeCrefsFromSubScriptExp(threadData, _e);
tmpMeta[1] = omc_ComponentReference_joinCrefs(threadData, _outCref, _cr);
goto tmp2_done;
}
case 1: {
_str = omc_ExpressionDump_printSubscriptStr(threadData, _subScript);
tmpMeta[2] = stringAppend(_OMC_LIT24,_str);
tmpMeta[3] = stringAppend(tmpMeta[2],_OMC_LIT21);
omc_Error_addInternalError(threadData, tmpMeta[3], _OMC_LIT25);
goto goto_1;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCref = tmpMeta[1];
}
}
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_replaceSubsWithString(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCref;
{
modelica_string _ident = NULL;
modelica_metatype _identType = NULL;
modelica_metatype _subscriptLst = NULL;
modelica_metatype _cr = NULL;
modelica_metatype _cr1 = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 6; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
if (!listEmpty(tmpMeta[3])) goto tmp2_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_ident = tmpMeta[1];
_identType = tmpMeta[2];
_cr = tmpMeta[4];
_cr1 = omc_ComponentReference_replaceSubsWithString(threadData, _cr);
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[2] = mmc_mk_box5(3, &DAE_ComponentRef_CREF__QUAL__desc, _ident, _identType, tmpMeta[1], _cr1);
tmpMeta[0] = tmpMeta[2];
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_ident = tmpMeta[1];
_identType = tmpMeta[2];
_subscriptLst = tmpMeta[3];
_cr = tmpMeta[4];
_identType = omc_Expression_unliftArrayTypeWithSubs(threadData, _subscriptLst, _identType);
_cr1 = omc_ComponentReference_replaceSubsWithString(threadData, _cr);
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[2] = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, _ident, _identType, tmpMeta[1]);
_cr = omc_ComponentReference_makeCrefsFromSubScriptLst(threadData, _subscriptLst, tmpMeta[2]);
tmpMeta[0] = omc_ComponentReference_joinCrefs(threadData, _cr, _cr1);
goto tmp2_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
if (!listEmpty(tmpMeta[1])) goto tmp2_end;
tmpMeta[0] = _inCref;
goto tmp2_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_ident = tmpMeta[1];
_identType = tmpMeta[2];
_subscriptLst = tmpMeta[3];
_identType = omc_Expression_unliftArrayTypeWithSubs(threadData, _subscriptLst, _identType);
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[2] = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, _ident, _identType, tmpMeta[1]);
tmpMeta[0] = omc_ComponentReference_makeCrefsFromSubScriptLst(threadData, _subscriptLst, tmpMeta[2]);
goto tmp2_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,4) == 0) goto tmp2_end;
tmpMeta[0] = _inCref;
goto tmp2_done;
}
case 5: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,4,0) == 0) goto tmp2_end;
tmpMeta[0] = _inCref;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCref;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_expandCref2(threadData_t *threadData, modelica_string _inId, modelica_metatype _inType, modelica_metatype _inSubscripts, modelica_metatype _inDimensions)
{
modelica_metatype _outCrefs = NULL;
modelica_metatype _subslst = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_outCrefs = tmpMeta[0];
_subslst = omc_List_threadMap(threadData, _inSubscripts, _inDimensions, boxvar_Expression_expandSubscript);
_subslst = omc_List_combination(threadData, _subslst);
{
modelica_metatype _subs;
for (tmpMeta[1] = _subslst; !listEmpty(tmpMeta[1]); tmpMeta[1]=MMC_CDR(tmpMeta[1]))
{
_subs = MMC_CAR(tmpMeta[1]);
tmpMeta[2] = mmc_mk_cons(omc_ComponentReference_makeCrefIdent(threadData, _inId, _inType, _subs), _outCrefs);
_outCrefs = tmpMeta[2];
}
}
_outCrefs = listReverse(_outCrefs);
_return: OMC_LABEL_UNUSED
return _outCrefs;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_expandCrefQual(threadData_t *threadData, modelica_metatype _inHeadCrefs, modelica_metatype _inRestCrefs)
{
modelica_metatype _outCrefs = NULL;
modelica_metatype _crefs = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_outCrefs = tmpMeta[0];
{
modelica_metatype _cref;
for (tmpMeta[1] = _inHeadCrefs; !listEmpty(tmpMeta[1]); tmpMeta[1]=MMC_CDR(tmpMeta[1]))
{
_cref = MMC_CAR(tmpMeta[1]);
{
modelica_metatype __omcQ_24tmpVar1;
modelica_metatype* tmp1;
modelica_metatype __omcQ_24tmpVar0;
int tmp2;
modelica_metatype _rest_cref_loopVar = 0;
modelica_metatype _rest_cref;
_rest_cref_loopVar = _inRestCrefs;
tmpMeta[3] = MMC_REFSTRUCTLIT(mmc_nil);
__omcQ_24tmpVar1 = tmpMeta[3];
tmp1 = &__omcQ_24tmpVar1;
while(1) {
tmp2 = 1;
if (!listEmpty(_rest_cref_loopVar)) {
_rest_cref = MMC_CAR(_rest_cref_loopVar);
_rest_cref_loopVar = MMC_CDR(_rest_cref_loopVar);
tmp2--;
}
if (tmp2 == 0) {
__omcQ_24tmpVar0 = omc_ComponentReference_joinCrefs(threadData, _cref, _rest_cref);
*tmp1 = mmc_mk_cons(__omcQ_24tmpVar0,0);
tmp1 = &MMC_CDR(*tmp1);
} else if (tmp2 == 1) {
break;
} else {
MMC_THROW_INTERNAL();
}
}
*tmp1 = mmc_mk_nil();
tmpMeta[2] = __omcQ_24tmpVar1;
}
_crefs = tmpMeta[2];
_outCrefs = listAppend(_crefs, _outCrefs);
}
}
_return: OMC_LABEL_UNUSED
return _outCrefs;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_expandCrefLst(threadData_t *threadData, modelica_metatype _inCrefs, modelica_metatype _varLst, modelica_metatype _inCrefsAcc)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCrefs;
{
modelica_metatype _cr = NULL;
modelica_metatype _crefs = NULL;
modelica_metatype _rest = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[0] = omc_List_flatten(threadData, _inCrefsAcc);
goto tmp2_done;
}
case 1: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
_cr = tmpMeta[1];
_rest = tmpMeta[2];
_crefs = omc_List_map(threadData, _varLst, boxvar_ComponentReference_creffromVar);
_crefs = omc_List_map1r(threadData, _crefs, boxvar_ComponentReference_joinCrefs, _cr);
tmpMeta[1] = mmc_mk_cons(_crefs, _inCrefsAcc);
_inCrefs = _rest;
_inCrefsAcc = tmpMeta[1];
goto _tailrecursive;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_expandCref__impl(threadData_t *threadData, modelica_metatype _inCref, modelica_boolean _expandRecord)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp3_1;volatile modelica_boolean tmp3_2;
tmp3_1 = _inCref;
tmp3_2 = _expandRecord;
{
modelica_string _id = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _basety = NULL;
modelica_metatype _correctTy = NULL;
modelica_metatype _dims = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cref = NULL;
modelica_metatype _crefs = NULL;
modelica_metatype _crefs2 = NULL;
modelica_metatype _varLst = NULL;
modelica_integer _missing_subs;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 8; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (1 != tmp3_2) goto tmp2_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],9,3) == 0) goto tmp2_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],3,1) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 3));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
if (!listEmpty(tmpMeta[4])) goto tmp2_end;
_varLst = tmpMeta[3];
tmp3 += 6;
_crefs = omc_List_map(threadData, _varLst, boxvar_ComponentReference_creffromVar);
_crefs = omc_List_map1r(threadData, _crefs, boxvar_ComponentReference_joinCrefs, _inCref);
tmpMeta[0] = omc_List_map1Flat(threadData, _crefs, boxvar_ComponentReference_expandCref__impl, mmc_mk_boolean(1));
goto tmp2_done;
}
case 1: {
if (1 != tmp3_2) goto tmp2_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],6,2) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
if (!listEmpty(tmpMeta[3])) goto tmp2_end;
_id = tmpMeta[1];
_ty = tmpMeta[2];
tmpMeta[2] = omc_Types_flattenArrayType(threadData, _ty, &tmpMeta[1]);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],9,3) == 0) goto goto_1;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[3],3,1) == 0) goto goto_1;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
_basety = tmpMeta[2];
_varLst = tmpMeta[4];
_dims = tmpMeta[1];
tmpMeta[1] = mmc_mk_box3(9, &DAE_Type_T__ARRAY__desc, _basety, _dims);
_correctTy = tmpMeta[1];
_subs = omc_List_fill(threadData, _OMC_LIT26, listLength(_dims));
_crefs = omc_ComponentReference_expandCref2(threadData, _id, _correctTy, _subs, _dims);
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = omc_ComponentReference_expandCrefLst(threadData, _crefs, _varLst, tmpMeta[1]);
goto tmp2_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],6,2) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
if (!listEmpty(tmpMeta[3])) goto tmp2_end;
_id = tmpMeta[1];
_ty = tmpMeta[2];
_basety = omc_Types_flattenArrayType(threadData, _ty ,&_dims);
tmpMeta[1] = mmc_mk_box3(9, &DAE_Type_T__ARRAY__desc, _basety, _dims);
_correctTy = tmpMeta[1];
_subs = omc_List_fill(threadData, _OMC_LIT26, listLength(_dims));
tmpMeta[0] = omc_ComponentReference_expandCref2(threadData, _id, _correctTy, _subs, _dims);
goto tmp2_done;
}
case 3: {
if (1 != tmp3_2) goto tmp2_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],6,2) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
tmpMeta[2] = omc_Types_flattenArrayType(threadData, _ty, &tmpMeta[1]);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],9,3) == 0) goto goto_1;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[3],3,1) == 0) goto goto_1;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
_basety = tmpMeta[2];
_varLst = tmpMeta[4];
_dims = tmpMeta[1];
tmpMeta[1] = mmc_mk_box3(9, &DAE_Type_T__ARRAY__desc, _basety, _dims);
_correctTy = tmpMeta[1];
_missing_subs = listLength(_dims) - listLength(_subs);
if((_missing_subs > ((modelica_integer) 0)))
{
_subs = listAppend(_subs, omc_List_fill(threadData, _OMC_LIT26, _missing_subs));
}
_crefs = omc_ComponentReference_expandCref2(threadData, _id, _correctTy, _subs, _dims);
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = omc_ComponentReference_expandCrefLst(threadData, _crefs, _varLst, tmpMeta[1]);
goto tmp2_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],6,2) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
tmp3 += 2;
_basety = omc_Types_flattenArrayType(threadData, _ty ,&_dims);
tmpMeta[1] = mmc_mk_box3(9, &DAE_Type_T__ARRAY__desc, _basety, _dims);
_correctTy = tmpMeta[1];
_missing_subs = listLength(_dims) - listLength(_subs);
if((_missing_subs > ((modelica_integer) 0)))
{
_subs = listAppend(_subs, omc_List_fill(threadData, _OMC_LIT26, _missing_subs));
}
tmpMeta[0] = omc_ComponentReference_expandCref2(threadData, _id, _correctTy, _subs, _dims);
goto tmp2_done;
}
case 5: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],6,2) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_cref = tmpMeta[4];
_crefs = omc_ComponentReference_expandCref__impl(threadData, _cref, _expandRecord);
_basety = omc_Types_flattenArrayType(threadData, _ty ,&_dims);
tmpMeta[1] = mmc_mk_box3(9, &DAE_Type_T__ARRAY__desc, _basety, _dims);
_correctTy = tmpMeta[1];
tmpMeta[1] = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, _id, _correctTy, _subs);
_cref = tmpMeta[1];
_crefs2 = omc_ComponentReference_expandCref__impl(threadData, _cref, 0);
_crefs2 = listReverse(_crefs2);
tmpMeta[0] = omc_ComponentReference_expandCrefQual(threadData, _crefs2, _crefs);
goto tmp2_done;
}
case 6: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_cref = tmpMeta[4];
_crefs = omc_ComponentReference_expandCref__impl(threadData, _cref, _expandRecord);
tmpMeta[0] = omc_List_map3r(threadData, _crefs, boxvar_ComponentReference_makeCrefQual, _id, _ty, _subs);
goto tmp2_done;
}
case 7: {
tmpMeta[1] = mmc_mk_cons(_inCref, MMC_REFSTRUCTLIT(mmc_nil));
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 8) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_outCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCref;
}
modelica_metatype boxptr_ComponentReference_expandCref__impl(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _expandRecord)
{
modelica_integer tmp1;
modelica_metatype _outCref = NULL;
tmp1 = mmc_unbox_integer(_expandRecord);
_outCref = omc_ComponentReference_expandCref__impl(threadData, _inCref, tmp1);
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_expandCref(threadData_t *threadData, modelica_metatype _inCref, modelica_boolean _expandRecord)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
tmpMeta[0] = omc_ComponentReference_expandCref__impl(threadData, _inCref, _expandRecord);
goto tmp2_done;
}
case 1: {
modelica_boolean tmp5;
tmp5 = omc_Flags_isSet(threadData, _OMC_LIT30);
if (1 != tmp5) goto goto_1;
tmpMeta[1] = stringAppend(_OMC_LIT31,omc_ComponentReference_printComponentRefStr(threadData, _inCref));
omc_Debug_traceln(threadData, tmpMeta[1]);
goto goto_1;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 2) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_outCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCref;
}
modelica_metatype boxptr_ComponentReference_expandCref(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _expandRecord)
{
modelica_integer tmp1;
modelica_metatype _outCref = NULL;
tmp1 = mmc_unbox_integer(_expandRecord);
_outCref = omc_ComponentReference_expandCref(threadData, _inCref, tmp1);
return _outCref;
}
PROTECTED_FUNCTION_STATIC modelica_integer omc_ComponentReference_crefDepth1(threadData_t *threadData, modelica_metatype _inCref, modelica_integer _iDepth)
{
modelica_integer _depth;
modelica_integer tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inCref;
{
modelica_metatype _n = NULL;
int tmp4;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
case 7: {
tmp1 = _iDepth;
goto tmp3_done;
}
case 4: {
tmp1 = ((modelica_integer) 1) + _iDepth;
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_n = tmpMeta[0];
_inCref = _n;
_iDepth = ((modelica_integer) 1) + _iDepth;
goto _tailrecursive;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_depth = tmp1;
_return: OMC_LABEL_UNUSED
return _depth;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_crefDepth1(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _iDepth)
{
modelica_integer tmp1;
modelica_integer _depth;
modelica_metatype out_depth;
tmp1 = mmc_unbox_integer(_iDepth);
_depth = omc_ComponentReference_crefDepth1(threadData, _inCref, tmp1);
out_depth = mmc_mk_icon(_depth);
return out_depth;
}
DLLExport
modelica_integer omc_ComponentReference_crefDepth(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_integer _depth;
modelica_integer tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inCref;
{
modelica_metatype _n = NULL;
int tmp4;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
case 7: {
tmp1 = ((modelica_integer) 0);
goto tmp3_done;
}
case 4: {
tmp1 = ((modelica_integer) 1);
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_n = tmpMeta[0];
tmp1 = omc_ComponentReference_crefDepth1(threadData, _n, ((modelica_integer) 1));
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_depth = tmp1;
_return: OMC_LABEL_UNUSED
return _depth;
}
modelica_metatype boxptr_ComponentReference_crefDepth(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_integer _depth;
modelica_metatype out_depth;
_depth = omc_ComponentReference_crefDepth(threadData, _inCref);
out_depth = mmc_mk_icon(_depth);
return out_depth;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_toStringList__tail(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _inAccumStrings)
{
modelica_metatype _outStringList = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCref;
{
modelica_string _id = NULL;
modelica_metatype _cref = NULL;
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_cref = tmpMeta[2];
tmpMeta[1] = mmc_mk_cons(_id, _inAccumStrings);
_inCref = _cref;
_inAccumStrings = tmpMeta[1];
goto _tailrecursive;
goto tmp2_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_id = tmpMeta[1];
tmpMeta[1] = mmc_mk_cons(_id, _inAccumStrings);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
default:
tmp2_default: OMC_LABEL_UNUSED; {
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outStringList = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outStringList;
}
DLLExport
modelica_metatype omc_ComponentReference_toStringList(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_metatype _outStringList = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_outStringList = listReverseInPlace(omc_ComponentReference_toStringList__tail(threadData, _inCref, tmpMeta[0]));
_return: OMC_LABEL_UNUSED
return _outStringList;
}
DLLExport
modelica_metatype omc_ComponentReference_splitCrefFirst(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype *out_outCrefRest)
{
modelica_metatype _outCrefFirst = NULL;
modelica_metatype _outCrefRest = NULL;
modelica_string _id = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _subs = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = _inCref;
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[0],0,4) == 0) MMC_THROW_INTERNAL();
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 5));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_outCrefRest = tmpMeta[4];
tmpMeta[0] = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, _id, _ty, _subs);
_outCrefFirst = tmpMeta[0];
_return: OMC_LABEL_UNUSED
if (out_outCrefRest) { *out_outCrefRest = _outCrefRest; }
return _outCrefFirst;
}
DLLExport
modelica_metatype omc_ComponentReference_firstNCrefs(threadData_t *threadData, modelica_metatype _inCref, modelica_integer _nIn)
{
modelica_metatype _outFirstCrefs = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp3_1;volatile modelica_integer tmp3_2;
tmp3_1 = _inCref;
tmp3_2 = _nIn;
{
modelica_string _id = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _prefix = NULL;
modelica_metatype _last = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 5; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (0 != tmp3_2) goto tmp2_end;
tmp3 += 1;
tmpMeta[0] = _inCref;
goto tmp2_done;
}
case 1: {
if (1 != tmp3_2) goto tmp2_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
tmp3 += 1;
tmpMeta[1] = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, _id, _ty, _subs);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmp3 += 1;
tmpMeta[0] = _inCref;
goto tmp2_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_last = tmpMeta[4];
_prefix = omc_ComponentReference_firstNCrefs(threadData, _last, ((modelica_integer) -1) + _nIn);
tmpMeta[1] = mmc_mk_box5(3, &DAE_ComponentRef_CREF__QUAL__desc, _id, _ty, _subs, _prefix);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 4: {
tmpMeta[0] = _inCref;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 5) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_outFirstCrefs = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outFirstCrefs;
}
modelica_metatype boxptr_ComponentReference_firstNCrefs(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _nIn)
{
modelica_integer tmp1;
modelica_metatype _outFirstCrefs = NULL;
tmp1 = mmc_unbox_integer(_nIn);
_outFirstCrefs = omc_ComponentReference_firstNCrefs(threadData, _inCref, tmp1);
return _outFirstCrefs;
}
DLLExport
modelica_metatype omc_ComponentReference_splitCrefLast(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype *out_outLastCref)
{
modelica_metatype _outPrefixCref = NULL;
modelica_metatype _outLastCref = NULL;
modelica_metatype tmpMeta[6] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inCref;
{
modelica_string _id = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _prefix = NULL;
modelica_metatype _last = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[5],1,3) == 0) goto tmp3_end;
_id = tmpMeta[2];
_ty = tmpMeta[3];
_subs = tmpMeta[4];
_last = tmpMeta[5];
tmpMeta[2] = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, _id, _ty, _subs);
tmpMeta[0+0] = tmpMeta[2];
tmpMeta[0+1] = _last;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_id = tmpMeta[2];
_ty = tmpMeta[3];
_subs = tmpMeta[4];
_last = tmpMeta[5];
_prefix = omc_ComponentReference_splitCrefLast(threadData, _last ,&_last);
tmpMeta[2] = mmc_mk_box5(3, &DAE_ComponentRef_CREF__QUAL__desc, _id, _ty, _subs, _prefix);
tmpMeta[0+0] = tmpMeta[2];
tmpMeta[0+1] = _last;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outPrefixCref = tmpMeta[0+0];
_outLastCref = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_outLastCref) { *out_outLastCref = _outLastCref; }
return _outPrefixCref;
}
DLLExport
modelica_metatype omc_ComponentReference_replaceWholeDimSubscript2(threadData_t *threadData, modelica_metatype _isubs, modelica_integer _index)
{
modelica_metatype _osubs = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _isubs;
{
modelica_metatype _sub = NULL;
modelica_metatype _subs = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],0,0) == 0) goto tmp2_end;
_subs = tmpMeta[2];
tmpMeta[1] = mmc_mk_box2(3, &DAE_Exp_ICONST__desc, mmc_mk_integer(_index));
tmpMeta[2] = mmc_mk_box2(5, &DAE_Subscript_INDEX__desc, tmpMeta[1]);
_sub = tmpMeta[2];
tmpMeta[1] = mmc_mk_cons(_sub, _subs);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
_sub = tmpMeta[1];
_subs = tmpMeta[2];
_subs = omc_ComponentReference_replaceWholeDimSubscript2(threadData, _subs, _index);
tmpMeta[1] = mmc_mk_cons(_sub, _subs);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_osubs = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _osubs;
}
modelica_metatype boxptr_ComponentReference_replaceWholeDimSubscript2(threadData_t *threadData, modelica_metatype _isubs, modelica_metatype _index)
{
modelica_integer tmp1;
modelica_metatype _osubs = NULL;
tmp1 = mmc_unbox_integer(_index);
_osubs = omc_ComponentReference_replaceWholeDimSubscript2(threadData, _isubs, tmp1);
return _osubs;
}
DLLExport
modelica_metatype omc_ComponentReference_replaceWholeDimSubscript(threadData_t *threadData, modelica_metatype _icr, modelica_integer _index)
{
modelica_metatype _ocr = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp3_1;
tmp3_1 = _icr;
{
modelica_string _id = NULL;
modelica_metatype _et = NULL;
modelica_metatype _ss = NULL;
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 3; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_et = tmpMeta[2];
_ss = tmpMeta[3];
_cr = tmpMeta[4];
_ss = omc_ComponentReference_replaceWholeDimSubscript2(threadData, _ss, _index);
tmpMeta[1] = mmc_mk_box5(3, &DAE_ComponentRef_CREF__QUAL__desc, _id, _et, _ss, _cr);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_et = tmpMeta[2];
_ss = tmpMeta[3];
_cr = tmpMeta[4];
tmp3 += 1;
_cr = omc_ComponentReference_replaceWholeDimSubscript(threadData, _cr, _index);
tmpMeta[1] = mmc_mk_box5(3, &DAE_ComponentRef_CREF__QUAL__desc, _id, _et, _ss, _cr);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id = tmpMeta[1];
_et = tmpMeta[2];
_ss = tmpMeta[3];
_ss = omc_ComponentReference_replaceWholeDimSubscript2(threadData, _ss, _index);
tmpMeta[1] = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, _id, _et, _ss);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 3) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_ocr = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _ocr;
}
modelica_metatype boxptr_ComponentReference_replaceWholeDimSubscript(threadData_t *threadData, modelica_metatype _icr, modelica_metatype _index)
{
modelica_integer tmp1;
modelica_metatype _ocr = NULL;
tmp1 = mmc_unbox_integer(_index);
_ocr = omc_ComponentReference_replaceWholeDimSubscript(threadData, _icr, tmp1);
return _ocr;
}
DLLExport
void omc_ComponentReference_printComponentRefList(threadData_t *threadData, modelica_metatype _crs)
{
modelica_string _buffer = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = stringAppend(_OMC_LIT32,stringDelimitList(omc_List_map(threadData, _crs, boxvar_ComponentReference_printComponentRefStr), _OMC_LIT33));
tmpMeta[1] = stringAppend(tmpMeta[0],_OMC_LIT34);
_buffer = tmpMeta[1];
fputs(MMC_STRINGDATA(_buffer),stdout);
_return: OMC_LABEL_UNUSED
return;
}
DLLExport
modelica_string omc_ComponentReference_printComponentRefListStr(threadData_t *threadData, modelica_metatype _crs)
{
modelica_string _res = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = stringAppend(_OMC_LIT32,stringDelimitList(omc_List_map(threadData, _crs, boxvar_ComponentReference_printComponentRefStr), _OMC_LIT3));
tmpMeta[1] = stringAppend(tmpMeta[0],_OMC_LIT35);
_res = tmpMeta[1];
_return: OMC_LABEL_UNUSED
return _res;
}
PROTECTED_FUNCTION_STATIC void omc_ComponentReference_printComponentRef2(threadData_t *threadData, modelica_string _inString, modelica_metatype _inSubscriptLst)
{
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_string tmp3_1;volatile modelica_metatype tmp3_2;
tmp3_1 = _inString;
tmp3_2 = _inSubscriptLst;
{
modelica_string _s = NULL;
modelica_metatype _l = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_2)) goto tmp2_end;
_s = tmp3_1;
omc_Print_printBuf(threadData, _s);
goto tmp2_done;
}
case 1: {
_s = tmp3_1;
_l = tmp3_2;
if(omc_Config_modelicaOutput(threadData))
{
omc_Print_printBuf(threadData, _s);
omc_Print_printBuf(threadData, _OMC_LIT36);
omc_ExpressionDump_printList(threadData, _l, boxvar_ExpressionDump_printSubscript, _OMC_LIT3);
omc_Print_printBuf(threadData, _OMC_LIT37);
}
else
{
omc_Print_printBuf(threadData, _s);
omc_Print_printBuf(threadData, _OMC_LIT2);
omc_ExpressionDump_printList(threadData, _l, boxvar_ExpressionDump_printSubscript, _OMC_LIT3);
omc_Print_printBuf(threadData, _OMC_LIT6);
}
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 2) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
;
_return: OMC_LABEL_UNUSED
return;
}
DLLExport
void omc_ComponentReference_printComponentRef(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
modelica_string _s = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cr = NULL;
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 7: {
omc_Print_printBuf(threadData, _OMC_LIT38);
goto tmp2_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_s = tmpMeta[0];
_subs = tmpMeta[1];
omc_ComponentReference_printComponentRef2(threadData, _s, _subs);
goto tmp2_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_s = tmpMeta[0];
_subs = tmpMeta[1];
_cr = tmpMeta[2];
if(omc_Config_modelicaOutput(threadData))
{
omc_ComponentReference_printComponentRef2(threadData, _s, _subs);
omc_Print_printBuf(threadData, _OMC_LIT39);
omc_ComponentReference_printComponentRef(threadData, _cr);
}
else
{
omc_ComponentReference_printComponentRef2(threadData, _s, _subs);
omc_Print_printBuf(threadData, _OMC_LIT10);
omc_ComponentReference_printComponentRef(threadData, _cr);
}
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
;
_return: OMC_LABEL_UNUSED
return;
}
DLLExport
modelica_metatype omc_ComponentReference_stringifyComponentRef(threadData_t *threadData, modelica_metatype _cr)
{
modelica_metatype _outComponentRef = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cr_1 = NULL;
modelica_string _crs = NULL;
modelica_metatype _ty = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_subs = omc_ComponentReference_crefLastSubs(threadData, _cr);
_cr_1 = omc_ComponentReference_crefStripLastSubs(threadData, _cr);
_crs = omc_ComponentReference_printComponentRefStr(threadData, _cr_1);
_ty = omc_ComponentReference_crefLastType(threadData, _cr);
_outComponentRef = omc_ComponentReference_makeCrefIdent(threadData, _crs, _ty, _subs);
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
DLLExport
modelica_metatype omc_ComponentReference_crefStripLastSubsStringified(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_metatype _outComponentRef = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
modelica_metatype _lst = NULL;
modelica_metatype _lst_1 = NULL;
modelica_string _id_1 = NULL;
modelica_string _id = NULL;
modelica_metatype _cr = NULL;
modelica_metatype _t2 = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
if (!listEmpty(tmpMeta[3])) goto tmp2_end;
_id = tmpMeta[1];
_t2 = tmpMeta[2];
_lst = omc_Util_stringSplitAtChar(threadData, _id, _OMC_LIT2);
_lst_1 = omc_List_stripLast(threadData, _lst);
_id_1 = stringDelimitList(_lst_1, _OMC_LIT2);
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _id_1, _t2, tmpMeta[1]);
goto tmp2_done;
}
case 1: {
_cr = tmp3_1;
tmpMeta[0] = _cr;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 2) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_outComponentRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
DLLExport
modelica_metatype omc_ComponentReference_crefStripFirstIdent(threadData_t *threadData, modelica_metatype _inCr)
{
modelica_metatype _outCr = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCr;
{
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 1; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_cr = tmpMeta[1];
tmpMeta[0] = _cr;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCr = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCr;
}
DLLExport
modelica_metatype omc_ComponentReference_crefStripIterSub(threadData_t *threadData, modelica_metatype _inComponentRef, modelica_string _iter)
{
modelica_metatype _outComponentRef = NULL;
modelica_string _ident = NULL;
modelica_string _index = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cref = NULL;
modelica_metatype tmpMeta[10] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 4; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
modelica_boolean tmp5;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
if (listEmpty(tmpMeta[3])) goto tmp2_end;
tmpMeta[4] = MMC_CAR(tmpMeta[3]);
tmpMeta[5] = MMC_CDR(tmpMeta[3]);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[4],2,1) == 0) goto tmp2_end;
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[6],6,2) == 0) goto tmp2_end;
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[6]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[7],1,3) == 0) goto tmp2_end;
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[7]), 2));
if (!listEmpty(tmpMeta[5])) goto tmp2_end;
_ident = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_index = tmpMeta[8];
tmp5 = (modelica_boolean)((stringEqual(_OMC_LIT40, _iter)) || (stringEqual(_index, _iter)));
if(tmp5)
{
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[2] = tmpMeta[1];
}
else
{
tmpMeta[2] = _subs;
}
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _ident, _ty, tmpMeta[2]);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
if (listEmpty(tmpMeta[3])) goto tmp2_end;
tmpMeta[4] = MMC_CAR(tmpMeta[3]);
tmpMeta[5] = MMC_CDR(tmpMeta[3]);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[4],2,1) == 0) goto tmp2_end;
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[6],6,2) == 0) goto tmp2_end;
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[6]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[7],1,3) == 0) goto tmp2_end;
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[7]), 2));
if (!listEmpty(tmpMeta[5])) goto tmp2_end;
tmpMeta[9] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_ident = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_index = tmpMeta[8];
_cref = tmpMeta[9];
if(((stringEqual(_OMC_LIT40, _iter)) || (stringEqual(_index, _iter))))
{
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
_subs = tmpMeta[1];
}
else
{
_cref = omc_ComponentReference_crefStripIterSub(threadData, _cref, _iter);
}
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _ident, _ty, _subs, _cref);
goto tmp2_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_ident = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_cref = tmpMeta[4];
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _ident, _ty, _subs, omc_ComponentReference_crefStripIterSub(threadData, _cref, _iter));
goto tmp2_done;
}
case 3: {
tmpMeta[0] = _inComponentRef;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outComponentRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
DLLExport
modelica_metatype omc_ComponentReference_crefStripLastSubs(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_metatype _outComponentRef = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
modelica_string _id = NULL;
modelica_metatype _s = NULL;
modelica_metatype _cr_1 = NULL;
modelica_metatype _cr = NULL;
modelica_metatype _t2 = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
_id = tmpMeta[1];
_t2 = tmpMeta[2];
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _id, _t2, tmpMeta[1]);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_t2 = tmpMeta[2];
_s = tmpMeta[3];
_cr = tmpMeta[4];
_cr_1 = omc_ComponentReference_crefStripLastSubs(threadData, _cr);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _t2, _s, _cr_1);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outComponentRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
DLLExport
modelica_metatype omc_ComponentReference_crefStripLastIdent(threadData_t *threadData, modelica_metatype _inCr)
{
modelica_metatype _outCr = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp3_1;
tmp3_1 = _inCr;
{
modelica_string _id = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cr1 = NULL;
modelica_metatype _cr = NULL;
modelica_metatype _t2 = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[4],1,3) == 0) goto tmp2_end;
_id = tmpMeta[1];
_t2 = tmpMeta[2];
_subs = tmpMeta[3];
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _id, _t2, _subs);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_t2 = tmpMeta[2];
_subs = tmpMeta[3];
_cr = tmpMeta[4];
_cr1 = omc_ComponentReference_crefStripLastIdent(threadData, _cr);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _t2, _subs, _cr1);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 2) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_outCr = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCr;
}
DLLExport
modelica_metatype omc_ComponentReference_crefStripPrefix(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _prefix)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[7] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;modelica_metatype tmp3_2;
tmp3_1 = _cref;
tmp3_2 = _prefix;
{
modelica_metatype _subs1 = NULL;
modelica_metatype _subs2 = NULL;
modelica_metatype _cr1 = NULL;
modelica_metatype _cr2 = NULL;
modelica_string _id1 = NULL;
modelica_string _id2 = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
modelica_boolean tmp5;
modelica_boolean tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
if (mmc__uniontype__metarecord__typedef__equal(tmp3_2,1,3) == 0) goto tmp2_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 2));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 4));
_id1 = tmpMeta[1];
_subs1 = tmpMeta[2];
_cr1 = tmpMeta[3];
_id2 = tmpMeta[4];
_subs2 = tmpMeta[5];
tmp5 = (stringEqual(_id1, _id2));
if (1 != tmp5) goto goto_1;
tmp6 = omc_Expression_subscriptEqual(threadData, _subs1, _subs2);
if (1 != tmp6) goto goto_1;
tmpMeta[0] = _cr1;
goto tmp2_done;
}
case 1: {
modelica_boolean tmp7;
modelica_boolean tmp8;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
if (mmc__uniontype__metarecord__typedef__equal(tmp3_2,0,4) == 0) goto tmp2_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 2));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 4));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 5));
_id1 = tmpMeta[1];
_subs1 = tmpMeta[2];
_cr1 = tmpMeta[3];
_id2 = tmpMeta[4];
_subs2 = tmpMeta[5];
_cr2 = tmpMeta[6];
tmp7 = (stringEqual(_id1, _id2));
if (1 != tmp7) goto goto_1;
tmp8 = omc_Expression_subscriptEqual(threadData, _subs1, _subs2);
if (1 != tmp8) goto goto_1;
_cref = _cr1;
_prefix = _cr2;
goto _tailrecursive;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_crefStripSubsExceptModelSubs(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCref;
{
modelica_string _id = NULL;
modelica_metatype _cr = NULL;
modelica_metatype _cref = NULL;
modelica_metatype _ty = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 4; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],6,2) == 0) goto tmp2_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],9,3) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[3],2,1) == 0) goto tmp2_end;
_cref = tmp3_1;
tmpMeta[0] = _cref;
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],6,2) == 0) goto tmp2_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],9,3) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[3],2,1) == 0) goto tmp2_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_cref = tmp3_1;
_cr = tmpMeta[4];
_outCref = omc_ComponentReference_crefStripSubsExceptModelSubs(threadData, _cr);
tmpMeta[1] = MMC_TAGPTR(mmc_alloc_words(6));
memcpy(MMC_UNTAGPTR(tmpMeta[1]), MMC_UNTAGPTR(_cref), 6*sizeof(modelica_metatype));
((modelica_metatype*)MMC_UNTAGPTR(tmpMeta[1]))[5] = _outCref;
_cref = tmpMeta[1];
tmpMeta[0] = _cref;
goto tmp2_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
_id = tmpMeta[1];
_ty = tmpMeta[2];
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _id, _ty, tmpMeta[1]);
goto tmp2_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_cr = tmpMeta[3];
_outCref = omc_ComponentReference_crefStripSubsExceptModelSubs(threadData, _cr);
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _ty, tmpMeta[1], _outCref);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_crefStripSubs(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCref;
{
modelica_string _id = NULL;
modelica_metatype _cr = NULL;
modelica_metatype _ty = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
_id = tmpMeta[1];
_ty = tmpMeta[2];
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _id, _ty, tmpMeta[1]);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_cr = tmpMeta[3];
_outCref = omc_ComponentReference_crefStripSubs(threadData, _cr);
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _ty, tmpMeta[1], _outCref);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCref;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_removeSliceSubs(threadData_t *threadData, modelica_metatype _subs)
{
modelica_metatype _osubs = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_osubs = tmpMeta[0];
{
modelica_metatype _s;
for (tmpMeta[1] = _subs; !listEmpty(tmpMeta[1]); tmpMeta[1]=MMC_CDR(tmpMeta[1]))
{
_s = MMC_CAR(tmpMeta[1]);
{
modelica_metatype tmp3_1;
tmp3_1 = _s;
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,1) == 0) goto tmp2_end;
tmpMeta[2] = _osubs;
goto tmp2_done;
}
case 1: {
tmpMeta[3] = mmc_mk_cons(_s, _osubs);
tmpMeta[2] = tmpMeta[3];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_osubs = tmpMeta[2];
}
}
_osubs = listReverseInPlace(_osubs);
_return: OMC_LABEL_UNUSED
return _osubs;
}
DLLExport
modelica_metatype omc_ComponentReference_stripArrayCref(threadData_t *threadData, modelica_metatype _crefIn, modelica_integer *out_idxOut, modelica_metatype *out_crefTail)
{
modelica_metatype _crefHead = NULL;
modelica_integer _idxOut;
modelica_metatype _crefTail = NULL;
modelica_integer tmp1_c1 __attribute__((unused)) = 0;
modelica_metatype tmpMeta[11] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _crefIn;
{
modelica_integer _idx;
modelica_string _id = NULL;
modelica_metatype _cr = NULL;
modelica_metatype _outCref = NULL;
modelica_metatype _ty = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 3; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
modelica_integer tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (listEmpty(tmpMeta[5])) goto tmp3_end;
tmpMeta[6] = MMC_CAR(tmpMeta[5]);
tmpMeta[7] = MMC_CDR(tmpMeta[5]);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[6],2,1) == 0) goto tmp3_end;
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[6]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[8],0,1) == 0) goto tmp3_end;
tmpMeta[9] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[8]), 2));
tmp6 = mmc_unbox_integer(tmpMeta[9]);
if (!listEmpty(tmpMeta[7])) goto tmp3_end;
_id = tmpMeta[3];
_ty = tmpMeta[4];
_idx = tmp6;
tmpMeta[3] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0+0] = omc_ComponentReference_makeCrefIdent(threadData, _id, _ty, tmpMeta[3]);
tmp1_c1 = _idx;
tmpMeta[0+2] = mmc_mk_none();
goto tmp3_done;
}
case 1: {
modelica_integer tmp7;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (listEmpty(tmpMeta[5])) goto tmp3_end;
tmpMeta[6] = MMC_CAR(tmpMeta[5]);
tmpMeta[7] = MMC_CDR(tmpMeta[5]);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[6],2,1) == 0) goto tmp3_end;
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[6]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[8],0,1) == 0) goto tmp3_end;
tmpMeta[9] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[8]), 2));
tmp7 = mmc_unbox_integer(tmpMeta[9]);
if (!listEmpty(tmpMeta[7])) goto tmp3_end;
tmpMeta[10] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_id = tmpMeta[3];
_ty = tmpMeta[4];
_idx = tmp7;
_cr = tmpMeta[10];
tmpMeta[3] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0+0] = omc_ComponentReference_makeCrefIdent(threadData, _id, _ty, tmpMeta[3]);
tmp1_c1 = _idx;
tmpMeta[0+2] = mmc_mk_some(_cr);
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_id = tmpMeta[3];
_ty = tmpMeta[4];
_cr = tmpMeta[5];
_outCref = omc_ComponentReference_stripCrefIdentSliceSubs(threadData, _cr);
tmpMeta[3] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0+0] = omc_ComponentReference_makeCrefQual(threadData, _id, _ty, tmpMeta[3], _outCref);
tmp1_c1 = ((modelica_integer) -1);
tmpMeta[0+2] = mmc_mk_none();
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_crefHead = tmpMeta[0+0];
_idxOut = tmp1_c1;
_crefTail = tmpMeta[0+2];
_return: OMC_LABEL_UNUSED
if (out_idxOut) { *out_idxOut = _idxOut; }
if (out_crefTail) { *out_crefTail = _crefTail; }
return _crefHead;
}
modelica_metatype boxptr_ComponentReference_stripArrayCref(threadData_t *threadData, modelica_metatype _crefIn, modelica_metatype *out_idxOut, modelica_metatype *out_crefTail)
{
modelica_integer _idxOut;
modelica_metatype _crefHead = NULL;
_crefHead = omc_ComponentReference_stripArrayCref(threadData, _crefIn, &_idxOut, out_crefTail);
if (out_idxOut) { *out_idxOut = mmc_mk_icon(_idxOut); }
return _crefHead;
}
DLLExport
modelica_metatype omc_ComponentReference_stripCrefIdentSliceSubs(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCref;
{
modelica_string _id = NULL;
modelica_metatype _cr = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _subs = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_subs = omc_ComponentReference_removeSliceSubs(threadData, _subs);
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _id, _ty, _subs);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_cr = tmpMeta[4];
_outCref = omc_ComponentReference_stripCrefIdentSliceSubs(threadData, _cr);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _ty, _subs, _outCref);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCref;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_replaceSliceSub(threadData_t *threadData, modelica_metatype _inSubs, modelica_metatype _inSub)
{
modelica_metatype _osubs = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp3_1;
tmp3_1 = _inSubs;
{
modelica_metatype _subs = NULL;
modelica_metatype _sub = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 3; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],1,1) == 0) goto tmp2_end;
_subs = tmpMeta[2];
tmp3 += 1;
tmpMeta[0] = listAppend(_inSub, _subs);
goto tmp2_done;
}
case 1: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],0,0) == 0) goto tmp2_end;
_subs = tmpMeta[2];
tmpMeta[0] = listAppend(_inSub, _subs);
goto tmp2_done;
}
case 2: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
_sub = tmpMeta[1];
_subs = tmpMeta[2];
_subs = omc_ComponentReference_replaceSliceSub(threadData, _subs, _inSub);
tmpMeta[1] = mmc_mk_cons(_sub, _subs);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 3) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_osubs = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _osubs;
}
DLLExport
modelica_metatype omc_ComponentReference_replaceCrefSliceSub(threadData_t *threadData, modelica_metatype _inCr, modelica_metatype _newSub)
{
modelica_metatype _outCr = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp3_1;
tmp3_1 = _inCr;
{
modelica_metatype _t2 = NULL;
modelica_metatype _identType = NULL;
modelica_metatype _child = NULL;
modelica_metatype _subs = NULL;
modelica_string _name = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 7; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_name = tmpMeta[1];
_identType = tmpMeta[2];
_subs = tmpMeta[3];
_subs = omc_ComponentReference_replaceSliceSub(threadData, _subs, _newSub);
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _name, _identType, _subs);
goto tmp2_done;
}
case 1: {
modelica_boolean tmp5;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_t2 = tmpMeta[1];
_subs = tmpMeta[2];
tmp5 = (listLength(omc_Expression_arrayTypeDimensions(threadData, _t2)) >= ((modelica_integer) 1) + listLength(_subs));
if (1 != tmp5) goto goto_1;
tmpMeta[0] = omc_ComponentReference_subscriptCref(threadData, _inCr, _newSub);
goto tmp2_done;
}
case 2: {
modelica_boolean tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_t2 = tmpMeta[1];
_subs = tmpMeta[2];
tmp3 += 3;
tmp6 = (listLength(omc_Expression_arrayTypeDimensions(threadData, _t2)) >= listLength(_subs) + listLength(_newSub));
if (0 != tmp6) goto goto_1;
_child = omc_ComponentReference_subscriptCref(threadData, _inCr, _newSub);
if(omc_Flags_isSet(threadData, _OMC_LIT30))
{
omc_Debug_trace(threadData, _OMC_LIT41);
}
tmpMeta[0] = _child;
goto tmp2_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_name = tmpMeta[1];
_identType = tmpMeta[2];
_subs = tmpMeta[3];
_child = tmpMeta[4];
_subs = omc_ComponentReference_replaceSliceSub(threadData, _subs, _newSub);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _name, _identType, _subs, _child);
goto tmp2_done;
}
case 4: {
modelica_boolean tmp7;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_name = tmpMeta[1];
_identType = tmpMeta[2];
_subs = tmpMeta[3];
_child = tmpMeta[4];
tmp7 = (listLength(omc_Expression_arrayTypeDimensions(threadData, _identType)) >= ((modelica_integer) 1) + listLength(_subs));
if (1 != tmp7) goto goto_1;
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _name, _identType, listAppend(_subs, _newSub), _child);
goto tmp2_done;
}
case 5: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_name = tmpMeta[1];
_identType = tmpMeta[2];
_subs = tmpMeta[3];
_child = tmpMeta[4];
_child = omc_ComponentReference_replaceCrefSliceSub(threadData, _child, _newSub);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _name, _identType, _subs, _child);
goto tmp2_done;
}
case 6: {
modelica_boolean tmp8;
tmp8 = omc_Flags_isSet(threadData, _OMC_LIT30);
if (1 != tmp8) goto goto_1;
omc_Debug_trace(threadData, _OMC_LIT42);
goto goto_1;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 7) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_outCr = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCr;
}
DLLExport
modelica_metatype omc_ComponentReference_crefSetLastType(threadData_t *threadData, modelica_metatype _inRef, modelica_metatype _newType)
{
modelica_metatype _outRef = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inRef;
{
modelica_metatype _ty = NULL;
modelica_metatype _child = NULL;
modelica_metatype _subs = NULL;
modelica_string _id = NULL;
modelica_integer _idx;
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id = tmpMeta[1];
_subs = tmpMeta[2];
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _id, _newType, _subs);
goto tmp2_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_child = tmpMeta[4];
_child = omc_ComponentReference_crefSetLastType(threadData, _child, _newType);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _ty, _subs, _child);
goto tmp2_done;
}
case 5: {
modelica_integer tmp4;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmp4 = mmc_unbox_integer(tmpMeta[2]);
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_idx = tmp4;
_subs = tmpMeta[3];
tmpMeta[1] = mmc_mk_box5(5, &DAE_ComponentRef_CREF__ITER__desc, _id, mmc_mk_integer(_idx), _newType, _subs);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outRef;
}
DLLExport
modelica_metatype omc_ComponentReference_crefSetType(threadData_t *threadData, modelica_metatype _inRef, modelica_metatype _newType)
{
modelica_metatype _outRef = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inRef;
{
modelica_metatype _child = NULL;
modelica_metatype _subs = NULL;
modelica_string _id = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id = tmpMeta[1];
_subs = tmpMeta[2];
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _id, _newType, _subs);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_subs = tmpMeta[2];
_child = tmpMeta[3];
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _newType, _subs, _child);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outRef;
}
DLLExport
modelica_metatype omc_ComponentReference_crefApplySubs(threadData_t *threadData, modelica_metatype _inComponentRef, modelica_metatype _inSubs)
{
modelica_metatype _outComponentRef = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
modelica_string _id = NULL;
modelica_metatype _tp = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 4; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],6,2) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id = tmpMeta[1];
_tp = tmpMeta[2];
_subs = tmpMeta[3];
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _id, _tp, listAppend(_subs, _inSubs));
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],6,2) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_tp = tmpMeta[2];
_subs = tmpMeta[3];
_cr = tmpMeta[4];
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _tp, listAppend(_subs, _inSubs), _cr);
goto tmp2_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_tp = tmpMeta[2];
_subs = tmpMeta[3];
_cr = tmpMeta[4];
_cr = omc_ComponentReference_crefApplySubs(threadData, _cr, _inSubs);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _tp, _subs, _cr);
goto tmp2_done;
}
case 3: {
omc_Error_addInternalError(threadData, _OMC_LIT43, _OMC_LIT44);
goto goto_1;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outComponentRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
DLLExport
modelica_metatype omc_ComponentReference_crefSetLastSubs(threadData_t *threadData, modelica_metatype _inComponentRef, modelica_metatype _inSubs)
{
modelica_metatype _outComponentRef = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
modelica_string _id = NULL;
modelica_metatype _tp = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
_id = tmpMeta[1];
_tp = tmpMeta[2];
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _id, _tp, _inSubs);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_tp = tmpMeta[2];
_subs = tmpMeta[3];
_cr = tmpMeta[4];
_cr = omc_ComponentReference_crefSetLastSubs(threadData, _cr, _inSubs);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _tp, _subs, _cr);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outComponentRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
DLLExport
modelica_metatype omc_ComponentReference_subscriptCrefWithInt(threadData_t *threadData, modelica_metatype _inComponentRef, modelica_integer _inSubscript)
{
modelica_metatype _outComponentRef = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
modelica_metatype _subs = NULL;
modelica_metatype _new_sub = NULL;
modelica_string _id = NULL;
modelica_metatype _rest_cref = NULL;
modelica_metatype _ty = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
tmpMeta[1] = mmc_mk_box2(3, &DAE_Exp_ICONST__desc, mmc_mk_integer(_inSubscript));
tmpMeta[2] = mmc_mk_box2(5, &DAE_Subscript_INDEX__desc, tmpMeta[1]);
_new_sub = tmpMeta[2];
_subs = omc_List_appendElt(threadData, _new_sub, _subs);
_ty = omc_Expression_unliftArray(threadData, _ty);
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _id, _ty, _subs);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_rest_cref = tmpMeta[4];
_rest_cref = omc_ComponentReference_subscriptCrefWithInt(threadData, _rest_cref, _inSubscript);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _ty, _subs, _rest_cref);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outComponentRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
modelica_metatype boxptr_ComponentReference_subscriptCrefWithInt(threadData_t *threadData, modelica_metatype _inComponentRef, modelica_metatype _inSubscript)
{
modelica_integer tmp1;
modelica_metatype _outComponentRef = NULL;
tmp1 = mmc_unbox_integer(_inSubscript);
_outComponentRef = omc_ComponentReference_subscriptCrefWithInt(threadData, _inComponentRef, tmp1);
return _outComponentRef;
}
DLLExport
modelica_metatype omc_ComponentReference_subscriptCref(threadData_t *threadData, modelica_metatype _inComponentRef, modelica_metatype _inSubscriptLst)
{
modelica_metatype _outComponentRef = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;modelica_metatype tmp3_2;
tmp3_1 = _inComponentRef;
tmp3_2 = _inSubscriptLst;
{
modelica_metatype _newsub_1 = NULL;
modelica_metatype _sub = NULL;
modelica_metatype _newsub = NULL;
modelica_string _id = NULL;
modelica_metatype _cref_1 = NULL;
modelica_metatype _cref = NULL;
modelica_metatype _t2 = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id = tmpMeta[1];
_t2 = tmpMeta[2];
_sub = tmpMeta[3];
_newsub = tmp3_2;
_newsub_1 = listAppend(_sub, _newsub);
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _id, _t2, _newsub_1);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_t2 = tmpMeta[2];
_sub = tmpMeta[3];
_cref = tmpMeta[4];
_newsub = tmp3_2;
_cref_1 = omc_ComponentReference_subscriptCref(threadData, _cref, _newsub);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _t2, _sub, _cref_1);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outComponentRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
DLLExport
modelica_metatype omc_ComponentReference_joinCrefsExp(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fexp, modelica_metatype __omcQ_24in_5Fcref, modelica_metatype *out_cref)
{
modelica_metatype _exp = NULL;
modelica_metatype _cref = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_exp = __omcQ_24in_5Fexp;
_cref = __omcQ_24in_5Fcref;
{
modelica_metatype tmp3_1;
tmp3_1 = _exp;
{
modelica_metatype _cr = NULL;
modelica_metatype _tp = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,6,2) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
_cr = tmpMeta[1];
_tp = tmpMeta[2];
_cr = omc_ComponentReference_joinCrefs(threadData, _cref, _cr);
tmpMeta[1] = mmc_mk_box3(9, &DAE_Exp_CREF__desc, _cr, _tp);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
tmpMeta[0] = _exp;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_exp = tmpMeta[0];
_return: OMC_LABEL_UNUSED
if (out_cref) { *out_cref = _cref; }
return _exp;
}
DLLExport
modelica_metatype omc_ComponentReference_joinCrefsR(threadData_t *threadData, modelica_metatype _inComponentRef2, modelica_metatype _inComponentRef1)
{
modelica_metatype _outComponentRef = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;modelica_metatype tmp3_2;
tmp3_1 = _inComponentRef2;
tmp3_2 = _inComponentRef1;
{
modelica_string _id = NULL;
modelica_metatype _sub = NULL;
modelica_metatype _cr2 = NULL;
modelica_metatype _cr_1 = NULL;
modelica_metatype _cr = NULL;
modelica_metatype _t2 = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_2,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 4));
_id = tmpMeta[1];
_t2 = tmpMeta[2];
_sub = tmpMeta[3];
_cr2 = tmp3_1;
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _t2, _sub, _cr2);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_2,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 5));
_id = tmpMeta[1];
_t2 = tmpMeta[2];
_sub = tmpMeta[3];
_cr = tmpMeta[4];
_cr2 = tmp3_1;
_cr_1 = omc_ComponentReference_joinCrefs(threadData, _cr, _cr2);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _t2, _sub, _cr_1);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outComponentRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
DLLExport
modelica_metatype omc_ComponentReference_joinCrefs(threadData_t *threadData, modelica_metatype _inComponentRef1, modelica_metatype _inComponentRef2)
{
modelica_metatype _outComponentRef = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;modelica_metatype tmp3_2;
tmp3_1 = _inComponentRef1;
tmp3_2 = _inComponentRef2;
{
modelica_string _id = NULL;
modelica_metatype _sub = NULL;
modelica_metatype _cr2 = NULL;
modelica_metatype _cr_1 = NULL;
modelica_metatype _cr = NULL;
modelica_metatype _t2 = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id = tmpMeta[1];
_t2 = tmpMeta[2];
_sub = tmpMeta[3];
_cr2 = tmp3_2;
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _t2, _sub, _cr2);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_t2 = tmpMeta[2];
_sub = tmpMeta[3];
_cr = tmpMeta[4];
_cr2 = tmp3_2;
_cr_1 = omc_ComponentReference_joinCrefs(threadData, _cr, _cr2);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id, _t2, _sub, _cr_1);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outComponentRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
DLLExport
modelica_metatype omc_ComponentReference_appendStringLastIdent(threadData_t *threadData, modelica_string _inString, modelica_metatype _inCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCref;
{
modelica_string _id = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cr = NULL;
modelica_metatype _ty = NULL;
modelica_integer _idx;
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_cr = tmpMeta[4];
_cr = omc_ComponentReference_appendStringLastIdent(threadData, _inString, _cr);
tmpMeta[1] = mmc_mk_box5(3, &DAE_ComponentRef_CREF__QUAL__desc, _id, _ty, _subs, _cr);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
tmpMeta[1] = stringAppend(_id,_inString);
_id = tmpMeta[1];
tmpMeta[1] = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, _id, _ty, _subs);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 5: {
modelica_integer tmp4;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmp4 = mmc_unbox_integer(tmpMeta[2]);
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_idx = tmp4;
_ty = tmpMeta[3];
_subs = tmpMeta[4];
tmpMeta[1] = stringAppend(_id,_inString);
_id = tmpMeta[1];
tmpMeta[1] = mmc_mk_box5(5, &DAE_ComponentRef_CREF__ITER__desc, _id, mmc_mk_integer(_idx), _ty, _subs);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_appendStringFirstIdent(threadData_t *threadData, modelica_string _inString, modelica_metatype _inCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCref;
{
modelica_string _id = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cr = NULL;
modelica_metatype _ty = NULL;
modelica_integer _idx;
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_cr = tmpMeta[4];
tmpMeta[1] = stringAppend(_id,_inString);
_id = tmpMeta[1];
tmpMeta[1] = mmc_mk_box5(3, &DAE_ComponentRef_CREF__QUAL__desc, _id, _ty, _subs, _cr);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
tmpMeta[1] = stringAppend(_id,_inString);
_id = tmpMeta[1];
tmpMeta[1] = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, _id, _ty, _subs);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 5: {
modelica_integer tmp4;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmp4 = mmc_unbox_integer(tmpMeta[2]);
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_idx = tmp4;
_ty = tmpMeta[3];
_subs = tmpMeta[4];
tmpMeta[1] = stringAppend(_id,_inString);
_id = tmpMeta[1];
tmpMeta[1] = mmc_mk_box5(5, &DAE_ComponentRef_CREF__ITER__desc, _id, mmc_mk_integer(_idx), _ty, _subs);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_appendStringCref(threadData_t *threadData, modelica_string _str, modelica_metatype _cr)
{
modelica_metatype _ocr = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[1] = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, _str, _OMC_LIT0, tmpMeta[0]);
_ocr = omc_ComponentReference_joinCrefs(threadData, _cr, tmpMeta[1]);
_return: OMC_LABEL_UNUSED
return _ocr;
}
DLLExport
modelica_metatype omc_ComponentReference_prependStringCref(threadData_t *threadData, modelica_string _inString, modelica_metatype _inComponentRef)
{
modelica_metatype _outComponentRef = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_string tmp3_1;modelica_metatype tmp3_2;
tmp3_1 = _inString;
tmp3_2 = _inComponentRef;
{
modelica_string _i_1 = NULL;
modelica_string _p = NULL;
modelica_string _i = NULL;
modelica_metatype _s = NULL;
modelica_metatype _c = NULL;
modelica_metatype _t2 = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_2,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 5));
_i = tmpMeta[1];
_t2 = tmpMeta[2];
_s = tmpMeta[3];
_c = tmpMeta[4];
_p = tmp3_1;
tmpMeta[1] = stringAppend(_p,_i);
_i_1 = tmpMeta[1];
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _i_1, _t2, _s, _c);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_2,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 4));
_i = tmpMeta[1];
_t2 = tmpMeta[2];
_s = tmpMeta[3];
_p = tmp3_1;
tmpMeta[1] = stringAppend(_p,_i);
_i_1 = tmpMeta[1];
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _i_1, _t2, _s);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outComponentRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
DLLExport
modelica_metatype omc_ComponentReference_prefixWithPath(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _inPath)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inPath;
{
modelica_string _name = NULL;
modelica_metatype _rest_path = NULL;
modelica_metatype _cref = NULL;
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,1) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_name = tmpMeta[1];
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[2] = mmc_mk_box5(3, &DAE_ComponentRef_CREF__QUAL__desc, _name, _OMC_LIT0, tmpMeta[1], _inCref);
tmpMeta[0] = tmpMeta[2];
goto tmp2_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,2) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
_name = tmpMeta[1];
_rest_path = tmpMeta[2];
_cref = omc_ComponentReference_prefixWithPath(threadData, _inCref, _rest_path);
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[2] = mmc_mk_box5(3, &DAE_ComponentRef_CREF__QUAL__desc, _name, _OMC_LIT0, tmpMeta[1], _cref);
tmpMeta[0] = tmpMeta[2];
goto tmp2_done;
}
case 5: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,1) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_rest_path = tmpMeta[1];
_inPath = _rest_path;
goto _tailrecursive;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_crefPrefixStringList(threadData_t *threadData, modelica_metatype _inStrings, modelica_metatype _inCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;modelica_metatype tmp3_2;
tmp3_1 = _inStrings;
tmp3_2 = _inCref;
{
modelica_string _str = NULL;
modelica_metatype _rest_str = NULL;
modelica_metatype _cref = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
_str = tmpMeta[1];
_rest_str = tmpMeta[2];
_cref = tmp3_2;
_cref = omc_ComponentReference_crefPrefixStringList(threadData, _rest_str, _cref);
tmpMeta[0] = omc_ComponentReference_crefPrefixString(threadData, _str, _cref);
goto tmp2_done;
}
case 1: {
tmpMeta[0] = _inCref;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_crefPrefixString(threadData_t *threadData, modelica_string _inString, modelica_metatype _inCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_outCref = omc_ComponentReference_makeCrefQual(threadData, _inString, _OMC_LIT0, tmpMeta[0], _inCref);
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_crefPrefixStart(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_outCref = omc_ComponentReference_makeCrefQual(threadData, _OMC_LIT45, _OMC_LIT0, tmpMeta[0], _inCref);
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_crefRemovePrePrefix(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref)
{
modelica_metatype _cref = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_cref = __omcQ_24in_5Fcref;
{
modelica_metatype tmp3_1;
tmp3_1 = _cref;
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
if (4 != MMC_STRLEN(tmpMeta[1]) || strcmp(MMC_STRINGDATA(_OMC_LIT46), MMC_STRINGDATA(tmpMeta[1])) != 0) goto tmp2_end;
tmpMeta[0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5)));
goto tmp2_done;
}
case 1: {
tmpMeta[0] = _cref;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_cref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _cref;
}
DLLExport
modelica_metatype omc_ComponentReference_crefPrefixAux(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_outCref = omc_ComponentReference_makeCrefQual(threadData, _OMC_LIT47, _OMC_LIT48, tmpMeta[0], _inCref);
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_crefPrefixPrevious(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_outCref = omc_ComponentReference_makeCrefQual(threadData, _OMC_LIT12, _OMC_LIT0, tmpMeta[0], _inCref);
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_getConcealedCref(threadData_t *threadData)
{
modelica_metatype _outCref = NULL;
modelica_string _ident = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = stringAppend(_OMC_LIT49,intString(((modelica_integer) 1) + omc_System_tmpTick(threadData)));
_ident = tmpMeta[0];
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_outCref = omc_ComponentReference_makeCrefIdent(threadData, _ident, _OMC_LIT0, tmpMeta[0]);
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_crefPrefixPre(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_outCref = omc_ComponentReference_makeCrefQual(threadData, _OMC_LIT46, _OMC_LIT0, tmpMeta[0], _inCref);
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_crefPrefixDer(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_outCref = omc_ComponentReference_makeCrefQual(threadData, _OMC_LIT11, _OMC_LIT48, tmpMeta[0], _inCref);
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_crefPrependIdent(threadData_t *threadData, modelica_metatype _icr, modelica_string _ident, modelica_metatype _subs, modelica_metatype _tp)
{
modelica_metatype _newCr = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _icr;
{
modelica_metatype _tp1 = NULL;
modelica_string _id1 = NULL;
modelica_metatype _subs1 = NULL;
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id1 = tmpMeta[1];
_tp1 = tmpMeta[2];
_subs1 = tmpMeta[3];
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id1, _tp1, _subs1, omc_ComponentReference_makeCrefIdent(threadData, _ident, _tp, _subs));
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id1 = tmpMeta[1];
_tp1 = tmpMeta[2];
_subs1 = tmpMeta[3];
_cr = tmpMeta[4];
_cr = omc_ComponentReference_crefPrependIdent(threadData, _cr, _ident, _subs, _tp);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _id1, _tp1, _subs1, _cr);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_newCr = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _newCr;
}
DLLExport
modelica_metatype omc_ComponentReference_getArraySubs(threadData_t *threadData, modelica_metatype _name)
{
modelica_metatype _arraySubs = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
tmpMeta[0] = omc_ComponentReference_crefSubs(threadData, _name);
goto tmp2_done;
}
case 1: {
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 2) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_arraySubs = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _arraySubs;
}
DLLExport
modelica_metatype omc_ComponentReference_getArrayCref(threadData_t *threadData, modelica_metatype _name)
{
modelica_metatype _arrayCref = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
{
modelica_metatype _arrayCrefInner = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
modelica_boolean tmp5;
tmp5 = omc_ComponentReference_crefIsFirstArrayElt(threadData, _name);
if (1 != tmp5) goto goto_1;
if((stringEqual(omc_Config_simCodeTarget(threadData), _OMC_LIT50)))
{
_arrayCrefInner = omc_ComponentReference_crefStripLastSubs(threadData, _name);
}
else
{
_arrayCrefInner = omc_ComponentReference_crefStripSubs(threadData, _name);
}
tmpMeta[0] = mmc_mk_some(_arrayCrefInner);
goto tmp2_done;
}
case 1: {
tmpMeta[0] = mmc_mk_none();
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 2) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_arrayCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _arrayCref;
}
DLLExport
modelica_string omc_ComponentReference_crefNameType(threadData_t *threadData, modelica_metatype _inRef, modelica_metatype *out_res)
{
modelica_string _id = NULL;
modelica_metatype _res = NULL;
modelica_string tmp1_c0 __attribute__((unused)) = 0;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;
tmp4_1 = _inRef;
{
modelica_metatype _t2 = NULL;
modelica_string _name = NULL;
modelica_string _s = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 3; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
_name = tmpMeta[2];
_t2 = tmpMeta[3];
tmp4 += 1;
tmp1_c0 = _name;
tmpMeta[0+1] = _t2;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
_name = tmpMeta[2];
_t2 = tmpMeta[3];
tmp1_c0 = _name;
tmpMeta[0+1] = _t2;
goto tmp3_done;
}
case 2: {
modelica_boolean tmp6;
tmp6 = omc_Flags_isSet(threadData, _OMC_LIT30);
if (1 != tmp6) goto goto_2;
omc_Debug_trace(threadData, _OMC_LIT51);
_s = omc_ComponentReference_printComponentRefStr(threadData, _inRef);
omc_Debug_traceln(threadData, _s);
goto goto_2;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 3) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_id = tmp1_c0;
_res = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_res) { *out_res = _res; }
return _id;
}
DLLExport
modelica_metatype omc_ComponentReference_crefTypeConsiderSubs(threadData_t *threadData, modelica_metatype _cr)
{
modelica_metatype _res = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_res = omc_Expression_unliftArrayTypeWithSubs(threadData, omc_ComponentReference_crefLastSubs(threadData, _cr), omc_ComponentReference_crefLastType(threadData, _cr));
_return: OMC_LABEL_UNUSED
return _res;
}
DLLExport
modelica_metatype omc_ComponentReference_crefFirstCref(threadData_t *threadData, modelica_metatype _inCr)
{
modelica_metatype _outCr = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCr;
{
modelica_string _id = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _t2 = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id = tmpMeta[1];
_t2 = tmpMeta[2];
_subs = tmpMeta[3];
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _id, _t2, _subs);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[0] = _inCr;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCr = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCr;
}
DLLExport
modelica_metatype omc_ComponentReference_crefLastSubs(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_metatype _outSubscriptLst = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
modelica_metatype _subs = NULL;
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_subs = tmpMeta[1];
tmpMeta[0] = _subs;
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_cr = tmpMeta[1];
_inComponentRef = _cr;
goto _tailrecursive;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outSubscriptLst = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outSubscriptLst;
}
DLLExport
modelica_metatype omc_ComponentReference_crefFirstSubs(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_metatype _outSubscripts = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCref;
{
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 4: {
tmpMeta[0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inCref), 4)));
goto tmp2_done;
}
case 3: {
tmpMeta[0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inCref), 4)));
goto tmp2_done;
}
default:
tmp2_default: OMC_LABEL_UNUSED; {
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outSubscripts = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outSubscripts;
}
DLLExport
modelica_metatype omc_ComponentReference_crefSubs(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_metatype _outSubscriptLst = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
modelica_metatype _subs = NULL;
modelica_metatype _res = NULL;
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_subs = tmpMeta[1];
tmpMeta[0] = _subs;
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_subs = tmpMeta[1];
_cr = tmpMeta[2];
_res = omc_ComponentReference_crefSubs(threadData, _cr);
tmpMeta[0] = listAppend(_subs, _res);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outSubscriptLst = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outSubscriptLst;
}
DLLExport
modelica_metatype omc_ComponentReference_crefDims(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_metatype _outDimensionLst = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
modelica_metatype _dims = NULL;
modelica_metatype _res = NULL;
modelica_metatype _idType = NULL;
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
_idType = tmpMeta[1];
tmpMeta[0] = omc_Types_getDimensions(threadData, _idType);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_idType = tmpMeta[1];
_cr = tmpMeta[2];
_dims = omc_Types_getDimensions(threadData, _idType);
_res = omc_ComponentReference_crefDims(threadData, _cr);
tmpMeta[0] = listAppend(_dims, _res);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outDimensionLst = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outDimensionLst;
}
DLLExport
modelica_metatype omc_ComponentReference_crefLastType(threadData_t *threadData, modelica_metatype _inRef)
{
modelica_metatype _res = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inRef;
{
modelica_metatype _t2 = NULL;
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
_t2 = tmpMeta[1];
tmpMeta[0] = _t2;
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_cr = tmpMeta[1];
_inRef = _cr;
goto _tailrecursive;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_res = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _res;
}
DLLExport
modelica_metatype omc_ComponentReference_crefType(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_metatype _outType = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCref;
{
modelica_metatype _ty = NULL;
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
_ty = tmpMeta[1];
tmpMeta[0] = _ty;
goto tmp2_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
_ty = tmpMeta[1];
tmpMeta[0] = _ty;
goto tmp2_done;
}
default:
tmp2_default: OMC_LABEL_UNUSED; {
modelica_boolean tmp4;
tmp4 = omc_Flags_isSet(threadData, _OMC_LIT30);
if (1 != tmp4) goto goto_1;
omc_Debug_trace(threadData, _OMC_LIT52);
omc_Debug_traceln(threadData, omc_ComponentReference_printComponentRefStr(threadData, _inCref));
goto goto_1;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outType = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outType;
}
DLLExport
modelica_metatype omc_ComponentReference_crefTypeFull(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_metatype _outType = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _dims = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_ty = omc_ComponentReference_crefTypeFull2(threadData, _inCref, tmpMeta[0] ,&_dims);
if(listEmpty(_dims))
{
_outType = _ty;
}
else
{
tmpMeta[0] = mmc_mk_box3(9, &DAE_Type_T__ARRAY__desc, _ty, _dims);
_outType = tmpMeta[0];
}
_return: OMC_LABEL_UNUSED
return _outType;
}
DLLExport
modelica_metatype omc_ComponentReference_crefTypeFull2(threadData_t *threadData, modelica_metatype _inCref, modelica_metatype _accumDims, modelica_metatype *out_outDims)
{
modelica_metatype _outType = NULL;
modelica_metatype _outDims = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inCref;
{
modelica_metatype _cr = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _dims = NULL;
modelica_metatype _subs = NULL;
int tmp4;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_ty = omc_Types_flattenArrayType(threadData, _ty ,&_dims);
_dims = omc_List_stripN(threadData, _dims, listLength(_subs));
if((!listEmpty(_accumDims)))
{
_dims = listReverse(omc_List_append__reverse(threadData, _dims, _accumDims));
}
tmpMeta[0+0] = _ty;
tmpMeta[0+1] = _dims;
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_cr = tmpMeta[4];
_ty = omc_Types_flattenArrayType(threadData, _ty ,&_dims);
_dims = omc_List_stripN(threadData, _dims, listLength(_subs));
_inCref = _cr;
_accumDims = omc_List_append__reverse(threadData, _dims, _accumDims);
goto _tailrecursive;
goto tmp3_done;
}
default:
tmp3_default: OMC_LABEL_UNUSED; {
modelica_boolean tmp5;
tmp5 = omc_Flags_isSet(threadData, _OMC_LIT30);
if (1 != tmp5) goto goto_2;
omc_Debug_trace(threadData, _OMC_LIT53);
omc_Debug_traceln(threadData, omc_ComponentReference_printComponentRefStr(threadData, _inCref));
goto goto_2;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outType = tmpMeta[0+0];
_outDims = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_outDims) { *out_outDims = _outDims; }
return _outType;
}
DLLExport
modelica_metatype omc_ComponentReference_crefRest(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_metatype _outCref = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = _inCref;
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[0],0,4) == 0) MMC_THROW_INTERNAL();
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 5));
_outCref = tmpMeta[1];
_return: OMC_LABEL_UNUSED
return _outCref;
}
DLLExport
modelica_metatype omc_ComponentReference_crefLastCref(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_metatype _outComponentRef = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[0] = _inComponentRef;
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_cr = tmpMeta[1];
_inComponentRef = _cr;
goto _tailrecursive;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outComponentRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
DLLExport
modelica_string omc_ComponentReference_crefLastIdent(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_string _outIdent = NULL;
modelica_string tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inComponentRef;
{
modelica_string _id = NULL;
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_id = tmpMeta[0];
tmp1 = _id;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_cr = tmpMeta[0];
_inComponentRef = _cr;
goto _tailrecursive;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outIdent = tmp1;
_return: OMC_LABEL_UNUSED
return _outIdent;
}
DLLExport
modelica_string omc_ComponentReference_crefFirstIdent(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_string _outIdent = NULL;
modelica_string tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inComponentRef;
{
modelica_string _id = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_id = tmpMeta[0];
tmp1 = _id;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_id = tmpMeta[0];
tmp1 = _id;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outIdent = tmp1;
_return: OMC_LABEL_UNUSED
return _outIdent;
}
DLLExport
modelica_metatype omc_ComponentReference_crefLastPath(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_metatype _outPath = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
modelica_string _i = NULL;
modelica_metatype _c = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
if (!listEmpty(tmpMeta[2])) goto tmp2_end;
_i = tmpMeta[1];
tmpMeta[1] = mmc_mk_box2(4, &Absyn_Path_IDENT__desc, _i);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
if (!listEmpty(tmpMeta[1])) goto tmp2_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_c = tmpMeta[2];
_inComponentRef = _c;
goto _tailrecursive;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outPath = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outPath;
}
DLLExport
modelica_metatype omc_ComponentReference_crefArrayGetFirstCref(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_metatype _outComponentRef = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
modelica_metatype _cr = NULL;
modelica_metatype _dims = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _newsubs = NULL;
modelica_integer _diff;
modelica_metatype _ty = NULL;
modelica_string _i = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_i = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_dims = omc_Types_getDimensions(threadData, _ty);
_diff = listLength(_dims) - listLength(_subs);
_newsubs = omc_List_fill(threadData, _OMC_LIT55, _diff);
tmpMeta[1] = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, _i, _ty, listAppend(_subs, _newsubs));
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_i = tmpMeta[1];
_ty = tmpMeta[2];
_subs = tmpMeta[3];
_cr = tmpMeta[4];
_dims = omc_Types_getDimensions(threadData, _ty);
_diff = listLength(_dims) - listLength(_subs);
_newsubs = omc_List_fill(threadData, _OMC_LIT55, _diff);
_cr = omc_ComponentReference_crefArrayGetFirstCref(threadData, _cr);
tmpMeta[1] = mmc_mk_box5(3, &DAE_ComponentRef_CREF__QUAL__desc, _i, _ty, listAppend(_subs, _newsubs), _cr);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outComponentRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ComponentReference_containWholeDim3(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _ad)
{
modelica_boolean _ob;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;
tmp4_1 = _inExp;
tmp4_2 = _ad;
{
modelica_metatype _expl = NULL;
modelica_integer _x1;
modelica_integer _x2;
modelica_metatype _d = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
modelica_boolean tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,16,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (listEmpty(tmp4_2)) goto tmp3_end;
tmpMeta[1] = MMC_CAR(tmp4_2);
tmpMeta[2] = MMC_CDR(tmp4_2);
_expl = tmpMeta[0];
_d = tmpMeta[1];
_x1 = listLength(_expl);
_x2 = omc_Expression_dimensionSize(threadData, _d);
tmp6 = (_x1 == _x2);
if (1 != tmp6) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 2) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_ob = tmp1;
_return: OMC_LABEL_UNUSED
return _ob;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_containWholeDim3(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _ad)
{
modelica_boolean _ob;
modelica_metatype out_ob;
_ob = omc_ComponentReference_containWholeDim3(threadData, _inExp, _ad);
out_ob = mmc_mk_icon(_ob);
return out_ob;
}
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ComponentReference_containWholeDim2(threadData_t *threadData, modelica_metatype _inRef, modelica_metatype _inType)
{
modelica_boolean _wholedim;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;
tmp4_1 = _inRef;
tmp4_2 = _inType;
{
modelica_metatype _ssl = NULL;
modelica_metatype _tty = NULL;
modelica_metatype _ad = NULL;
modelica_metatype _es1 = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 5; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_1)) goto tmp3_end;
tmp4 += 4;
tmp1 = 0;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,6,2) == 0) goto tmp3_end;
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[0] = MMC_CAR(tmp4_1);
tmpMeta[1] = MMC_CDR(tmp4_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[0],0,0) == 0) goto tmp3_end;
tmp4 += 1;
tmp1 = 1;
goto tmp3_done;
}
case 2: {
modelica_boolean tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,6,2) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[1] = MMC_CAR(tmp4_1);
tmpMeta[2] = MMC_CDR(tmp4_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],1,1) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
_ad = tmpMeta[0];
_es1 = tmpMeta[3];
tmp6 = omc_ComponentReference_containWholeDim3(threadData, _es1, _ad);
if (1 != tmp6) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 3: {
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[0] = MMC_CAR(tmp4_1);
tmpMeta[1] = MMC_CDR(tmp4_1);
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,6,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
_ssl = tmpMeta[1];
_tty = tmpMeta[2];
_ad = tmpMeta[3];
_ad = omc_List_stripFirst(threadData, _ad);
tmpMeta[0] = mmc_mk_box3(9, &DAE_Type_T__ARRAY__desc, _tty, _ad);
tmp1 = omc_ComponentReference_containWholeDim2(threadData, _ssl, tmpMeta[0]);
goto tmp3_done;
}
case 4: {
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[0] = MMC_CAR(tmp4_1);
tmpMeta[1] = MMC_CDR(tmp4_1);
_ssl = tmpMeta[1];
tmp1 = omc_ComponentReference_containWholeDim2(threadData, _ssl, _inType);
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 5) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_wholedim = tmp1;
_return: OMC_LABEL_UNUSED
return _wholedim;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_containWholeDim2(threadData_t *threadData, modelica_metatype _inRef, modelica_metatype _inType)
{
modelica_boolean _wholedim;
modelica_metatype out_wholedim;
_wholedim = omc_ComponentReference_containWholeDim2(threadData, _inRef, _inType);
out_wholedim = mmc_mk_icon(_wholedim);
return out_wholedim;
}
DLLExport
modelica_boolean omc_ComponentReference_crefIsRec(threadData_t *threadData, modelica_metatype _cref, modelica_boolean _isRecIn)
{
modelica_boolean _isRec;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_isRec = (_isRecIn || omc_Types_isRecord(threadData, omc_ComponentReference_crefLastType(threadData, _cref)));
_return: OMC_LABEL_UNUSED
return _isRec;
}
modelica_metatype boxptr_ComponentReference_crefIsRec(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _isRecIn)
{
modelica_integer tmp1;
modelica_boolean _isRec;
modelica_metatype out_isRec;
tmp1 = mmc_unbox_integer(_isRecIn);
_isRec = omc_ComponentReference_crefIsRec(threadData, _cref, tmp1);
out_isRec = mmc_mk_icon(_isRec);
return out_isRec;
}
DLLExport
modelica_metatype omc_ComponentReference_traverseCref(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func, modelica_metatype _argIn)
{
modelica_metatype _argOut = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp3_1;
tmp3_1 = _cref;
{
modelica_metatype _cr = NULL;
modelica_metatype _arg = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 3; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmp3 += 1;
tmpMeta[0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _cref, _argIn) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _cref, _argIn);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_cr = tmpMeta[1];
_arg = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _cref, _argIn) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _cref, _argIn);
tmpMeta[0] = omc_ComponentReference_traverseCref(threadData, _cr, ((modelica_fnptr) _func), _arg);
goto tmp2_done;
}
case 2: {
fputs(MMC_STRINGDATA(_OMC_LIT56),stdout);
goto goto_1;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 3) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_argOut = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _argOut;
}
DLLExport
modelica_boolean omc_ComponentReference_containWholeDim(threadData_t *threadData, modelica_metatype _inRef)
{
modelica_boolean _wholedim;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inRef;
{
modelica_metatype _cr = NULL;
modelica_metatype _ssl = NULL;
modelica_metatype _ty = NULL;
int tmp4;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
_ty = tmpMeta[0];
_ssl = tmpMeta[1];
tmp1 = omc_ComponentReference_containWholeDim2(threadData, _ssl, _ty);
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_cr = tmpMeta[0];
_inRef = _cr;
goto _tailrecursive;
goto tmp3_done;
}
default:
tmp3_default: OMC_LABEL_UNUSED; {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_wholedim = tmp1;
_return: OMC_LABEL_UNUSED
return _wholedim;
}
modelica_metatype boxptr_ComponentReference_containWholeDim(threadData_t *threadData, modelica_metatype _inRef)
{
modelica_boolean _wholedim;
modelica_metatype out_wholedim;
_wholedim = omc_ComponentReference_containWholeDim(threadData, _inRef);
out_wholedim = mmc_mk_icon(_wholedim);
return out_wholedim;
}
DLLExport
modelica_boolean omc_ComponentReference_crefIsScalarWithVariableSubs(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_boolean _isScalar;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
{
modelica_metatype _subs = NULL;
modelica_metatype _dims = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
modelica_boolean tmp6;
modelica_boolean tmp7;
tmpMeta[0] = omc_ComponentReference_crefSubs(threadData, _inCref);
if (listEmpty(tmpMeta[0])) goto goto_2;
tmpMeta[1] = MMC_CAR(tmpMeta[0]);
tmpMeta[2] = MMC_CDR(tmpMeta[0]);
_subs = tmpMeta[0];
_dims = omc_ComponentReference_crefDims(threadData, _inCref);
tmp6 = (listLength(_dims) <= listLength(_subs));
if (1 != tmp6) goto goto_2;
tmp7 = omc_Expression_subscriptConstants(threadData, _subs);
if (0 != tmp7) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 2) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_isScalar = tmp1;
_return: OMC_LABEL_UNUSED
return _isScalar;
}
modelica_metatype boxptr_ComponentReference_crefIsScalarWithVariableSubs(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_boolean _isScalar;
modelica_metatype out_isScalar;
_isScalar = omc_ComponentReference_crefIsScalarWithVariableSubs(threadData, _inCref);
out_isScalar = mmc_mk_icon(_isScalar);
return out_isScalar;
}
DLLExport
modelica_boolean omc_ComponentReference_crefIsScalarWithAllConstSubs(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_boolean _isScalar;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
{
modelica_metatype _subs = NULL;
modelica_metatype _dims = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 3; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
tmpMeta[0] = omc_ComponentReference_crefSubs(threadData, _inCref);
if (!listEmpty(tmpMeta[0])) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
modelica_boolean tmp6;
modelica_boolean tmp7;
tmpMeta[0] = omc_ComponentReference_crefSubs(threadData, _inCref);
if (listEmpty(tmpMeta[0])) goto goto_2;
tmpMeta[1] = MMC_CAR(tmpMeta[0]);
tmpMeta[2] = MMC_CDR(tmpMeta[0]);
_subs = tmpMeta[0];
_dims = omc_ComponentReference_crefDims(threadData, _inCref);
tmp6 = (listLength(_dims) <= listLength(_subs));
if (1 != tmp6) goto goto_2;
tmp7 = omc_Expression_subscriptConstants(threadData, _subs);
if (1 != tmp7) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 2: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 3) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_isScalar = tmp1;
_return: OMC_LABEL_UNUSED
return _isScalar;
}
modelica_metatype boxptr_ComponentReference_crefIsScalarWithAllConstSubs(threadData_t *threadData, modelica_metatype _inCref)
{
modelica_boolean _isScalar;
modelica_metatype out_isScalar;
_isScalar = omc_ComponentReference_crefIsScalarWithAllConstSubs(threadData, _inCref);
out_isScalar = mmc_mk_icon(_isScalar);
return out_isScalar;
}
DLLExport
modelica_boolean omc_ComponentReference_crefHasScalarSubscripts(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _hasScalarSubs;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
{
modelica_metatype _subs = NULL;
modelica_metatype _tp = NULL;
modelica_metatype _dims = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 3; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
tmpMeta[0] = omc_ComponentReference_crefLastSubs(threadData, _cr);
if (!listEmpty(tmpMeta[0])) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
modelica_boolean tmp6;
modelica_boolean tmp7;
tmpMeta[0] = omc_ComponentReference_crefLastSubs(threadData, _cr);
if (listEmpty(tmpMeta[0])) goto goto_2;
tmpMeta[1] = MMC_CAR(tmpMeta[0]);
tmpMeta[2] = MMC_CDR(tmpMeta[0]);
_subs = tmpMeta[0];
tmp6 = omc_Expression_subscriptConstants(threadData, _subs);
if (1 != tmp6) goto goto_2;
_tp = omc_ComponentReference_crefLastType(threadData, _cr);
_dims = omc_Expression_arrayDimension(threadData, _tp);
tmp7 = (listLength(_dims) <= listLength(_subs));
if (1 != tmp7) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 2: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 3) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_hasScalarSubs = tmp1;
_return: OMC_LABEL_UNUSED
return _hasScalarSubs;
}
modelica_metatype boxptr_ComponentReference_crefHasScalarSubscripts(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _hasScalarSubs;
modelica_metatype out_hasScalarSubs;
_hasScalarSubs = omc_ComponentReference_crefHasScalarSubscripts(threadData, _cr);
out_hasScalarSubs = mmc_mk_icon(_hasScalarSubs);
return out_hasScalarSubs;
}
DLLExport
modelica_boolean omc_ComponentReference_crefHaveSubs(threadData_t *threadData, modelica_metatype _icr)
{
modelica_boolean _ob;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;
tmp4_1 = _icr;
{
modelica_metatype _cr = NULL;
modelica_string _str = NULL;
modelica_integer _idx;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 5; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (listEmpty(tmpMeta[0])) goto tmp3_end;
tmpMeta[1] = MMC_CAR(tmpMeta[0]);
tmpMeta[2] = MMC_CDR(tmpMeta[0]);
tmp4 += 3;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (listEmpty(tmpMeta[0])) goto tmp3_end;
tmpMeta[1] = MMC_CAR(tmpMeta[0]);
tmpMeta[2] = MMC_CDR(tmpMeta[0]);
tmp4 += 2;
tmp1 = 1;
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (!listEmpty(tmpMeta[1])) goto tmp3_end;
_str = tmpMeta[0];
tmp4 += 1;
_idx = omc_System_stringFind(threadData, _str, _OMC_LIT2);
if((!(_idx > ((modelica_integer) 0))))
{
goto goto_2;
}
tmp1 = 1;
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (!listEmpty(tmpMeta[0])) goto tmp3_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_cr = tmpMeta[1];
tmp1 = omc_ComponentReference_crefHaveSubs(threadData, _cr);
goto tmp3_done;
}
case 4: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 5) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_ob = tmp1;
_return: OMC_LABEL_UNUSED
return _ob;
}
modelica_metatype boxptr_ComponentReference_crefHaveSubs(threadData_t *threadData, modelica_metatype _icr)
{
modelica_boolean _ob;
modelica_metatype out_ob;
_ob = omc_ComponentReference_crefHaveSubs(threadData, _icr);
out_ob = mmc_mk_icon(_ob);
return out_ob;
}
DLLExport
modelica_boolean omc_ComponentReference_crefIsFirstArrayElt(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_boolean _outBoolean;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;
tmp4_1 = _inComponentRef;
{
modelica_metatype _subs = NULL;
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
_cr = tmp4_1;
if((stringEqual(omc_Config_simCodeTarget(threadData), _OMC_LIT50)))
{
tmpMeta[0] = omc_ComponentReference_crefLastSubs(threadData, _cr);
if (listEmpty(tmpMeta[0])) goto goto_2;
tmpMeta[1] = MMC_CAR(tmpMeta[0]);
tmpMeta[2] = MMC_CDR(tmpMeta[0]);
_subs = tmpMeta[0];
}
else
{
tmpMeta[0] = omc_ComponentReference_crefSubs(threadData, _cr);
if (listEmpty(tmpMeta[0])) goto goto_2;
tmpMeta[1] = MMC_CAR(tmpMeta[0]);
tmpMeta[2] = MMC_CDR(tmpMeta[0]);
_subs = tmpMeta[0];
}
tmp1 = omc_List_mapAllValueBool(threadData, _subs, boxvar_Expression_subscriptIsFirst, mmc_mk_boolean(1));
goto tmp3_done;
}
case 1: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 2) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outBoolean = tmp1;
_return: OMC_LABEL_UNUSED
return _outBoolean;
}
modelica_metatype boxptr_ComponentReference_crefIsFirstArrayElt(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_boolean _outBoolean;
modelica_metatype out_outBoolean;
_outBoolean = omc_ComponentReference_crefIsFirstArrayElt(threadData, _inComponentRef);
out_outBoolean = mmc_mk_icon(_outBoolean);
return out_outBoolean;
}
DLLExport
modelica_metatype omc_ComponentReference_popCref(threadData_t *threadData, modelica_metatype _inCR)
{
modelica_metatype _outCR = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCR;
{
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_cr = tmpMeta[1];
tmpMeta[0] = _cr;
goto tmp2_done;
}
case 1: {
tmpMeta[0] = _inCR;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCR = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCR;
}
DLLExport
modelica_metatype omc_ComponentReference_popPreCref(threadData_t *threadData, modelica_metatype _inCR)
{
modelica_metatype _outCR = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCR;
{
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
if (4 != MMC_STRLEN(tmpMeta[1]) || strcmp(MMC_STRINGDATA(_OMC_LIT46), MMC_STRINGDATA(tmpMeta[1])) != 0) goto tmp2_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_cr = tmpMeta[2];
tmpMeta[0] = _cr;
goto tmp2_done;
}
case 1: {
tmpMeta[0] = _inCR;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCR = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCR;
}
DLLExport
modelica_boolean omc_ComponentReference_isStartCref(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _b;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _cr;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (6 != MMC_STRLEN(tmpMeta[0]) || strcmp(MMC_STRINGDATA(_OMC_LIT45), MMC_STRINGDATA(tmpMeta[0])) != 0) goto tmp3_end;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_b = tmp1;
_return: OMC_LABEL_UNUSED
return _b;
}
modelica_metatype boxptr_ComponentReference_isStartCref(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _b;
modelica_metatype out_b;
_b = omc_ComponentReference_isStartCref(threadData, _cr);
out_b = mmc_mk_icon(_b);
return out_b;
}
DLLExport
modelica_boolean omc_ComponentReference_isPreviousCref(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _b;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _cr;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (7 != MMC_STRLEN(tmpMeta[0]) || strcmp(MMC_STRINGDATA(_OMC_LIT12), MMC_STRINGDATA(tmpMeta[0])) != 0) goto tmp3_end;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_b = tmp1;
_return: OMC_LABEL_UNUSED
return _b;
}
modelica_metatype boxptr_ComponentReference_isPreviousCref(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _b;
modelica_metatype out_b;
_b = omc_ComponentReference_isPreviousCref(threadData, _cr);
out_b = mmc_mk_icon(_b);
return out_b;
}
DLLExport
modelica_boolean omc_ComponentReference_isPreCref(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _b;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _cr;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (4 != MMC_STRLEN(tmpMeta[0]) || strcmp(MMC_STRINGDATA(_OMC_LIT46), MMC_STRINGDATA(tmpMeta[0])) != 0) goto tmp3_end;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_b = tmp1;
_return: OMC_LABEL_UNUSED
return _b;
}
modelica_metatype boxptr_ComponentReference_isPreCref(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _b;
modelica_metatype out_b;
_b = omc_ComponentReference_isPreCref(threadData, _cr);
out_b = mmc_mk_icon(_b);
return out_b;
}
DLLExport
modelica_boolean omc_ComponentReference_isArrayElement(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _b;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _cr;
{
modelica_metatype _comp = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 4; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[0],6,2) == 0) goto tmp3_end;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[0],6,2) == 0) goto tmp3_end;
tmp1 = 1;
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_comp = tmpMeta[0];
_cr = _comp;
goto _tailrecursive;
goto tmp3_done;
}
case 3: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_b = tmp1;
_return: OMC_LABEL_UNUSED
return _b;
}
modelica_metatype boxptr_ComponentReference_isArrayElement(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _b;
modelica_metatype out_b;
_b = omc_ComponentReference_isArrayElement(threadData, _cr);
out_b = mmc_mk_icon(_b);
return out_b;
}
DLLExport
modelica_boolean omc_ComponentReference_isRecord(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _b;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _cr;
{
modelica_metatype _comp = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 3; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[0],9,3) == 0) goto tmp3_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],3,1) == 0) goto tmp3_end;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_comp = tmpMeta[0];
_cr = _comp;
goto _tailrecursive;
goto tmp3_done;
}
case 2: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_b = tmp1;
_return: OMC_LABEL_UNUSED
return _b;
}
modelica_metatype boxptr_ComponentReference_isRecord(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _b;
modelica_metatype out_b;
_b = omc_ComponentReference_isRecord(threadData, _cr);
out_b = mmc_mk_icon(_b);
return out_b;
}
DLLExport
modelica_boolean omc_ComponentReference_isInternalCref(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _b;
modelica_string _s = NULL;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _cr;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 5; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (4 != MMC_STRLEN(tmpMeta[0]) || strcmp(MMC_STRINGDATA(_OMC_LIT11), MMC_STRINGDATA(tmpMeta[0])) != 0) goto tmp3_end;
tmp1 = 0;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (7 != MMC_STRLEN(tmpMeta[0]) || strcmp(MMC_STRINGDATA(_OMC_LIT12), MMC_STRINGDATA(tmpMeta[0])) != 0) goto tmp3_end;
tmp1 = 0;
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_s = tmpMeta[0];
tmp1 = (stringEqual(substring(_s, ((modelica_integer) 1), ((modelica_integer) 1)), _OMC_LIT57));
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_s = tmpMeta[0];
tmp1 = (stringEqual(substring(_s, ((modelica_integer) 1), ((modelica_integer) 1)), _OMC_LIT57));
goto tmp3_done;
}
case 4: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_b = tmp1;
_return: OMC_LABEL_UNUSED
return _b;
}
modelica_metatype boxptr_ComponentReference_isInternalCref(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _b;
modelica_metatype out_b;
_b = omc_ComponentReference_isInternalCref(threadData, _cr);
out_b = mmc_mk_icon(_b);
return out_b;
}
DLLExport
modelica_boolean omc_ComponentReference_crefIsNotIdent(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _res;
modelica_boolean tmp1 = 0;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _cr;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmp1 = 0;
goto tmp3_done;
}
case 1: {
tmp1 = 1;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_res = tmp1;
_return: OMC_LABEL_UNUSED
return _res;
}
modelica_metatype boxptr_ComponentReference_crefIsNotIdent(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _res;
modelica_metatype out_res;
_res = omc_ComponentReference_crefIsNotIdent(threadData, _cr);
out_res = mmc_mk_icon(_res);
return out_res;
}
DLLExport
modelica_boolean omc_ComponentReference_crefIsIdent(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _res;
modelica_boolean tmp1 = 0;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _cr;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_res = tmp1;
_return: OMC_LABEL_UNUSED
return _res;
}
modelica_metatype boxptr_ComponentReference_crefIsIdent(threadData_t *threadData, modelica_metatype _cr)
{
modelica_boolean _res;
modelica_metatype out_res;
_res = omc_ComponentReference_crefIsIdent(threadData, _cr);
out_res = mmc_mk_icon(_res);
return out_res;
}
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ComponentReference_crefEqualWithoutSubs2(threadData_t *threadData, modelica_boolean _refEq, modelica_metatype _icr1, modelica_metatype _icr2)
{
modelica_boolean _res;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_boolean tmp4_1;modelica_metatype tmp4_2;modelica_metatype tmp4_3;
tmp4_1 = _refEq;
tmp4_2 = _icr1;
tmp4_3 = _icr2;
{
modelica_string _n1 = NULL;
modelica_string _n2 = NULL;
modelica_boolean _r;
modelica_metatype _cr1 = NULL;
modelica_metatype _cr2 = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 4; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (1 != tmp4_1) goto tmp3_end;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_3,1,3) == 0) goto tmp3_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 2));
_n1 = tmpMeta[0];
_n2 = tmpMeta[1];
tmp1 = (stringEqual(_n1, _n2));
goto tmp3_done;
}
case 2: {
modelica_boolean tmp6;
modelica_boolean tmp7;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 5));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_3,0,4) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 5));
_n1 = tmpMeta[0];
_cr1 = tmpMeta[1];
_n2 = tmpMeta[2];
_cr2 = tmpMeta[3];
_r = (stringEqual(_n1, _n2));
tmp6 = (modelica_boolean)_r;
if(tmp6)
{
_refEq = referenceEq(_cr1, _cr2);
_icr1 = _cr1;
_icr2 = _cr2;
goto _tailrecursive;
}
else
{
tmp7 = 0;
}
tmp1 = tmp7;
goto tmp3_done;
}
case 3: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_res = tmp1;
_return: OMC_LABEL_UNUSED
return _res;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_crefEqualWithoutSubs2(threadData_t *threadData, modelica_metatype _refEq, modelica_metatype _icr1, modelica_metatype _icr2)
{
modelica_integer tmp1;
modelica_boolean _res;
modelica_metatype out_res;
tmp1 = mmc_unbox_integer(_refEq);
_res = omc_ComponentReference_crefEqualWithoutSubs2(threadData, tmp1, _icr1, _icr2);
out_res = mmc_mk_icon(_res);
return out_res;
}
DLLExport
modelica_boolean omc_ComponentReference_crefEqualWithoutSubs(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _res;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_res = omc_ComponentReference_crefEqualWithoutSubs2(threadData, referenceEq(_cr1, _cr2), _cr1, _cr2);
_return: OMC_LABEL_UNUSED
return _res;
}
modelica_metatype boxptr_ComponentReference_crefEqualWithoutSubs(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _res;
modelica_metatype out_res;
_res = omc_ComponentReference_crefEqualWithoutSubs(threadData, _cr1, _cr2);
out_res = mmc_mk_icon(_res);
return out_res;
}
DLLExport
modelica_boolean omc_ComponentReference_crefEqualWithoutLastSubs(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _res;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_res = omc_ComponentReference_crefEqualNoStringCompare(threadData, omc_ComponentReference_crefStripLastSubs(threadData, _cr1), omc_ComponentReference_crefStripLastSubs(threadData, _cr2));
_return: OMC_LABEL_UNUSED
return _res;
}
modelica_metatype boxptr_ComponentReference_crefEqualWithoutLastSubs(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _res;
modelica_metatype out_res;
_res = omc_ComponentReference_crefEqualWithoutLastSubs(threadData, _cr1, _cr2);
out_res = mmc_mk_icon(_res);
return out_res;
}
DLLExport
modelica_metatype omc_ComponentReference_crefEqualReturn(threadData_t *threadData, modelica_metatype _cr, modelica_metatype _cr2)
{
modelica_metatype _ocr = NULL;
modelica_boolean tmp1;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmp1 = omc_ComponentReference_crefEqualNoStringCompare(threadData, _cr, _cr2);
if (1 != tmp1) MMC_THROW_INTERNAL();
_ocr = _cr;
_return: OMC_LABEL_UNUSED
return _ocr;
}
DLLExport
modelica_boolean omc_ComponentReference_crefEqualNoStringCompare(threadData_t *threadData, modelica_metatype _inCref1, modelica_metatype _inCref2)
{
modelica_boolean _outEqual;
modelica_boolean tmp1 = 0;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
if(referenceEq(_inCref1, _inCref2))
{
_outEqual = 1;
goto _return;
}
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _inCref1;
tmp4_2 = _inCref2;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 3; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
tmp1 = ((stringEqual((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inCref1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inCref2), 2))))) && omc_Expression_subscriptEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inCref1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inCref2), 4)))));
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
tmp1 = (((stringEqual((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inCref1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inCref2), 2))))) && omc_ComponentReference_crefEqualNoStringCompare(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inCref1), 5))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inCref2), 5))))) && omc_Expression_subscriptEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inCref1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inCref2), 4)))));
goto tmp3_done;
}
case 2: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outEqual = tmp1;
_return: OMC_LABEL_UNUSED
return _outEqual;
}
modelica_metatype boxptr_ComponentReference_crefEqualNoStringCompare(threadData_t *threadData, modelica_metatype _inCref1, modelica_metatype _inCref2)
{
modelica_boolean _outEqual;
modelica_metatype out_outEqual;
_outEqual = omc_ComponentReference_crefEqualNoStringCompare(threadData, _inCref1, _inCref2);
out_outEqual = mmc_mk_icon(_outEqual);
return out_outEqual;
}
DLLExport
modelica_boolean omc_ComponentReference_crefEqualVerySlowStringCompareDoNotUse(threadData_t *threadData, modelica_metatype _inComponentRef1, modelica_metatype _inComponentRef2)
{
modelica_boolean _outBoolean;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[8] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;
tmp4_1 = _inComponentRef1;
tmp4_2 = _inComponentRef2;
{
modelica_string _n1 = NULL;
modelica_string _n2 = NULL;
modelica_string _s1 = NULL;
modelica_string _s2 = NULL;
modelica_metatype _idx1 = NULL;
modelica_metatype _idx2 = NULL;
modelica_metatype _cr1 = NULL;
modelica_metatype _cr2 = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 9; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
modelica_boolean tmp6;
tmp6 = referenceEq(_inComponentRef1, _inComponentRef2);
if (1 != tmp6) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
modelica_boolean tmp7;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (!listEmpty(tmpMeta[1])) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
if (!listEmpty(tmpMeta[3])) goto tmp3_end;
_n1 = tmpMeta[0];
_n2 = tmpMeta[2];
tmp4 += 6;
tmp7 = (stringEqual(_n1, _n2));
if (1 != tmp7) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 2: {
modelica_boolean tmp8;
modelica_boolean tmp9;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (listEmpty(tmpMeta[1])) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmpMeta[1]);
tmpMeta[3] = MMC_CDR(tmpMeta[1]);
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
if (listEmpty(tmpMeta[5])) goto tmp3_end;
tmpMeta[6] = MMC_CAR(tmpMeta[5]);
tmpMeta[7] = MMC_CDR(tmpMeta[5]);
_n1 = tmpMeta[0];
_idx1 = tmpMeta[1];
_n2 = tmpMeta[4];
_idx2 = tmpMeta[5];
tmp4 += 5;
tmp8 = (stringEqual(_n1, _n2));
if (1 != tmp8) goto goto_2;
tmp9 = omc_Expression_subscriptEqual(threadData, _idx1, _idx2);
if (1 != tmp9) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 3: {
modelica_integer tmp10;
modelica_boolean tmp11;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (!listEmpty(tmpMeta[1])) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
if (listEmpty(tmpMeta[3])) goto tmp3_end;
tmpMeta[4] = MMC_CAR(tmpMeta[3]);
tmpMeta[5] = MMC_CDR(tmpMeta[3]);
_n1 = tmpMeta[0];
_n2 = tmpMeta[2];
_idx2 = tmpMeta[3];
tmp4 += 4;
tmp10 = omc_System_stringFind(threadData, _n1, _n2);
if (0 != tmp10) goto goto_2;
tmpMeta[0] = stringAppend(_n2,_OMC_LIT2);
tmpMeta[1] = stringAppend(tmpMeta[0],omc_ExpressionDump_printListStr(threadData, _idx2, boxvar_ExpressionDump_printSubscriptStr, _OMC_LIT3));
tmpMeta[2] = stringAppend(tmpMeta[1],_OMC_LIT6);
_s1 = tmpMeta[2];
tmp11 = (stringEqual(_s1, _n1));
if (1 != tmp11) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 4: {
modelica_integer tmp12;
modelica_boolean tmp13;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (listEmpty(tmpMeta[1])) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmpMeta[1]);
tmpMeta[3] = MMC_CDR(tmpMeta[1]);
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
if (!listEmpty(tmpMeta[5])) goto tmp3_end;
_n1 = tmpMeta[0];
_idx2 = tmpMeta[1];
_n2 = tmpMeta[4];
tmp4 += 3;
tmp12 = omc_System_stringFind(threadData, _n2, _n1);
if (0 != tmp12) goto goto_2;
tmpMeta[0] = stringAppend(_n1,_OMC_LIT2);
tmpMeta[1] = stringAppend(tmpMeta[0],omc_ExpressionDump_printListStr(threadData, _idx2, boxvar_ExpressionDump_printSubscriptStr, _OMC_LIT3));
tmpMeta[2] = stringAppend(tmpMeta[1],_OMC_LIT6);
_s1 = tmpMeta[2];
tmp13 = (stringEqual(_s1, _n2));
if (1 != tmp13) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 5: {
modelica_boolean tmp14;
modelica_boolean tmp15;
modelica_boolean tmp16;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 5));
_n1 = tmpMeta[0];
_idx1 = tmpMeta[1];
_cr1 = tmpMeta[2];
_n2 = tmpMeta[3];
_idx2 = tmpMeta[4];
_cr2 = tmpMeta[5];
tmp4 += 2;
tmp14 = (stringEqual(_n1, _n2));
if (1 != tmp14) goto goto_2;
tmp15 = omc_ComponentReference_crefEqualVerySlowStringCompareDoNotUse(threadData, _cr1, _cr2);
if (1 != tmp15) goto goto_2;
tmp16 = omc_Expression_subscriptEqual(threadData, _idx1, _idx2);
if (1 != tmp16) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 6: {
modelica_integer tmp17;
modelica_boolean tmp18;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
_cr1 = tmp4_1;
_n1 = tmpMeta[0];
_cr2 = tmp4_2;
_n2 = tmpMeta[1];
tmp4 += 1;
tmp17 = omc_System_stringFind(threadData, _n2, _n1);
if (0 != tmp17) goto goto_2;
_s1 = omc_ComponentReference_printComponentRefStr(threadData, _cr1);
_s2 = omc_ComponentReference_printComponentRefStr(threadData, _cr2);
tmp18 = (stringEqual(_s1, _s2));
if (1 != tmp18) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 7: {
modelica_integer tmp19;
modelica_boolean tmp20;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
_cr1 = tmp4_1;
_n1 = tmpMeta[0];
_cr2 = tmp4_2;
_n2 = tmpMeta[1];
tmp19 = omc_System_stringFind(threadData, _n1, _n2);
if (0 != tmp19) goto goto_2;
_s1 = omc_ComponentReference_printComponentRefStr(threadData, _cr1);
_s2 = omc_ComponentReference_printComponentRefStr(threadData, _cr2);
tmp20 = (stringEqual(_s1, _s2));
if (1 != tmp20) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 8: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 9) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outBoolean = tmp1;
_return: OMC_LABEL_UNUSED
return _outBoolean;
}
modelica_metatype boxptr_ComponentReference_crefEqualVerySlowStringCompareDoNotUse(threadData_t *threadData, modelica_metatype _inComponentRef1, modelica_metatype _inComponentRef2)
{
modelica_boolean _outBoolean;
modelica_metatype out_outBoolean;
_outBoolean = omc_ComponentReference_crefEqualVerySlowStringCompareDoNotUse(threadData, _inComponentRef1, _inComponentRef2);
out_outBoolean = mmc_mk_icon(_outBoolean);
return out_outBoolean;
}
DLLExport
modelica_boolean omc_ComponentReference_crefNotInLst(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _lst)
{
modelica_boolean _b;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_b = (!omc_List_isMemberOnTrue(threadData, _cref, _lst, boxvar_ComponentReference_crefEqual));
_return: OMC_LABEL_UNUSED
return _b;
}
modelica_metatype boxptr_ComponentReference_crefNotInLst(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _lst)
{
modelica_boolean _b;
modelica_metatype out_b;
_b = omc_ComponentReference_crefNotInLst(threadData, _cref, _lst);
out_b = mmc_mk_icon(_b);
return out_b;
}
DLLExport
modelica_boolean omc_ComponentReference_crefInLst(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _lst)
{
modelica_boolean _b;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_b = omc_List_isMemberOnTrue(threadData, _cref, _lst, boxvar_ComponentReference_crefEqual);
_return: OMC_LABEL_UNUSED
return _b;
}
modelica_metatype boxptr_ComponentReference_crefInLst(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _lst)
{
modelica_boolean _b;
modelica_metatype out_b;
_b = omc_ComponentReference_crefInLst(threadData, _cref, _lst);
out_b = mmc_mk_icon(_b);
return out_b;
}
DLLExport
modelica_boolean omc_ComponentReference_crefEqual(threadData_t *threadData, modelica_metatype _inComponentRef1, modelica_metatype _inComponentRef2)
{
modelica_boolean _outBoolean;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outBoolean = omc_ComponentReference_crefEqualNoStringCompare(threadData, _inComponentRef1, _inComponentRef2);
_return: OMC_LABEL_UNUSED
return _outBoolean;
}
modelica_metatype boxptr_ComponentReference_crefEqual(threadData_t *threadData, modelica_metatype _inComponentRef1, modelica_metatype _inComponentRef2)
{
modelica_boolean _outBoolean;
modelica_metatype out_outBoolean;
_outBoolean = omc_ComponentReference_crefEqual(threadData, _inComponentRef1, _inComponentRef2);
out_outBoolean = mmc_mk_icon(_outBoolean);
return out_outBoolean;
}
DLLExport
modelica_boolean omc_ComponentReference_crefNotPrefixOf(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _outBoolean;
modelica_boolean tmp1 = 0;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _cr1;
tmp4_2 = _cr2;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
tmp1 = (!omc_ComponentReference_crefPrefixOf(threadData, _cr1, _cr2));
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outBoolean = tmp1;
_return: OMC_LABEL_UNUSED
return _outBoolean;
}
modelica_metatype boxptr_ComponentReference_crefNotPrefixOf(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _outBoolean;
modelica_metatype out_outBoolean;
_outBoolean = omc_ComponentReference_crefNotPrefixOf(threadData, _cr1, _cr2);
out_outBoolean = mmc_mk_icon(_outBoolean);
return out_outBoolean;
}
DLLExport
modelica_boolean omc_ComponentReference_crefPrefixOfIgnoreSubscripts(threadData_t *threadData, modelica_metatype _prefixCref, modelica_metatype _fullCref)
{
modelica_boolean _outPrefixOf;
modelica_boolean tmp1 = 0;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _prefixCref;
tmp4_2 = _fullCref;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 4; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
tmp1 = ((stringEqual((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_prefixCref), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_fullCref), 2))))) && omc_ComponentReference_crefPrefixOfIgnoreSubscripts(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_prefixCref), 5))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_fullCref), 5)))));
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
tmp1 = (stringEqual((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_prefixCref), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_fullCref), 2)))));
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
tmp1 = (stringEqual((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_prefixCref), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_fullCref), 2)))));
goto tmp3_done;
}
case 3: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outPrefixOf = tmp1;
_return: OMC_LABEL_UNUSED
return _outPrefixOf;
}
modelica_metatype boxptr_ComponentReference_crefPrefixOfIgnoreSubscripts(threadData_t *threadData, modelica_metatype _prefixCref, modelica_metatype _fullCref)
{
modelica_boolean _outPrefixOf;
modelica_metatype out_outPrefixOf;
_outPrefixOf = omc_ComponentReference_crefPrefixOfIgnoreSubscripts(threadData, _prefixCref, _fullCref);
out_outPrefixOf = mmc_mk_icon(_outPrefixOf);
return out_outPrefixOf;
}
DLLExport
modelica_boolean omc_ComponentReference_crefPrefixOf(threadData_t *threadData, modelica_metatype _prefixCref, modelica_metatype _fullCref)
{
modelica_boolean _outPrefixOf;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _prefixCref;
tmp4_2 = _fullCref;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 6; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
tmp1 = (((stringEqual((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_prefixCref), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_fullCref), 2))))) && omc_Expression_subscriptEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_prefixCref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_fullCref), 4))))) && omc_ComponentReference_crefPrefixOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_prefixCref), 5))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_fullCref), 5)))));
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (!listEmpty(tmpMeta[0])) goto tmp3_end;
tmp1 = (stringEqual((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_prefixCref), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_fullCref), 2)))));
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
tmp1 = ((stringEqual((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_prefixCref), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_fullCref), 2))))) && omc_Expression_subscriptEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_prefixCref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_fullCref), 4)))));
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (!listEmpty(tmpMeta[0])) goto tmp3_end;
tmp1 = (stringEqual((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_prefixCref), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_fullCref), 2)))));
goto tmp3_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
tmp1 = ((stringEqual((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_prefixCref), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_fullCref), 2))))) && omc_Expression_subscriptEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_prefixCref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_fullCref), 4)))));
goto tmp3_done;
}
case 5: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outPrefixOf = tmp1;
_return: OMC_LABEL_UNUSED
return _outPrefixOf;
}
modelica_metatype boxptr_ComponentReference_crefPrefixOf(threadData_t *threadData, modelica_metatype _prefixCref, modelica_metatype _fullCref)
{
modelica_boolean _outPrefixOf;
modelica_metatype out_outPrefixOf;
_outPrefixOf = omc_ComponentReference_crefPrefixOf(threadData, _prefixCref, _fullCref);
out_outPrefixOf = mmc_mk_icon(_outPrefixOf);
return out_outPrefixOf;
}
DLLExport
modelica_boolean omc_ComponentReference_crefContainedIn(threadData_t *threadData, modelica_metatype _containerCref, modelica_metatype _containedCref)
{
modelica_boolean _outBoolean;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;
tmp4_1 = _containerCref;
tmp4_2 = _containedCref;
{
modelica_metatype _full = NULL;
modelica_metatype _partOf = NULL;
modelica_metatype _cr2 = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 4; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
tmp1 = 0;
goto tmp3_done;
}
case 1: {
modelica_boolean tmp6;
_full = tmp4_1;
_partOf = tmp4_2;
tmp6 = omc_ComponentReference_crefEqualNoStringCompare(threadData, _full, _partOf);
if (1 != tmp6) goto goto_2;
tmp1 = 1;
goto tmp3_done;
}
case 2: {
modelica_boolean tmp7;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_full = tmp4_1;
_cr2 = tmpMeta[0];
_partOf = tmp4_2;
tmp7 = omc_ComponentReference_crefEqualNoStringCompare(threadData, _full, _partOf);
if (0 != tmp7) goto goto_2;
tmp1 = omc_ComponentReference_crefContainedIn(threadData, _cr2, _partOf);
goto tmp3_done;
}
case 3: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 4) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outBoolean = tmp1;
_return: OMC_LABEL_UNUSED
return _outBoolean;
}
modelica_metatype boxptr_ComponentReference_crefContainedIn(threadData_t *threadData, modelica_metatype _containerCref, modelica_metatype _containedCref)
{
modelica_boolean _outBoolean;
modelica_metatype out_outBoolean;
_outBoolean = omc_ComponentReference_crefContainedIn(threadData, _containerCref, _containedCref);
out_outBoolean = mmc_mk_icon(_outBoolean);
return out_outBoolean;
}
PROTECTED_FUNCTION_STATIC modelica_integer omc_ComponentReference_crefLexicalCompareSubsAtEnd2(threadData_t *threadData, modelica_metatype _inSubs1, modelica_metatype _inSubs2)
{
modelica_integer _res;
modelica_metatype _rest = NULL;
modelica_integer tmp1;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_res = ((modelica_integer) 0);
_rest = _inSubs2;
{
modelica_metatype _i;
for (tmpMeta[0] = _inSubs1; !listEmpty(tmpMeta[0]); tmpMeta[0]=MMC_CDR(tmpMeta[0]))
{
_i = MMC_CAR(tmpMeta[0]);
tmpMeta[1] = _rest;
if (listEmpty(tmpMeta[1])) MMC_THROW_INTERNAL();
tmpMeta[2] = MMC_CAR(tmpMeta[1]);
tmpMeta[3] = MMC_CDR(tmpMeta[1]);
tmp1 = mmc_unbox_integer(tmpMeta[2]);
_res = tmp1;
_rest = tmpMeta[3];
_res = ((mmc_unbox_integer(_i) > _res)?((modelica_integer) 1):((mmc_unbox_integer(_i) < _res)?((modelica_integer) -1):((modelica_integer) 0)));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
}
}
_return: OMC_LABEL_UNUSED
return _res;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_crefLexicalCompareSubsAtEnd2(threadData_t *threadData, modelica_metatype _inSubs1, modelica_metatype _inSubs2)
{
modelica_integer _res;
modelica_metatype out_res;
_res = omc_ComponentReference_crefLexicalCompareSubsAtEnd2(threadData, _inSubs1, _inSubs2);
out_res = mmc_mk_icon(_res);
return out_res;
}
DLLExport
modelica_integer omc_ComponentReference_crefLexicalCompareSubsAtEnd(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _res;
modelica_metatype _subs1 = NULL;
modelica_metatype _subs2 = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_res = omc_ComponentReference_CompareWithoutSubscripts_compare(threadData, _cr1, _cr2);
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
_subs1 = omc_Expression_subscriptsInt(threadData, omc_ComponentReference_crefSubs(threadData, _cr1));
_subs2 = omc_Expression_subscriptsInt(threadData, omc_ComponentReference_crefSubs(threadData, _cr2));
_res = omc_ComponentReference_crefLexicalCompareSubsAtEnd2(threadData, _subs1, _subs2);
_return: OMC_LABEL_UNUSED
return _res;
}
modelica_metatype boxptr_ComponentReference_crefLexicalCompareSubsAtEnd(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _res;
modelica_metatype out_res;
_res = omc_ComponentReference_crefLexicalCompareSubsAtEnd(threadData, _cr1, _cr2);
out_res = mmc_mk_icon(_res);
return out_res;
}
DLLExport
modelica_boolean omc_ComponentReference_crefLexicalGreaterSubsAtEnd(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _isGreater;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_isGreater = (omc_ComponentReference_crefLexicalCompareSubsAtEnd(threadData, _cr1, _cr2) > ((modelica_integer) 0));
_return: OMC_LABEL_UNUSED
return _isGreater;
}
modelica_metatype boxptr_ComponentReference_crefLexicalGreaterSubsAtEnd(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _isGreater;
modelica_metatype out_isGreater;
_isGreater = omc_ComponentReference_crefLexicalGreaterSubsAtEnd(threadData, _cr1, _cr2);
out_isGreater = mmc_mk_icon(_isGreater);
return out_isGreater;
}
DLLExport
modelica_integer omc_ComponentReference_crefCompareGenericNotAlphabetic(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _comp;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_comp = omc_ComponentReference_CompareWithGenericSubscriptNotAlphabetic_compare(threadData, _cr1, _cr2);
_return: OMC_LABEL_UNUSED
return _comp;
}
modelica_metatype boxptr_ComponentReference_crefCompareGenericNotAlphabetic(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _comp;
modelica_metatype out_comp;
_comp = omc_ComponentReference_crefCompareGenericNotAlphabetic(threadData, _cr1, _cr2);
out_comp = mmc_mk_icon(_comp);
return out_comp;
}
DLLExport
modelica_integer omc_ComponentReference_crefCompareIntSubscript(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _comp;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_comp = omc_ComponentReference_CompareWithIntSubscript_compare(threadData, _cr1, _cr2);
_return: OMC_LABEL_UNUSED
return _comp;
}
modelica_metatype boxptr_ComponentReference_crefCompareIntSubscript(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _comp;
modelica_metatype out_comp;
_comp = omc_ComponentReference_crefCompareIntSubscript(threadData, _cr1, _cr2);
out_comp = mmc_mk_icon(_comp);
return out_comp;
}
DLLExport
modelica_integer omc_ComponentReference_crefCompareGeneric(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _comp;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_comp = omc_ComponentReference_CompareWithGenericSubscript_compare(threadData, _cr1, _cr2);
_return: OMC_LABEL_UNUSED
return _comp;
}
modelica_metatype boxptr_ComponentReference_crefCompareGeneric(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _comp;
modelica_metatype out_comp;
_comp = omc_ComponentReference_crefCompareGeneric(threadData, _cr1, _cr2);
out_comp = mmc_mk_icon(_comp);
return out_comp;
}
DLLExport
modelica_boolean omc_ComponentReference_crefSortFunc(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _greaterThan;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_greaterThan = (omc_ComponentReference_CompareWithGenericSubscript_compare(threadData, _cr1, _cr2) > ((modelica_integer) 0));
_return: OMC_LABEL_UNUSED
return _greaterThan;
}
modelica_metatype boxptr_ComponentReference_crefSortFunc(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _greaterThan;
modelica_metatype out_greaterThan;
_greaterThan = omc_ComponentReference_crefSortFunc(threadData, _cr1, _cr2);
out_greaterThan = mmc_mk_icon(_greaterThan);
return out_greaterThan;
}
DLLExport
modelica_integer omc_ComponentReference_CompareWithIntSubscript_compare(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _res;
modelica_integer tmp1 = 0;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _cr1;
tmp4_2 = _cr2;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 4; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
tmp1 = omc_ComponentReference_CompareWithIntSubscript_compareSubs(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 4))));
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
_res = omc_ComponentReference_CompareWithIntSubscript_compareSubs(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 4))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
_cr1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 5)));
_cr2 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 5)));
goto _tailrecursive;
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
_res = omc_ComponentReference_CompareWithIntSubscript_compareSubs(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 4))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
tmp1 = ((modelica_integer) 1);
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
_res = omc_ComponentReference_CompareWithIntSubscript_compareSubs(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 4))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
tmp1 = ((modelica_integer) -1);
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_res = tmp1;
_return: OMC_LABEL_UNUSED
return _res;
}
modelica_metatype boxptr_ComponentReference_CompareWithIntSubscript_compare(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _res;
modelica_metatype out_res;
_res = omc_ComponentReference_CompareWithIntSubscript_compare(threadData, _cr1, _cr2);
out_res = mmc_mk_icon(_res);
return out_res;
}
DLLExport
modelica_integer omc_ComponentReference_CompareWithIntSubscript_compareSubs(threadData_t *threadData, modelica_metatype _ss1, modelica_metatype _ss2)
{
modelica_integer _res;
modelica_metatype _ss = NULL;
modelica_metatype _s2 = NULL;
modelica_integer _i1;
modelica_integer _i2;
modelica_metatype _e1 = NULL;
modelica_metatype _e2 = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_res = ((modelica_integer) 0);
_ss = _ss2;
{
modelica_metatype _s1;
for (tmpMeta[0] = _ss1; !listEmpty(tmpMeta[0]); tmpMeta[0]=MMC_CDR(tmpMeta[0]))
{
_s1 = MMC_CAR(tmpMeta[0]);
if(listEmpty(_ss))
{
_res = ((modelica_integer) -1);
goto _return;
}
tmpMeta[1] = _ss;
if (listEmpty(tmpMeta[1])) MMC_THROW_INTERNAL();
tmpMeta[2] = MMC_CAR(tmpMeta[1]);
tmpMeta[3] = MMC_CDR(tmpMeta[1]);
_s2 = tmpMeta[2];
_ss = tmpMeta[3];
_i1 = omc_Expression_subscriptInt(threadData, _s1);
_i2 = omc_Expression_subscriptInt(threadData, _s2);
_res = ((_i1 < _i2)?((modelica_integer) -1):((_i1 > _i2)?((modelica_integer) 1):((modelica_integer) 0)));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
}
}
if((!listEmpty(_ss)))
{
_res = ((modelica_integer) 1);
}
_return: OMC_LABEL_UNUSED
return _res;
}
modelica_metatype boxptr_ComponentReference_CompareWithIntSubscript_compareSubs(threadData_t *threadData, modelica_metatype _ss1, modelica_metatype _ss2)
{
modelica_integer _res;
modelica_metatype out_res;
_res = omc_ComponentReference_CompareWithIntSubscript_compareSubs(threadData, _ss1, _ss2);
out_res = mmc_mk_icon(_res);
return out_res;
}
DLLExport
modelica_integer omc_ComponentReference_CompareWithoutSubscripts_compare(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _res;
modelica_integer tmp1 = 0;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _cr1;
tmp4_2 = _cr2;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 4; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
goto _return;
tmp1 = omc_ComponentReference_CompareWithoutSubscripts_compareSubs(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 4))));
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
_cr1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 5)));
_cr2 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 5)));
goto _tailrecursive;
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
tmp1 = ((modelica_integer) 1);
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
tmp1 = ((modelica_integer) -1);
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_res = tmp1;
_return: OMC_LABEL_UNUSED
return _res;
}
modelica_metatype boxptr_ComponentReference_CompareWithoutSubscripts_compare(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _res;
modelica_metatype out_res;
_res = omc_ComponentReference_CompareWithoutSubscripts_compare(threadData, _cr1, _cr2);
out_res = mmc_mk_icon(_res);
return out_res;
}
DLLExport
modelica_integer omc_ComponentReference_CompareWithoutSubscripts_compareSubs(threadData_t *threadData, modelica_metatype _ss1, modelica_metatype _ss2)
{
modelica_integer _res;
modelica_metatype _ss = NULL;
modelica_metatype _s2 = NULL;
modelica_integer _i1;
modelica_integer _i2;
modelica_metatype _e1 = NULL;
modelica_metatype _e2 = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_res = ((modelica_integer) 0);
_ss = _ss2;
{
modelica_metatype _s1;
for (tmpMeta[0] = _ss1; !listEmpty(tmpMeta[0]); tmpMeta[0]=MMC_CDR(tmpMeta[0]))
{
_s1 = MMC_CAR(tmpMeta[0]);
if(listEmpty(_ss))
{
_res = ((modelica_integer) -1);
goto _return;
}
tmpMeta[1] = _ss;
if (listEmpty(tmpMeta[1])) MMC_THROW_INTERNAL();
tmpMeta[2] = MMC_CAR(tmpMeta[1]);
tmpMeta[3] = MMC_CDR(tmpMeta[1]);
_s2 = tmpMeta[2];
_ss = tmpMeta[3];
_i1 = omc_Expression_subscriptInt(threadData, _s1);
_i2 = omc_Expression_subscriptInt(threadData, _s2);
_res = ((_i1 < _i2)?((modelica_integer) -1):((_i1 > _i2)?((modelica_integer) 1):((modelica_integer) 0)));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
}
}
if((!listEmpty(_ss)))
{
_res = ((modelica_integer) 1);
}
_return: OMC_LABEL_UNUSED
return _res;
}
modelica_metatype boxptr_ComponentReference_CompareWithoutSubscripts_compareSubs(threadData_t *threadData, modelica_metatype _ss1, modelica_metatype _ss2)
{
modelica_integer _res;
modelica_metatype out_res;
_res = omc_ComponentReference_CompareWithoutSubscripts_compareSubs(threadData, _ss1, _ss2);
out_res = mmc_mk_icon(_res);
return out_res;
}
DLLExport
modelica_integer omc_ComponentReference_CompareWithGenericSubscriptNotAlphabetic_compare(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _res;
modelica_integer tmp1 = 0;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _cr1;
tmp4_2 = _cr2;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 4; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
tmp1 = omc_ComponentReference_CompareWithGenericSubscriptNotAlphabetic_compareSubs(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 4))));
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
_res = omc_ComponentReference_CompareWithGenericSubscriptNotAlphabetic_compareSubs(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 4))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
_cr1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 5)));
_cr2 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 5)));
goto _tailrecursive;
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
_res = omc_ComponentReference_CompareWithGenericSubscriptNotAlphabetic_compareSubs(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 4))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
tmp1 = ((modelica_integer) 1);
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
_res = omc_ComponentReference_CompareWithGenericSubscriptNotAlphabetic_compareSubs(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 4))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
tmp1 = ((modelica_integer) -1);
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_res = tmp1;
_return: OMC_LABEL_UNUSED
return _res;
}
modelica_metatype boxptr_ComponentReference_CompareWithGenericSubscriptNotAlphabetic_compare(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _res;
modelica_metatype out_res;
_res = omc_ComponentReference_CompareWithGenericSubscriptNotAlphabetic_compare(threadData, _cr1, _cr2);
out_res = mmc_mk_icon(_res);
return out_res;
}
DLLExport
modelica_integer omc_ComponentReference_CompareWithGenericSubscriptNotAlphabetic_compareSubs(threadData_t *threadData, modelica_metatype _ss1, modelica_metatype _ss2)
{
modelica_integer _res;
modelica_metatype _ss = NULL;
modelica_metatype _s2 = NULL;
modelica_integer _i1;
modelica_integer _i2;
modelica_metatype _e1 = NULL;
modelica_metatype _e2 = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_res = ((modelica_integer) 0);
_ss = _ss2;
{
modelica_metatype _s1;
for (tmpMeta[0] = _ss1; !listEmpty(tmpMeta[0]); tmpMeta[0]=MMC_CDR(tmpMeta[0]))
{
_s1 = MMC_CAR(tmpMeta[0]);
if(listEmpty(_ss))
{
_res = ((modelica_integer) -1);
goto _return;
}
tmpMeta[1] = _ss;
if (listEmpty(tmpMeta[1])) MMC_THROW_INTERNAL();
tmpMeta[2] = MMC_CAR(tmpMeta[1]);
tmpMeta[3] = MMC_CDR(tmpMeta[1]);
_s2 = tmpMeta[2];
_ss = tmpMeta[3];
_res = omc_Expression_compareSubscripts(threadData, _s1, _s2);
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
}
}
if((!listEmpty(_ss)))
{
_res = ((modelica_integer) 1);
}
_return: OMC_LABEL_UNUSED
return _res;
}
modelica_metatype boxptr_ComponentReference_CompareWithGenericSubscriptNotAlphabetic_compareSubs(threadData_t *threadData, modelica_metatype _ss1, modelica_metatype _ss2)
{
modelica_integer _res;
modelica_metatype out_res;
_res = omc_ComponentReference_CompareWithGenericSubscriptNotAlphabetic_compareSubs(threadData, _ss1, _ss2);
out_res = mmc_mk_icon(_res);
return out_res;
}
DLLExport
modelica_integer omc_ComponentReference_CompareWithGenericSubscript_compareSubs(threadData_t *threadData, modelica_metatype _ss1, modelica_metatype _ss2)
{
modelica_integer _res;
modelica_metatype _ss = NULL;
modelica_metatype _s2 = NULL;
modelica_integer _i1;
modelica_integer _i2;
modelica_metatype _e1 = NULL;
modelica_metatype _e2 = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_res = ((modelica_integer) 0);
_ss = _ss2;
{
modelica_metatype _s1;
for (tmpMeta[0] = _ss1; !listEmpty(tmpMeta[0]); tmpMeta[0]=MMC_CDR(tmpMeta[0]))
{
_s1 = MMC_CAR(tmpMeta[0]);
if(listEmpty(_ss))
{
_res = ((modelica_integer) -1);
goto _return;
}
tmpMeta[1] = _ss;
if (listEmpty(tmpMeta[1])) MMC_THROW_INTERNAL();
tmpMeta[2] = MMC_CAR(tmpMeta[1]);
tmpMeta[3] = MMC_CDR(tmpMeta[1]);
_s2 = tmpMeta[2];
_ss = tmpMeta[3];
_res = stringCompare(omc_ExpressionDump_printSubscriptStr(threadData, _s1), omc_ExpressionDump_printSubscriptStr(threadData, _s2));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
}
}
if((!listEmpty(_ss)))
{
_res = ((modelica_integer) 1);
}
_return: OMC_LABEL_UNUSED
return _res;
}
modelica_metatype boxptr_ComponentReference_CompareWithGenericSubscript_compareSubs(threadData_t *threadData, modelica_metatype _ss1, modelica_metatype _ss2)
{
modelica_integer _res;
modelica_metatype out_res;
_res = omc_ComponentReference_CompareWithGenericSubscript_compareSubs(threadData, _ss1, _ss2);
out_res = mmc_mk_icon(_res);
return out_res;
}
DLLExport
modelica_integer omc_ComponentReference_CompareWithGenericSubscript_compare(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _res;
modelica_integer tmp1 = 0;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _cr1;
tmp4_2 = _cr2;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 4; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
tmp1 = omc_ComponentReference_CompareWithGenericSubscript_compareSubs(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 4))));
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
_res = omc_ComponentReference_CompareWithGenericSubscript_compareSubs(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 4))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
_cr1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 5)));
_cr2 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 5)));
goto _tailrecursive;
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
_res = omc_ComponentReference_CompareWithGenericSubscript_compareSubs(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 4))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
tmp1 = ((modelica_integer) 1);
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,4) == 0) goto tmp3_end;
_res = stringCompare((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 2))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
_res = omc_ComponentReference_CompareWithGenericSubscript_compareSubs(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cr2), 4))));
if((_res != ((modelica_integer) 0)))
{
goto _return;
}
tmp1 = ((modelica_integer) -1);
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_res = tmp1;
_return: OMC_LABEL_UNUSED
return _res;
}
modelica_metatype boxptr_ComponentReference_CompareWithGenericSubscript_compare(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_integer _res;
modelica_metatype out_res;
_res = omc_ComponentReference_CompareWithGenericSubscript_compare(threadData, _cr1, _cr2);
out_res = mmc_mk_icon(_res);
return out_res;
}
DLLExport
modelica_boolean omc_ComponentReference_crefFirstIdentEqual(threadData_t *threadData, modelica_metatype _inCref1, modelica_metatype _inCref2)
{
modelica_boolean _outEqual;
modelica_string _id1 = NULL;
modelica_string _id2 = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_id1 = omc_ComponentReference_crefFirstIdent(threadData, _inCref1);
_id2 = omc_ComponentReference_crefFirstIdent(threadData, _inCref2);
_outEqual = (stringEqual(_id1, _id2));
_return: OMC_LABEL_UNUSED
return _outEqual;
}
modelica_metatype boxptr_ComponentReference_crefFirstIdentEqual(threadData_t *threadData, modelica_metatype _inCref1, modelica_metatype _inCref2)
{
modelica_boolean _outEqual;
modelica_metatype out_outEqual;
_outEqual = omc_ComponentReference_crefFirstIdentEqual(threadData, _inCref1, _inCref2);
out_outEqual = mmc_mk_icon(_outEqual);
return out_outEqual;
}
DLLExport
modelica_boolean omc_ComponentReference_crefFirstCrefLastCrefEqual(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _equal;
modelica_metatype _pcr1 = NULL;
modelica_metatype _pcr2 = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_pcr1 = omc_ComponentReference_crefFirstCref(threadData, _cr1);
_pcr2 = omc_ComponentReference_crefLastCref(threadData, _cr2);
_equal = omc_ComponentReference_crefEqual(threadData, _pcr1, _pcr2);
_return: OMC_LABEL_UNUSED
return _equal;
}
modelica_metatype boxptr_ComponentReference_crefFirstCrefLastCrefEqual(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _equal;
modelica_metatype out_equal;
_equal = omc_ComponentReference_crefFirstCrefLastCrefEqual(threadData, _cr1, _cr2);
out_equal = mmc_mk_icon(_equal);
return out_equal;
}
DLLExport
modelica_boolean omc_ComponentReference_crefFirstCrefEqual(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _equal;
modelica_metatype _pcr1 = NULL;
modelica_metatype _pcr2 = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_pcr1 = omc_ComponentReference_crefFirstCref(threadData, _cr1);
_pcr2 = omc_ComponentReference_crefFirstCref(threadData, _cr2);
_equal = omc_ComponentReference_crefEqual(threadData, _pcr1, _pcr2);
_return: OMC_LABEL_UNUSED
return _equal;
}
modelica_metatype boxptr_ComponentReference_crefFirstCrefEqual(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _equal;
modelica_metatype out_equal;
_equal = omc_ComponentReference_crefFirstCrefEqual(threadData, _cr1, _cr2);
out_equal = mmc_mk_icon(_equal);
return out_equal;
}
DLLExport
modelica_boolean omc_ComponentReference_crefLastIdentEqual(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _equal;
modelica_string _id1 = NULL;
modelica_string _id2 = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_id1 = omc_ComponentReference_crefLastIdent(threadData, _cr1);
_id2 = omc_ComponentReference_crefLastIdent(threadData, _cr2);
_equal = (stringEqual(_id1, _id2));
_return: OMC_LABEL_UNUSED
return _equal;
}
modelica_metatype boxptr_ComponentReference_crefLastIdentEqual(threadData_t *threadData, modelica_metatype _cr1, modelica_metatype _cr2)
{
modelica_boolean _equal;
modelica_metatype out_equal;
_equal = omc_ComponentReference_crefLastIdentEqual(threadData, _cr1, _cr2);
out_equal = mmc_mk_icon(_equal);
return out_equal;
}
DLLExport
modelica_string omc_ComponentReference_debugPrintComponentRefTypeStr(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_string _outString = NULL;
modelica_string tmp1 = 0;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inComponentRef;
{
modelica_string _s = NULL;
modelica_string _str = NULL;
modelica_string _str2 = NULL;
modelica_string _strrest = NULL;
modelica_string _str_1 = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cr = NULL;
modelica_metatype _ty = NULL;
int tmp4;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
case 7: {
tmp1 = _OMC_LIT38;
goto tmp3_done;
}
case 4: {
modelica_boolean tmp5;
modelica_string tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
_s = tmpMeta[0];
_ty = tmpMeta[1];
_subs = tmpMeta[2];
_str_1 = omc_ExpressionDump_printListStr(threadData, _subs, boxvar_ExpressionDump_debugPrintSubscriptStr, _OMC_LIT33);
tmp5 = (modelica_boolean)(stringLength(_str_1) > ((modelica_integer) 0));
if(tmp5)
{
tmpMeta[0] = stringAppend(_OMC_LIT2,_str_1);
tmpMeta[1] = stringAppend(tmpMeta[0],_OMC_LIT6);
tmp6 = tmpMeta[1];
}
else
{
tmp6 = _OMC_LIT40;
}
tmpMeta[2] = stringAppend(_s,tmp6);
_str = tmpMeta[2];
_str2 = omc_Types_unparseType(threadData, _ty);
tmpMeta[0] = mmc_mk_cons(_str, mmc_mk_cons(_OMC_LIT58, mmc_mk_cons(_str2, mmc_mk_cons(_OMC_LIT6, MMC_REFSTRUCTLIT(mmc_nil)))));
tmp1 = stringAppendList(tmpMeta[0]);
goto tmp3_done;
}
case 3: {
modelica_boolean tmp7;
modelica_string tmp8;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_s = tmpMeta[0];
_ty = tmpMeta[1];
_subs = tmpMeta[2];
_cr = tmpMeta[3];
if(omc_Config_modelicaOutput(threadData))
{
_str = omc_ComponentReference_printComponentRef2Str(threadData, _s, _subs);
_str2 = omc_Types_unparseType(threadData, _ty);
_strrest = omc_ComponentReference_debugPrintComponentRefTypeStr(threadData, _cr);
tmpMeta[0] = mmc_mk_cons(_str, mmc_mk_cons(_OMC_LIT58, mmc_mk_cons(_str2, mmc_mk_cons(_OMC_LIT60, mmc_mk_cons(_strrest, MMC_REFSTRUCTLIT(mmc_nil))))));
_str = stringAppendList(tmpMeta[0]);
}
else
{
_str_1 = omc_ExpressionDump_printListStr(threadData, _subs, boxvar_ExpressionDump_debugPrintSubscriptStr, _OMC_LIT33);
tmp7 = (modelica_boolean)(stringLength(_str_1) > ((modelica_integer) 0));
if(tmp7)
{
tmpMeta[0] = stringAppend(_OMC_LIT2,_str_1);
tmpMeta[1] = stringAppend(tmpMeta[0],_OMC_LIT6);
tmp8 = tmpMeta[1];
}
else
{
tmp8 = _OMC_LIT40;
}
tmpMeta[2] = stringAppend(_s,tmp8);
_str = tmpMeta[2];
_str2 = omc_Types_unparseType(threadData, _ty);
_strrest = omc_ComponentReference_debugPrintComponentRefTypeStr(threadData, _cr);
tmpMeta[0] = mmc_mk_cons(_str, mmc_mk_cons(_OMC_LIT58, mmc_mk_cons(_str2, mmc_mk_cons(_OMC_LIT59, mmc_mk_cons(_strrest, MMC_REFSTRUCTLIT(mmc_nil))))));
_str = stringAppendList(tmpMeta[0]);
}
tmp1 = _str;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outString = tmp1;
_return: OMC_LABEL_UNUSED
return _outString;
}
DLLExport
modelica_string omc_ComponentReference_printComponentRef2Str(threadData_t *threadData, modelica_string _inIdent, modelica_metatype _inSubscriptLst)
{
modelica_string _outString = NULL;
modelica_string tmp1 = 0;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_string tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _inIdent;
tmp4_2 = _inSubscriptLst;
{
modelica_string _s = NULL;
modelica_string _str = NULL;
modelica_string _strseba = NULL;
modelica_string _strsebb = NULL;
modelica_metatype _l = NULL;
modelica_boolean _b;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_2)) goto tmp3_end;
_s = tmp4_1;
tmp1 = _s;
goto tmp3_done;
}
case 1: {
_s = tmp4_1;
_l = tmp4_2;
_b = omc_Config_modelicaOutput(threadData);
_str = omc_ExpressionDump_printListStr(threadData, _l, boxvar_ExpressionDump_printSubscriptStr, _OMC_LIT3);
tmpMeta[0] = (_b?_OMC_LIT61:_OMC_LIT62);
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 1));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 2));
_strseba = tmpMeta[1];
_strsebb = tmpMeta[2];
tmpMeta[0] = mmc_mk_cons(_s, mmc_mk_cons(_strseba, mmc_mk_cons(_str, mmc_mk_cons(_strsebb, MMC_REFSTRUCTLIT(mmc_nil)))));
tmp1 = stringAppendList(tmpMeta[0]);
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outString = tmp1;
_return: OMC_LABEL_UNUSED
return _outString;
}
DLLExport
modelica_string omc_ComponentReference_printComponentRefStrFixDollarDer(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_string _outString = NULL;
modelica_string tmp1 = 0;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inComponentRef;
{
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (4 != MMC_STRLEN(tmpMeta[0]) || strcmp(MMC_STRINGDATA(_OMC_LIT11), MMC_STRINGDATA(tmpMeta[0])) != 0) goto tmp3_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (!listEmpty(tmpMeta[1])) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_cr = tmpMeta[2];
tmpMeta[0] = stringAppend(_OMC_LIT7,omc_ComponentReference_printComponentRefStr(threadData, _cr));
tmpMeta[1] = stringAppend(tmpMeta[0],_OMC_LIT8);
tmp1 = tmpMeta[1];
goto tmp3_done;
}
case 1: {
tmp1 = omc_ComponentReference_printComponentRefStr(threadData, _inComponentRef);
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outString = tmp1;
_return: OMC_LABEL_UNUSED
return _outString;
}
DLLExport
modelica_string omc_ComponentReference_printComponentRefStr(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_string _outString = NULL;
modelica_string tmp1 = 0;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inComponentRef;
{
modelica_string _s = NULL;
modelica_string _str = NULL;
modelica_string _strrest = NULL;
modelica_string _strseb = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cr = NULL;
modelica_boolean _b;
modelica_integer _ix;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 6; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (!listEmpty(tmpMeta[1])) goto tmp3_end;
_s = tmpMeta[0];
tmp1 = _s;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
_s = tmpMeta[0];
_subs = tmpMeta[1];
tmp1 = omc_ComponentReference_printComponentRef2Str(threadData, _s, _subs);
goto tmp3_done;
}
case 2: {
modelica_integer tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmp6 = mmc_unbox_integer(tmpMeta[1]);
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
if (!listEmpty(tmpMeta[2])) goto tmp3_end;
_s = tmpMeta[0];
_ix = tmp6;
tmpMeta[0] = stringAppend(_s,_OMC_LIT63);
tmpMeta[1] = stringAppend(tmpMeta[0],intString(_ix));
tmpMeta[2] = stringAppend(tmpMeta[1],_OMC_LIT64);
tmp1 = tmpMeta[2];
goto tmp3_done;
}
case 3: {
modelica_integer tmp7;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmp7 = mmc_unbox_integer(tmpMeta[1]);
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_s = tmpMeta[0];
_ix = tmp7;
_subs = tmpMeta[2];
_str = omc_ComponentReference_printComponentRef2Str(threadData, _s, _subs);
tmpMeta[0] = stringAppend(_str,_OMC_LIT63);
tmpMeta[1] = stringAppend(tmpMeta[0],intString(_ix));
tmpMeta[2] = stringAppend(tmpMeta[1],_OMC_LIT64);
tmp1 = tmpMeta[2];
goto tmp3_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_s = tmpMeta[0];
_subs = tmpMeta[1];
_cr = tmpMeta[2];
_b = omc_Config_modelicaOutput(threadData);
_str = omc_ComponentReference_printComponentRef2Str(threadData, _s, _subs);
_strrest = omc_ComponentReference_printComponentRefStr(threadData, _cr);
_strseb = (_b?_OMC_LIT39:_OMC_LIT10);
tmpMeta[0] = mmc_mk_cons(_str, mmc_mk_cons(_strseb, mmc_mk_cons(_strrest, MMC_REFSTRUCTLIT(mmc_nil))));
tmp1 = stringAppendList(tmpMeta[0]);
goto tmp3_done;
}
case 5: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,0) == 0) goto tmp3_end;
tmp1 = _OMC_LIT38;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outString = tmp1;
_return: OMC_LABEL_UNUSED
return _outString;
}
DLLExport
modelica_string omc_ComponentReference_printComponentRefOptStr(threadData_t *threadData, modelica_metatype _inComponentRefOpt)
{
modelica_string _outString = NULL;
modelica_string tmp1 = 0;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inComponentRefOpt;
{
modelica_string _str = NULL;
modelica_metatype _cref = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!optionNone(tmp4_1)) goto tmp3_end;
tmp1 = _OMC_LIT65;
goto tmp3_done;
}
case 1: {
if (optionNone(tmp4_1)) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
_cref = tmpMeta[0];
_str = omc_ComponentReference_printComponentRefStr(threadData, _cref);
tmpMeta[0] = stringAppend(_OMC_LIT66,_str);
tmpMeta[1] = stringAppend(tmpMeta[0],_OMC_LIT8);
tmp1 = tmpMeta[1];
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outString = tmp1;
_return: OMC_LABEL_UNUSED
return _outString;
}
DLLExport
modelica_string omc_ComponentReference_crefModelicaStr(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_string _outString = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outString = stringDelimitList(omc_ComponentReference_toStringList(threadData, _inComponentRef), _OMC_LIT38);
_return: OMC_LABEL_UNUSED
return _outString;
}
DLLExport
modelica_string omc_ComponentReference_crefListStr(threadData_t *threadData, modelica_metatype _crList)
{
modelica_string _outString = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outString = _OMC_LIT40;
{
modelica_metatype _cr;
for (tmpMeta[0] = _crList; !listEmpty(tmpMeta[0]); tmpMeta[0]=MMC_CDR(tmpMeta[0]))
{
_cr = MMC_CAR(tmpMeta[0]);
tmpMeta[1] = stringAppend(_outString,omc_ComponentReference_crefStr(threadData, _cr));
tmpMeta[2] = stringAppend(tmpMeta[1],_OMC_LIT21);
_outString = tmpMeta[2];
}
}
_return: OMC_LABEL_UNUSED
return _outString;
}
DLLExport
modelica_string omc_ComponentReference_crefStr(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_string _outString = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outString = stringDelimitList(omc_ComponentReference_toStringList(threadData, _inComponentRef), (omc_Flags_getConfigBool(threadData, _OMC_LIT74)?_OMC_LIT39:_OMC_LIT10));
_return: OMC_LABEL_UNUSED
return _outString;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_toExpCrefSubs(threadData_t *threadData, modelica_metatype _absynSubs)
{
modelica_metatype _daeSubs = NULL;
modelica_integer _i;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype __omcQ_24tmpVar3;
modelica_metatype* tmp1;
modelica_metatype __omcQ_24tmpVar2;
int tmp6;
modelica_metatype _sub_loopVar = 0;
modelica_metatype _sub;
_sub_loopVar = _absynSubs;
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
__omcQ_24tmpVar3 = tmpMeta[1];
tmp1 = &__omcQ_24tmpVar3;
while(1) {
tmp6 = 1;
if (!listEmpty(_sub_loopVar)) {
_sub = MMC_CAR(_sub_loopVar);
_sub_loopVar = MMC_CDR(_sub_loopVar);
tmp6--;
}
if (tmp6 == 0) {
{
modelica_metatype tmp4_1;
tmp4_1 = _sub;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
tmpMeta[3] = mmc_mk_box2(5, &DAE_Subscript_INDEX__desc, omc_Expression_fromAbsynExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_sub), 2)))));
tmpMeta[2] = tmpMeta[3];
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,0) == 0) goto tmp3_end;
tmpMeta[2] = _OMC_LIT26;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}__omcQ_24tmpVar2 = tmpMeta[2];
*tmp1 = mmc_mk_cons(__omcQ_24tmpVar2,0);
tmp1 = &MMC_CDR(*tmp1);
} else if (tmp6 == 1) {
break;
} else {
MMC_THROW_INTERNAL();
}
}
*tmp1 = mmc_mk_nil();
tmpMeta[0] = __omcQ_24tmpVar3;
}
_daeSubs = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _daeSubs;
}
DLLExport
modelica_metatype omc_ComponentReference_toExpCref(threadData_t *threadData, modelica_metatype _absynCref)
{
modelica_metatype _daeCref = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _absynCref;
{
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 5: {
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_absynCref), 2))), _OMC_LIT0, omc_ComponentReference_toExpCrefSubs(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_absynCref), 3)))));
goto tmp2_done;
}
case 4: {
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_absynCref), 2))), _OMC_LIT0, omc_ComponentReference_toExpCrefSubs(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_absynCref), 3)))), omc_ComponentReference_toExpCref(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_absynCref), 4)))));
goto tmp2_done;
}
case 3: {
_absynCref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_absynCref), 2)));
goto _tailrecursive;
goto tmp2_done;
}
case 6: {
tmpMeta[0] = _OMC_LIT75;
goto tmp2_done;
}
case 7: {
tmpMeta[0] = _OMC_LIT75;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_daeCref = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _daeCref;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ComponentReference_unelabSubscripts(threadData_t *threadData, modelica_metatype _inSubscriptLst)
{
modelica_metatype _outAbsynSubscriptLst = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inSubscriptLst;
{
modelica_metatype _xs_1 = NULL;
modelica_metatype _xs = NULL;
modelica_metatype _e_1 = NULL;
modelica_metatype _e = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 5; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],0,0) == 0) goto tmp2_end;
_xs = tmpMeta[2];
_xs_1 = omc_ComponentReference_unelabSubscripts(threadData, _xs);
tmpMeta[1] = mmc_mk_cons(_OMC_LIT76, _xs_1);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 2: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],1,1) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
_e = tmpMeta[3];
_xs = tmpMeta[2];
_xs_1 = omc_ComponentReference_unelabSubscripts(threadData, _xs);
_e_1 = omc_Expression_unelabExp(threadData, _e);
tmpMeta[2] = mmc_mk_box2(4, &Absyn_Subscript_SUBSCRIPT__desc, _e_1);
tmpMeta[1] = mmc_mk_cons(tmpMeta[2], _xs_1);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 3: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],2,1) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
_e = tmpMeta[3];
_xs = tmpMeta[2];
_xs_1 = omc_ComponentReference_unelabSubscripts(threadData, _xs);
_e_1 = omc_Expression_unelabExp(threadData, _e);
tmpMeta[2] = mmc_mk_box2(4, &Absyn_Subscript_SUBSCRIPT__desc, _e_1);
tmpMeta[1] = mmc_mk_cons(tmpMeta[2], _xs_1);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 4: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],3,1) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
_e = tmpMeta[3];
_xs = tmpMeta[2];
_xs_1 = omc_ComponentReference_unelabSubscripts(threadData, _xs);
_e_1 = omc_Expression_unelabExp(threadData, _e);
tmpMeta[2] = mmc_mk_box2(4, &Absyn_Subscript_SUBSCRIPT__desc, _e_1);
tmpMeta[1] = mmc_mk_cons(tmpMeta[2], _xs_1);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outAbsynSubscriptLst = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outAbsynSubscriptLst;
}
DLLExport
modelica_metatype omc_ComponentReference_unelabCref(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_metatype _outComponentRef = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
modelica_metatype _subs_1 = NULL;
modelica_string _id = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cr_1 = NULL;
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 4; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_subs = tmpMeta[2];
tmp3 += 2;
_subs_1 = omc_ComponentReference_unelabSubscripts(threadData, _subs);
tmpMeta[1] = mmc_mk_box3(5, &Absyn_ComponentRef_CREF__IDENT__desc, _id, _subs_1);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_id = tmpMeta[1];
_subs = tmpMeta[2];
tmp3 += 1;
_subs_1 = omc_ComponentReference_unelabSubscripts(threadData, _subs);
tmpMeta[1] = mmc_mk_box3(5, &Absyn_ComponentRef_CREF__IDENT__desc, _id, _subs_1);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_id = tmpMeta[1];
_subs = tmpMeta[2];
_cr = tmpMeta[3];
_cr_1 = omc_ComponentReference_unelabCref(threadData, _cr);
_subs_1 = omc_ComponentReference_unelabSubscripts(threadData, _subs);
tmpMeta[1] = mmc_mk_box4(4, &Absyn_ComponentRef_CREF__QUAL__desc, _id, _subs_1, _cr_1);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 3: {
modelica_boolean tmp5;
tmp5 = omc_Flags_isSet(threadData, _OMC_LIT30);
if (1 != tmp5) goto goto_1;
tmpMeta[1] = stringAppend(_OMC_LIT77,omc_ComponentReference_printComponentRefStr(threadData, _inComponentRef));
tmpMeta[2] = stringAppend(tmpMeta[1],_OMC_LIT21);
fputs(MMC_STRINGDATA(tmpMeta[2]),stdout);
goto goto_1;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 4) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_outComponentRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
DLLExport
modelica_metatype omc_ComponentReference_creffromVar(threadData_t *threadData, modelica_metatype _inVar)
{
modelica_metatype _outComponentRef = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inVar;
{
modelica_string _name = NULL;
modelica_metatype _ty = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 1; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_name = tmpMeta[1];
_ty = tmpMeta[2];
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _name, _ty, tmpMeta[1]);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outComponentRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
DLLExport
modelica_metatype omc_ComponentReference_pathToCref(threadData_t *threadData, modelica_metatype _inPath)
{
modelica_metatype _outComponentRef = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inPath;
{
modelica_string _i = NULL;
modelica_metatype _c = NULL;
modelica_metatype _p = NULL;
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,1) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_i = tmpMeta[1];
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = omc_ComponentReference_makeCrefIdent(threadData, _i, _OMC_LIT0, tmpMeta[1]);
goto tmp2_done;
}
case 5: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,1) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_p = tmpMeta[1];
_inPath = _p;
goto _tailrecursive;
goto tmp2_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,2) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
_i = tmpMeta[1];
_p = tmpMeta[2];
_c = omc_ComponentReference_pathToCref(threadData, _p);
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = omc_ComponentReference_makeCrefQual(threadData, _i, _OMC_LIT0, tmpMeta[1], _c);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outComponentRef = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outComponentRef;
}
DLLExport
modelica_metatype omc_ComponentReference_crefToPathIgnoreSubs(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_metatype _outPath = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
modelica_string _i = NULL;
modelica_metatype _p = NULL;
modelica_metatype _c = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_i = tmpMeta[1];
tmpMeta[1] = mmc_mk_box2(4, &Absyn_Path_IDENT__desc, _i);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_i = tmpMeta[1];
_c = tmpMeta[2];
_p = omc_ComponentReference_crefToPathIgnoreSubs(threadData, _c);
tmpMeta[1] = mmc_mk_box3(3, &Absyn_Path_QUALIFIED__desc, _i, _p);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outPath = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outPath;
}
DLLExport
modelica_metatype omc_ComponentReference_crefToPath(threadData_t *threadData, modelica_metatype _inComponentRef)
{
modelica_metatype _outPath = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inComponentRef;
{
modelica_string _i = NULL;
modelica_metatype _p = NULL;
modelica_metatype _c = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
if (!listEmpty(tmpMeta[2])) goto tmp2_end;
_i = tmpMeta[1];
tmpMeta[1] = mmc_mk_box2(4, &Absyn_Path_IDENT__desc, _i);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
if (!listEmpty(tmpMeta[2])) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_i = tmpMeta[1];
_c = tmpMeta[3];
_p = omc_ComponentReference_crefToPath(threadData, _c);
tmpMeta[1] = mmc_mk_box3(3, &Absyn_Path_QUALIFIED__desc, _i, _p);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outPath = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outPath;
}
DLLExport
modelica_metatype omc_ComponentReference_makeCrefQual(threadData_t *threadData, modelica_string _ident, modelica_metatype _identType, modelica_metatype _subscriptLst, modelica_metatype _componentRef)
{
modelica_metatype _outCrefQual = NULL;
modelica_metatype _subCref = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = mmc_mk_box5(3, &DAE_ComponentRef_CREF__QUAL__desc, _ident, _identType, _subscriptLst, _componentRef);
_outCrefQual = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCrefQual;
}
DLLExport
modelica_metatype omc_ComponentReference_makeUntypedCrefIdent(threadData_t *threadData, modelica_string _ident)
{
modelica_metatype _outCrefIdent = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[1] = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, _ident, _OMC_LIT0, tmpMeta[0]);
_outCrefIdent = tmpMeta[1];
_return: OMC_LABEL_UNUSED
return _outCrefIdent;
}
DLLExport
modelica_metatype omc_ComponentReference_makeCrefIdent(threadData_t *threadData, modelica_string _ident, modelica_metatype _identType, modelica_metatype _subscriptLst)
{
modelica_metatype _outCrefIdent = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, _ident, _identType, _subscriptLst);
_outCrefIdent = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCrefIdent;
}
DLLExport
modelica_metatype omc_ComponentReference_makeDummyCref(threadData_t *threadData)
{
modelica_metatype _outCrefIdent = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outCrefIdent = _OMC_LIT79;
_return: OMC_LABEL_UNUSED
return _outCrefIdent;
}
DLLExport
modelica_metatype omc_ComponentReference_createEmptyCrefMemory(threadData_t *threadData)
{
modelica_metatype _crefMemory = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_crefMemory = arrayCreate(((modelica_integer) 3), tmpMeta[0]);
_return: OMC_LABEL_UNUSED
return _crefMemory;
}
PROTECTED_FUNCTION_STATIC modelica_integer omc_ComponentReference_hashSubscript(threadData_t *threadData, modelica_metatype _sub)
{
modelica_integer _hash;
modelica_integer tmp1 = 0;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _sub;
{
modelica_metatype _exp = NULL;
modelica_integer _i;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 5; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,0) == 0) goto tmp3_end;
tmp1 = ((modelica_integer) 0);
goto tmp3_done;
}
case 1: {
modelica_integer tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[0],0,1) == 0) goto tmp3_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 2));
tmp6 = mmc_unbox_integer(tmpMeta[1]);
_i = tmp6;
tmp1 = _i;
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_exp = tmpMeta[0];
tmp1 = omc_Expression_hashExp(threadData, _exp);
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_exp = tmpMeta[0];
tmp1 = omc_Expression_hashExp(threadData, _exp);
goto tmp3_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,1) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_exp = tmpMeta[0];
tmp1 = omc_Expression_hashExp(threadData, _exp);
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_hash = tmp1;
_return: OMC_LABEL_UNUSED
return _hash;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_hashSubscript(threadData_t *threadData, modelica_metatype _sub)
{
modelica_integer _hash;
modelica_metatype out_hash;
_hash = omc_ComponentReference_hashSubscript(threadData, _sub);
out_hash = mmc_mk_icon(_hash);
return out_hash;
}
PROTECTED_FUNCTION_STATIC modelica_integer omc_ComponentReference_hashSubscripts2(threadData_t *threadData, modelica_metatype _dims, modelica_metatype _subs, modelica_integer _factor)
{
modelica_integer _hash;
modelica_integer tmp1 = 0;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _dims;
tmp4_2 = _subs;
{
modelica_metatype _s = NULL;
modelica_metatype _rest_dims = NULL;
modelica_metatype _rest_subs = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_1)) goto tmp3_end;
if (!listEmpty(tmp4_2)) goto tmp3_end;
tmp1 = ((modelica_integer) 0);
goto tmp3_done;
}
case 1: {
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[0] = MMC_CAR(tmp4_1);
tmpMeta[1] = MMC_CDR(tmp4_1);
if (listEmpty(tmp4_2)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_2);
tmpMeta[3] = MMC_CDR(tmp4_2);
_rest_dims = tmpMeta[1];
_s = tmpMeta[2];
_rest_subs = tmpMeta[3];
tmp1 = (omc_ComponentReference_hashSubscript(threadData, _s)) * (_factor) + omc_ComponentReference_hashSubscripts2(threadData, _rest_dims, _rest_subs, (((modelica_integer) 1000)) * (_factor));
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_hash = tmp1;
_return: OMC_LABEL_UNUSED
return _hash;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_hashSubscripts2(threadData_t *threadData, modelica_metatype _dims, modelica_metatype _subs, modelica_metatype _factor)
{
modelica_integer tmp1;
modelica_integer _hash;
modelica_metatype out_hash;
tmp1 = mmc_unbox_integer(_factor);
_hash = omc_ComponentReference_hashSubscripts2(threadData, _dims, _subs, tmp1);
out_hash = mmc_mk_icon(_hash);
return out_hash;
}
PROTECTED_FUNCTION_STATIC modelica_integer omc_ComponentReference_hashSubscripts(threadData_t *threadData, modelica_metatype _tp, modelica_metatype _subs)
{
modelica_integer _hash;
modelica_integer tmp1 = 0;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _subs;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_1)) goto tmp3_end;
tmp1 = ((modelica_integer) 0);
goto tmp3_done;
}
case 1: {
tmp1 = omc_ComponentReference_hashSubscripts2(threadData, omc_List_fill(threadData, mmc_mk_integer(((modelica_integer) 1)), listLength(_subs)), _subs, ((modelica_integer) 1));
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_hash = tmp1;
_return: OMC_LABEL_UNUSED
return _hash;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ComponentReference_hashSubscripts(threadData_t *threadData, modelica_metatype _tp, modelica_metatype _subs)
{
modelica_integer _hash;
modelica_metatype out_hash;
_hash = omc_ComponentReference_hashSubscripts(threadData, _tp, _subs);
out_hash = mmc_mk_icon(_hash);
return out_hash;
}
DLLExport
modelica_integer omc_ComponentReference_hashComponentRef(threadData_t *threadData, modelica_metatype _cr)
{
modelica_integer _hash;
modelica_integer tmp1 = 0;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _cr;
{
modelica_string _id = NULL;
modelica_metatype _tp = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cr1 = NULL;
int tmp4;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
_id = tmpMeta[0];
_tp = tmpMeta[1];
_subs = tmpMeta[2];
tmp1 = stringHashDjb2(_id) + omc_ComponentReference_hashSubscripts(threadData, _tp, _subs);
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_id = tmpMeta[0];
_tp = tmpMeta[1];
_subs = tmpMeta[2];
_cr1 = tmpMeta[3];
tmp1 = stringHashDjb2(_id) + omc_ComponentReference_hashSubscripts(threadData, _tp, _subs) + omc_ComponentReference_hashComponentRef(threadData, _cr1);
goto tmp3_done;
}
case 5: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_id = tmpMeta[0];
_tp = tmpMeta[1];
_subs = tmpMeta[2];
tmp1 = stringHashDjb2(_id) + omc_ComponentReference_hashSubscripts(threadData, _tp, _subs);
goto tmp3_done;
}
default:
tmp3_default: OMC_LABEL_UNUSED; {
tmp1 = ((modelica_integer) 0);
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_hash = tmp1;
_return: OMC_LABEL_UNUSED
return _hash;
}
modelica_metatype boxptr_ComponentReference_hashComponentRef(threadData_t *threadData, modelica_metatype _cr)
{
modelica_integer _hash;
modelica_metatype out_hash;
_hash = omc_ComponentReference_hashComponentRef(threadData, _cr);
out_hash = mmc_mk_icon(_hash);
return out_hash;
}
DLLExport
modelica_integer omc_ComponentReference_hashComponentRefMod(threadData_t *threadData, modelica_metatype _cr, modelica_integer _mod)
{
modelica_integer _res;
modelica_integer _h;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_h = labs(omc_ComponentReference_hashComponentRef(threadData, _cr));
_res = modelica_integer_mod(_h, _mod);
_return: OMC_LABEL_UNUSED
return _res;
}
modelica_metatype boxptr_ComponentReference_hashComponentRefMod(threadData_t *threadData, modelica_metatype _cr, modelica_metatype _mod)
{
modelica_integer tmp1;
modelica_integer _res;
modelica_metatype out_res;
tmp1 = mmc_unbox_integer(_mod);
_res = omc_ComponentReference_hashComponentRefMod(threadData, _cr, tmp1);
out_res = mmc_mk_icon(_res);
return out_res;
}
