#ifdef OMC_BASE_FILE
#define OMC_FILE OMC_BASE_FILE
#else
#define OMC_FILE "/home/mahge/dev/OpenModelica/OMCompiler/Compiler/boot/build/tmp/Patternm.c"
#endif
#include "omc_simulation_settings.h"
#include "Patternm.h"
#define _OMC_LIT0_data "patternmAllInfo"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT0,15,_OMC_LIT0_data);
#define _OMC_LIT0 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT0)
#define _OMC_LIT1_data "Adds notifications of all pattern-matching optimizations that are performed."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT1,76,_OMC_LIT1_data);
#define _OMC_LIT1 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT1)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT2,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT1}};
#define _OMC_LIT2 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT2)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT3,5,3) {&Flags_DebugFlag_DEBUG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(22)),_OMC_LIT0,MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),_OMC_LIT2}};
#define _OMC_LIT3 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT3)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT4,1,5) {&ErrorTypes_MessageType_TRANSLATION__desc,}};
#define _OMC_LIT4 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT4)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT5,1,6) {&ErrorTypes_Severity_NOTIFICATION__desc,}};
#define _OMC_LIT5 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT5)
#define _OMC_LIT6_data "Dead code elimination: %s."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT6,26,_OMC_LIT6_data);
#define _OMC_LIT6 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT7,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT6}};
#define _OMC_LIT7 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT7)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT8,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5026)),_OMC_LIT4,_OMC_LIT5,_OMC_LIT7}};
#define _OMC_LIT8 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT8)
#define _OMC_LIT9_data "Statement optimised away"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT9,24,_OMC_LIT9_data);
#define _OMC_LIT9 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT9)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT10,2,1) {_OMC_LIT9,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT10 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT10)
#define _OMC_LIT11_data "Patternm.statementFindDeadStore"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT11,31,_OMC_LIT11_data);
#define _OMC_LIT11 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT11)
#define _OMC_LIT12_data "fail"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT12,4,_OMC_LIT12_data);
#define _OMC_LIT12 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT12)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT13,1,6) {&DAE_ConnectorType_NON__CONNECTOR__desc,}};
#define _OMC_LIT13 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT13)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT14,1,5) {&SCode_Parallelism_NON__PARALLEL__desc,}};
#define _OMC_LIT14 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT14)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT15,1,3) {&SCode_Variability_VAR__desc,}};
#define _OMC_LIT15 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT15)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT16,1,3) {&Absyn_Direction_INPUT__desc,}};
#define _OMC_LIT16 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT16)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT17,1,6) {&Absyn_InnerOuter_NOT__INNER__OUTER__desc,}};
#define _OMC_LIT17 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT17)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT18,1,3) {&SCode_Visibility_PUBLIC__desc,}};
#define _OMC_LIT18 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT18)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT19,7,3) {&DAE_Attributes_ATTR__desc,_OMC_LIT13,_OMC_LIT14,_OMC_LIT15,_OMC_LIT16,_OMC_LIT17,_OMC_LIT18}};
#define _OMC_LIT19 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT19)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT20,1,3) {&DAE_Binding_UNBOUND__desc,}};
#define _OMC_LIT20 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT20)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT21,1,4) {&SCode_Redeclare_NOT__REDECLARE__desc,}};
#define _OMC_LIT21 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT21)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT22,1,4) {&SCode_Final_NOT__FINAL__desc,}};
#define _OMC_LIT22 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT22)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT23,1,4) {&SCode_Replaceable_NOT__REPLACEABLE__desc,}};
#define _OMC_LIT23 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT23)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT24,6,3) {&SCode_Prefixes_PREFIXES__desc,_OMC_LIT18,_OMC_LIT21,_OMC_LIT22,_OMC_LIT17,_OMC_LIT23}};
#define _OMC_LIT24 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT24)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT25,1,3) {&SCode_ConnectorType_POTENTIAL__desc,}};
#define _OMC_LIT25 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT25)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT26,1,5) {&Absyn_Direction_BIDIR__desc,}};
#define _OMC_LIT26 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT26)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT27,1,3) {&Absyn_IsField_NONFIELD__desc,}};
#define _OMC_LIT27 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT27)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT28,7,3) {&SCode_Attributes_ATTR__desc,MMC_REFSTRUCTLIT(mmc_nil),_OMC_LIT25,_OMC_LIT14,_OMC_LIT15,_OMC_LIT26,_OMC_LIT27}};
#define _OMC_LIT28 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT28)
#define _OMC_LIT29_data "$dummy"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT29,6,_OMC_LIT29_data);
#define _OMC_LIT29 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT29)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT30,2,4) {&Absyn_Path_IDENT__desc,_OMC_LIT29}};
#define _OMC_LIT30 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT30)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT31,3,3) {&Absyn_TypeSpec_TPATH__desc,_OMC_LIT30,MMC_REFSTRUCTLIT(mmc_none)}};
#define _OMC_LIT31 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT31)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT32,1,5) {&SCode_Mod_NOMOD__desc,}};
#define _OMC_LIT32 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT32)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT33,3,3) {&SCode_Comment_COMMENT__desc,MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none)}};
#define _OMC_LIT33 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT33)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT34,1,5) {&DAE_Mod_NOMOD__desc,}};
#define _OMC_LIT34 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT34)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT35,1,5) {&FCore_Status_VAR__DAE__desc,}};
#define _OMC_LIT35 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT35)
#define _OMC_LIT36_data ""
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT36,0,_OMC_LIT36_data);
#define _OMC_LIT36 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT36)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT37,0.0);
#define _OMC_LIT37 MMC_REFREALLIT(_OMC_LIT_STRUCT37)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT38,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT36,MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),_OMC_LIT37}};
#define _OMC_LIT38 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT38)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT39,1,3) {&InstTypes_SearchStrategy_SEARCH__LOCAL__ONLY__desc,}};
#define _OMC_LIT39 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT39)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT40,1,4) {&ErrorTypes_Severity_ERROR__desc,}};
#define _OMC_LIT40 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT40)
#define _OMC_LIT41_data "Local variable '%s' shadows another variable."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT41,45,_OMC_LIT41_data);
#define _OMC_LIT41 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT41)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT42,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT41}};
#define _OMC_LIT42 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT42)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT43,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5001)),_OMC_LIT4,_OMC_LIT40,_OMC_LIT42}};
#define _OMC_LIT43 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT43)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT44,2,3) {&DAE_DAElist_DAE__desc,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT44 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT44)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT45,1,4) {&SCode_Encapsulated_NOT__ENCAPSULATED__desc,}};
#define _OMC_LIT45 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT45)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT46,1,4) {&SCode_Visibility_PROTECTED__desc,}};
#define _OMC_LIT46 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT46)
#define _OMC_LIT47_data "dummieFunc"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT47,10,_OMC_LIT47_data);
#define _OMC_LIT47 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT47)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT48,2,4) {&Absyn_Path_IDENT__desc,_OMC_LIT47}};
#define _OMC_LIT48 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT48)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT49,3,11) {&ClassInf_State_FUNCTION__desc,_OMC_LIT48,MMC_IMMEDIATE(MMC_TAGFIXNUM(0))}};
#define _OMC_LIT49 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT49)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT50,1,3) {&DAE_Prefix_NOPRE__desc,}};
#define _OMC_LIT50 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT50)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT51,1,4) {&UnitAbsyn_InstStore_NOSTORE__desc,}};
#define _OMC_LIT51 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT51)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT52,1,4) {&InstTypes_CallingScope_INNER__CALL__desc,}};
#define _OMC_LIT52 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT52)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT53,7,3) {&ConnectionGraph_ConnectionGraph_GRAPH__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT53 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT53)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT54,1,7) {&DAE_ComponentRef_WILD__desc,}};
#define _OMC_LIT54 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT54)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT55,5,3) {&DAE_Connect_SetTrieNode_SET__TRIE__NODE__desc,_OMC_LIT36,_OMC_LIT54,MMC_REFSTRUCTLIT(mmc_nil),MMC_IMMEDIATE(MMC_TAGFIXNUM(0))}};
#define _OMC_LIT55 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT55)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT56,5,3) {&DAE_Connect_Sets_SETS__desc,_OMC_LIT55,MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT56 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT56)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT57,10,3) {&SCodeDump_SCodeDumpOptions_OPTIONS__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0))}};
#define _OMC_LIT57 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT57)
#define _OMC_LIT58_data ", "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT58,2,_OMC_LIT58_data);
#define _OMC_LIT58 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT58)
#define _OMC_LIT59_data "Only components without direction are allowed in local declarations, got: %s"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT59,76,_OMC_LIT59_data);
#define _OMC_LIT59 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT59)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT60,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT59}};
#define _OMC_LIT60 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT60)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT61,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5019)),_OMC_LIT4,_OMC_LIT40,_OMC_LIT60}};
#define _OMC_LIT61 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT61)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT62,1,4) {&Absyn_Direction_OUTPUT__desc,}};
#define _OMC_LIT62 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT62)
#define _OMC_LIT63_data "Internal error %s"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT63,17,_OMC_LIT63_data);
#define _OMC_LIT63 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT63)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT64,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT63}};
#define _OMC_LIT64 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT64)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT65,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(63)),_OMC_LIT4,_OMC_LIT40,_OMC_LIT64}};
#define _OMC_LIT65 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT65)
#define _OMC_LIT66_data "Patternm.addLocalDecls failed"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT66,29,_OMC_LIT66_data);
#define _OMC_LIT66 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT66)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT67,2,1) {_OMC_LIT66,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT67 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT67)
#define _OMC_LIT68_data "Patternm.fixCaseReturnTypes2 failed"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT68,35,_OMC_LIT68_data);
#define _OMC_LIT68 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT68)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT69,2,1) {_OMC_LIT68,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT69 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT69)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT70,1,10) {&DAE_Type_T__NORETCALL__desc,}};
#define _OMC_LIT70 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT70)
#define _OMC_LIT71_data "\n  "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT71,3,_OMC_LIT71_data);
#define _OMC_LIT71 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT71)
#define _OMC_LIT72_data "Match expression has mismatched result types:%s"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT72,47,_OMC_LIT72_data);
#define _OMC_LIT72 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT72)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT73,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT72}};
#define _OMC_LIT73 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT73)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT74,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5024)),_OMC_LIT4,_OMC_LIT40,_OMC_LIT73}};
#define _OMC_LIT74 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT74)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT75,2,6) {&DAE_Type_T__BOOL__desc,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT75 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT75)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT76,1,4) {&ErrorTypes_MessageType_GRAMMAR__desc,}};
#define _OMC_LIT76 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT76)
#define _OMC_LIT77_data "Guard expressions need to be Boolean, got expression of type %s."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT77,64,_OMC_LIT77_data);
#define _OMC_LIT77 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT77)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT78,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT77}};
#define _OMC_LIT78 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT78)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT79,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(242)),_OMC_LIT76,_OMC_LIT40,_OMC_LIT78}};
#define _OMC_LIT79 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT79)
#define _OMC_LIT80_data "patternmMoveLastExp"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT80,19,_OMC_LIT80_data);
#define _OMC_LIT80 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT80)
#define _OMC_LIT81_data "Optimization that moves the last assignment(s) into the result of a match-expression. For example: equation c = fn(b); then c; => then fn(b);"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT81,141,_OMC_LIT81_data);
#define _OMC_LIT81 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT81)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT82,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT81}};
#define _OMC_LIT82 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT82)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT83,5,3) {&Flags_DebugFlag_DEBUG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(24)),_OMC_LIT80,MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),_OMC_LIT82}};
#define _OMC_LIT83 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT83)
#define _OMC_LIT84_data "$case scope$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT84,12,_OMC_LIT84_data);
#define _OMC_LIT84 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT84)
#define _OMC_LIT85_data "$pattern type scope$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT85,20,_OMC_LIT85_data);
#define _OMC_LIT85 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT85)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT86,1,1) {_OMC_LIT85}};
#define _OMC_LIT86 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT86)
#define _OMC_LIT87_data "match"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT87,5,_OMC_LIT87_data);
#define _OMC_LIT87 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT87)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT88,2,4) {&Absyn_Path_IDENT__desc,_OMC_LIT87}};
#define _OMC_LIT88 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT88)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT89,3,11) {&ClassInf_State_FUNCTION__desc,_OMC_LIT88,MMC_IMMEDIATE(MMC_TAGFIXNUM(0))}};
#define _OMC_LIT89 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT89)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT90,1,4) {&DAE_ComponentPrefix_NOCOMPPRE__desc,}};
#define _OMC_LIT90 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT90)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT91,8,3) {&DAE_ElementSource_SOURCE__desc,_OMC_LIT38,MMC_REFSTRUCTLIT(mmc_nil),_OMC_LIT90,MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT91 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT91)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT92,1,4) {&SCode_Initial_NON__INITIAL__desc,}};
#define _OMC_LIT92 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT92)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT93,1,6) {&Absyn_ComponentRef_WILD__desc,}};
#define _OMC_LIT93 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT93)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT94,2,5) {&Absyn_Exp_CREF__desc,_OMC_LIT93}};
#define _OMC_LIT94 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT94)
#define _OMC_LIT95_data "This matchcontinue expression has no overlapping patterns and should be using match instead of matchcontinue."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT95,109,_OMC_LIT95_data);
#define _OMC_LIT95 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT95)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT96,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT95}};
#define _OMC_LIT96 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT96)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT97,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5025)),_OMC_LIT4,_OMC_LIT5,_OMC_LIT96}};
#define _OMC_LIT97 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT97)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT98,1,3) {&Absyn_MatchType_MATCH__desc,}};
#define _OMC_LIT98 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT98)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT99,1,4) {&Absyn_MatchType_MATCHCONTINUE__desc,}};
#define _OMC_LIT99 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT99)
#define _OMC_LIT100_data "Last pattern is empty"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT100,21,_OMC_LIT100_data);
#define _OMC_LIT100 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT100)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT101,2,1) {_OMC_LIT100,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT101 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT101)
#define _OMC_LIT102_data "patternmDeadCodeElimination"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT102,27,_OMC_LIT102_data);
#define _OMC_LIT102 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT102)
#define _OMC_LIT103_data "Performs dead code elimination in match-expressions."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT103,52,_OMC_LIT103_data);
#define _OMC_LIT103 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT103)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT104,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT103}};
#define _OMC_LIT104 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT104)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT105,5,3) {&Flags_DebugFlag_DEBUG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(23)),_OMC_LIT102,MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),_OMC_LIT104}};
#define _OMC_LIT105 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT105)
#define _OMC_LIT106_data "Empty matchcontinue case"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT106,24,_OMC_LIT106_data);
#define _OMC_LIT106 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT106)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT107,2,1) {_OMC_LIT106,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT107 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT107)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT108,2,4) {&Absyn_Path_IDENT__desc,_OMC_LIT36}};
#define _OMC_LIT108 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT108)
#define _OMC_LIT109_data "Unused local variable: %s."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT109,26,_OMC_LIT109_data);
#define _OMC_LIT109 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT109)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT110,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT109}};
#define _OMC_LIT110 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT110)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT111,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5027)),_OMC_LIT4,_OMC_LIT5,_OMC_LIT110}};
#define _OMC_LIT111 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT111)
#define _OMC_LIT112_data "Patternm.traversePattern failed: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT112,33,_OMC_LIT112_data);
#define _OMC_LIT112 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT112)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT113,1,3) {&DAE_Pattern_PAT__WILD__desc,}};
#define _OMC_LIT113 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT113)
#define _OMC_LIT114_data "Removing unused as-binding: %s."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT114,31,_OMC_LIT114_data);
#define _OMC_LIT114 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT114)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT115,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT114}};
#define _OMC_LIT115 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT115)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT116,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5028)),_OMC_LIT4,_OMC_LIT5,_OMC_LIT115}};
#define _OMC_LIT116 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT116)
#define _OMC_LIT117_data "Removing unused assignment to: %s."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT117,34,_OMC_LIT117_data);
#define _OMC_LIT117 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT117)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT118,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT117}};
#define _OMC_LIT118 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT118)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT119,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5034)),_OMC_LIT4,_OMC_LIT5,_OMC_LIT118}};
#define _OMC_LIT119 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT119)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT120,2,5) {&DAE_Type_T__STRING__desc,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT120 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT120)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT121,1,11) {&DAE_Type_T__UNKNOWN__desc,}};
#define _OMC_LIT121 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT121)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT122,2,28) {&DAE_Type_T__METATYPE__desc,_OMC_LIT121}};
#define _OMC_LIT122 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT122)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT123,2,3) {&DAE_Type_T__INTEGER__desc,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT123 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT123)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT124,1,3) {&DAE_MatchType_MATCHCONTINUE__desc,}};
#define _OMC_LIT124 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT124)
#define _OMC_LIT125_data "Converted match expression to switch of type %s."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT125,48,_OMC_LIT125_data);
#define _OMC_LIT125 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT125)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT126,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT125}};
#define _OMC_LIT126 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT126)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT127,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5029)),_OMC_LIT4,_OMC_LIT5,_OMC_LIT126}};
#define _OMC_LIT127 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT127)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT128,2,5) {&DAE_MatchType_MATCH__desc,MMC_REFSTRUCTLIT(mmc_none)}};
#define _OMC_LIT128 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT128)
#define _OMC_LIT129_data "Match input %s is a constant value."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT129,35,_OMC_LIT129_data);
#define _OMC_LIT129 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT129)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT130,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT129}};
#define _OMC_LIT130 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT130)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT131,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5047)),_OMC_LIT4,_OMC_LIT5,_OMC_LIT130}};
#define _OMC_LIT131 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT131)
#define _OMC_LIT132_data "$match scope$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT132,13,_OMC_LIT132_data);
#define _OMC_LIT132 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT132)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT133,1,5) {&DAE_Const_C__VAR__desc,}};
#define _OMC_LIT133 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT133)
#define _OMC_LIT134_data "patternmSkipFilterUnusedBindings"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT134,32,_OMC_LIT134_data);
#define _OMC_LIT134 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT134)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT135,2,4) {&Gettext_TranslatableContent_notrans__desc,_OMC_LIT36}};
#define _OMC_LIT135 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT135)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT136,5,3) {&Flags_DebugFlag_DEBUG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(21)),_OMC_LIT134,MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),_OMC_LIT135}};
#define _OMC_LIT136 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT136)
#define _OMC_LIT137_data "Failed to elaborate match expression %s"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT137,39,_OMC_LIT137_data);
#define _OMC_LIT137 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT137)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT138,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT137}};
#define _OMC_LIT138 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT138)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT139,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5014)),_OMC_LIT4,_OMC_LIT40,_OMC_LIT138}};
#define _OMC_LIT139 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT139)
#define _OMC_LIT140_data "_"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT140,1,_OMC_LIT140_data);
#define _OMC_LIT140 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT140)
#define _OMC_LIT141_data "SOME("
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT141,5,_OMC_LIT141_data);
#define _OMC_LIT141 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT141)
#define _OMC_LIT142_data ")"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT142,1,_OMC_LIT142_data);
#define _OMC_LIT142 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT142)
#define _OMC_LIT143_data ","
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT143,1,_OMC_LIT143_data);
#define _OMC_LIT143 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT143)
#define _OMC_LIT144_data "("
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT144,1,_OMC_LIT144_data);
#define _OMC_LIT144 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT144)
#define _OMC_LIT145_data "."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT145,1,_OMC_LIT145_data);
#define _OMC_LIT145 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT145)
#define _OMC_LIT146_data "="
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT146,1,_OMC_LIT146_data);
#define _OMC_LIT146 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT146)
#define _OMC_LIT147_data "::"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT147,2,_OMC_LIT147_data);
#define _OMC_LIT147 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT147)
#define _OMC_LIT148_data " as "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT148,4,_OMC_LIT148_data);
#define _OMC_LIT148 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT148)
#define _OMC_LIT149_data "Patternm.patternStr not implemented correctly"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT149,45,_OMC_LIT149_data);
#define _OMC_LIT149 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT149)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT150,2,1) {_OMC_LIT149,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT150 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT150)
#define _OMC_LIT151_data "*PATTERN*"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT151,9,_OMC_LIT151_data);
#define _OMC_LIT151 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT151)
#define _OMC_LIT152_data "In pattern %s: %s is not part of uniontype %s"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT152,45,_OMC_LIT152_data);
#define _OMC_LIT152 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT152)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT153,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT152}};
#define _OMC_LIT153 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT153)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT154,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5021)),_OMC_LIT4,_OMC_LIT40,_OMC_LIT153}};
#define _OMC_LIT154 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT154)
#define _OMC_LIT155_data "#DUMMY#"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT155,7,_OMC_LIT155_data);
#define _OMC_LIT155 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT155)
#define _OMC_LIT156_data "Type mismatch in pattern %s\nexpression type:\n  %s\npattern type:\n  %s"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT156,68,_OMC_LIT156_data);
#define _OMC_LIT156 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT156)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT157,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT156}};
#define _OMC_LIT157 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT157)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT158,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5022)),_OMC_LIT4,_OMC_LIT40,_OMC_LIT157}};
#define _OMC_LIT158 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT158)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT159,1,5) {&ErrorTypes_Severity_WARNING__desc,}};
#define _OMC_LIT159 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT159)
#define _OMC_LIT160_data "Call to %s contains mixed positional and named arguments."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT160,57,_OMC_LIT160_data);
#define _OMC_LIT160 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT160)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT161,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT160}};
#define _OMC_LIT161 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT161)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT162,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(598)),_OMC_LIT4,_OMC_LIT159,_OMC_LIT161}};
#define _OMC_LIT162 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT162)
#define _OMC_LIT163_data "Removing empty call named pattern argument: %s."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT163,47,_OMC_LIT163_data);
#define _OMC_LIT163 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT163)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT164,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT163}};
#define _OMC_LIT164 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT164)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT165,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5035)),_OMC_LIT4,_OMC_LIT5,_OMC_LIT164}};
#define _OMC_LIT165 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT165)
#define _OMC_LIT166_data "All patterns in call were empty: %s."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT166,36,_OMC_LIT166_data);
#define _OMC_LIT166 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT166)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT167,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT166}};
#define _OMC_LIT167 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT167)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT168,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5036)),_OMC_LIT4,_OMC_LIT5,_OMC_LIT167}};
#define _OMC_LIT168 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT168)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT169,1,3) {&Util_Status_SUCCESS__desc,}};
#define _OMC_LIT169 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT169)
#define _OMC_LIT170_data "Call pattern is not a record constructor %s"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT170,43,_OMC_LIT170_data);
#define _OMC_LIT170 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT170)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT171,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT170}};
#define _OMC_LIT171 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT171)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT172,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5023)),_OMC_LIT4,_OMC_LIT40,_OMC_LIT171}};
#define _OMC_LIT172 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT172)
#define _OMC_LIT173_data "pattern "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT173,8,_OMC_LIT173_data);
#define _OMC_LIT173 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT173)
#define _OMC_LIT174_data "Wrong number of arguments to %s."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT174,32,_OMC_LIT174_data);
#define _OMC_LIT174 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT174)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT175,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT174}};
#define _OMC_LIT175 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT175)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT176,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(146)),_OMC_LIT4,_OMC_LIT40,_OMC_LIT175}};
#define _OMC_LIT176 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT176)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT177,2,4) {&DAE_Type_T__REAL__desc,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT177 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT177)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT178,2,20) {&DAE_Type_T__METALIST__desc,_OMC_LIT121}};
#define _OMC_LIT178 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT178)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT179,2,31) {&DAE_Exp_LIST__desc,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT179 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT179)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT180,2,16) {&Absyn_Exp_ARRAY__desc,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT180 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT180)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT181,2,22) {&DAE_Type_T__METAOPTION__desc,_OMC_LIT121}};
#define _OMC_LIT181 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT181)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT182,2,34) {&DAE_Exp_META__OPTION__desc,MMC_REFSTRUCTLIT(mmc_none)}};
#define _OMC_LIT182 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT182)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT183,3,4) {&DAE_Pattern_PAT__CONSTANT__desc,MMC_REFSTRUCTLIT(mmc_none),_OMC_LIT182}};
#define _OMC_LIT183 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT183)
#define _OMC_LIT184_data "Identifiers need to point to local or output variables. Variable %s is %s."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT184,74,_OMC_LIT184_data);
#define _OMC_LIT184 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT184)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT185,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT184}};
#define _OMC_LIT185 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT185)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT186,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5038)),_OMC_LIT4,_OMC_LIT40,_OMC_LIT185}};
#define _OMC_LIT186 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT186)
#define _OMC_LIT187_data "Variable %s not found in scope %s."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT187,34,_OMC_LIT187_data);
#define _OMC_LIT187 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT187)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT188,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT187}};
#define _OMC_LIT188 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT188)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT189,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5)),_OMC_LIT4,_OMC_LIT40,_OMC_LIT188}};
#define _OMC_LIT189 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT189)
#define _OMC_LIT190_data "NONE"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT190,4,_OMC_LIT190_data);
#define _OMC_LIT190 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT190)
#define _OMC_LIT191_data "NONE is not acceptable syntax. Use NONE() instead."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT191,50,_OMC_LIT191_data);
#define _OMC_LIT191 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT191)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT192,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT191}};
#define _OMC_LIT192 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT192)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT193,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5017)),_OMC_LIT4,_OMC_LIT40,_OMC_LIT192}};
#define _OMC_LIT193 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT193)
#define _OMC_LIT194_data " of type "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT194,9,_OMC_LIT194_data);
#define _OMC_LIT194 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT194)
#define _OMC_LIT195_data "Invalid pattern: %s"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT195,19,_OMC_LIT195_data);
#define _OMC_LIT195 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT195)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT196,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT195}};
#define _OMC_LIT196 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT196)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT197,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5012)),_OMC_LIT4,_OMC_LIT40,_OMC_LIT196}};
#define _OMC_LIT197 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT197)
#define _OMC_LIT198_data "SOME"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT198,4,_OMC_LIT198_data);
#define _OMC_LIT198 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT198)
#define _OMC_LIT199_data "The same variable is being defined twice: %s."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT199,45,_OMC_LIT199_data);
#define _OMC_LIT199 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT199)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT200,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT199}};
#define _OMC_LIT200 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT200)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT201,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5037)),_OMC_LIT4,_OMC_LIT40,_OMC_LIT200}};
#define _OMC_LIT201 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT201)
#define _OMC_LIT202_data "Invalid named fields: %s. Valid field names: %s."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT202,48,_OMC_LIT202_data);
#define _OMC_LIT202 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT202)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT203,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT202}};
#define _OMC_LIT203 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT203)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT204,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(5018)),_OMC_LIT4,_OMC_LIT40,_OMC_LIT203}};
#define _OMC_LIT204 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT204)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT205,1,4) {&Util_Status_FAILURE__desc,}};
#define _OMC_LIT205 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT205)
#include "util/modelica.h"
#include "Patternm_includes.h"
#if !defined(PROTECTED_FUNCTION_STATIC)
#define PROTECTED_FUNCTION_STATIC
#endif
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_convertExpToPatterns(threadData_t *threadData, modelica_metatype _inExp);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_convertExpToPatterns,2,0) {(void*) boxptr_Patternm_convertExpToPatterns,0}};
#define boxvar_Patternm_convertExpToPatterns MMC_REFSTRUCTLIT(boxvar_lit_Patternm_convertExpToPatterns)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_makeTupleFromMetaTuple(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _inType, modelica_metatype *out_ty);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_makeTupleFromMetaTuple,2,0) {(void*) boxptr_Patternm_makeTupleFromMetaTuple,0}};
#define boxvar_Patternm_makeTupleFromMetaTuple MMC_REFSTRUCTLIT(boxvar_lit_Patternm_makeTupleFromMetaTuple)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_isNotDummyStatement(threadData_t *threadData, modelica_metatype _statement);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_isNotDummyStatement(threadData_t *threadData, modelica_metatype _statement);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_isNotDummyStatement,2,0) {(void*) boxptr_Patternm_isNotDummyStatement,0}};
#define boxvar_Patternm_isNotDummyStatement MMC_REFSTRUCTLIT(boxvar_lit_Patternm_isNotDummyStatement)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elseFindDeadStore(threadData_t *threadData, modelica_metatype _inElse, modelica_metatype _localsTree, modelica_metatype _inUseTree, modelica_metatype *out_useTree);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_elseFindDeadStore,2,0) {(void*) boxptr_Patternm_elseFindDeadStore,0}};
#define boxvar_Patternm_elseFindDeadStore MMC_REFSTRUCTLIT(boxvar_lit_Patternm_elseFindDeadStore)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_statementFindDeadStore(threadData_t *threadData, modelica_metatype _inStatement, modelica_metatype _localsTree, modelica_metatype _inUseTree, modelica_metatype *out_useTree);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_statementFindDeadStore,2,0) {(void*) boxptr_Patternm_statementFindDeadStore,0}};
#define boxvar_Patternm_statementFindDeadStore MMC_REFSTRUCTLIT(boxvar_lit_Patternm_statementFindDeadStore)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_statementListFindDeadStoreRemoveEmptyStatements(threadData_t *threadData, modelica_metatype _inBody, modelica_metatype _localsTree, modelica_metatype _inUseTree, modelica_metatype *out_useTree);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_statementListFindDeadStoreRemoveEmptyStatements,2,0) {(void*) boxptr_Patternm_statementListFindDeadStoreRemoveEmptyStatements,0}};
#define boxvar_Patternm_statementListFindDeadStoreRemoveEmptyStatements MMC_REFSTRUCTLIT(boxvar_lit_Patternm_statementListFindDeadStoreRemoveEmptyStatements)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addAliasesToEnv(threadData_t *threadData, modelica_metatype _inEnv, modelica_metatype _inTypes, modelica_metatype _inAliases, modelica_metatype _info);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_addAliasesToEnv,2,0) {(void*) boxptr_Patternm_addAliasesToEnv,0}};
#define boxvar_Patternm_addAliasesToEnv MMC_REFSTRUCTLIT(boxvar_lit_Patternm_addAliasesToEnv)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addPatternAliases(threadData_t *threadData, modelica_metatype _inPattern, modelica_metatype _inAliases, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype *out_outCache);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_addPatternAliases,2,0) {(void*) boxptr_Patternm_addPatternAliases,0}};
#define boxvar_Patternm_addPatternAliases MMC_REFSTRUCTLIT(boxvar_lit_Patternm_addPatternAliases)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addPatternAliasesList(threadData_t *threadData, modelica_metatype _inPatterns, modelica_metatype _inAliases, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype *out_outCache);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_addPatternAliasesList,2,0) {(void*) boxptr_Patternm_addPatternAliasesList,0}};
#define boxvar_Patternm_addPatternAliasesList MMC_REFSTRUCTLIT(boxvar_lit_Patternm_addPatternAliasesList)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_getInputAsBinding(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype *out_aliases, modelica_metatype *out_aliasesAndCrefs);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_getInputAsBinding,2,0) {(void*) boxptr_Patternm_getInputAsBinding,0}};
#define boxvar_Patternm_getInputAsBinding MMC_REFSTRUCTLIT(boxvar_lit_Patternm_getInputAsBinding)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_findFirstNonAsPattern(threadData_t *threadData, modelica_metatype _inPattern);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_findFirstNonAsPattern,2,0) {(void*) boxptr_Patternm_findFirstNonAsPattern,0}};
#define boxvar_Patternm_findFirstNonAsPattern MMC_REFSTRUCTLIT(boxvar_lit_Patternm_findFirstNonAsPattern)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addEnvKnownAsBindings2(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _inEnv, modelica_metatype _firstPattern);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_addEnvKnownAsBindings2,2,0) {(void*) boxptr_Patternm_addEnvKnownAsBindings2,0}};
#define boxvar_Patternm_addEnvKnownAsBindings2 MMC_REFSTRUCTLIT(boxvar_lit_Patternm_addEnvKnownAsBindings2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addEnvKnownAsBindings(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _inEnv, modelica_metatype *out_env);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_addEnvKnownAsBindings,2,0) {(void*) boxptr_Patternm_addEnvKnownAsBindings,0}};
#define boxvar_Patternm_addEnvKnownAsBindings MMC_REFSTRUCTLIT(boxvar_lit_Patternm_addEnvKnownAsBindings)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_constantComplexity(threadData_t *threadData, modelica_metatype _inExp, modelica_integer _ii, modelica_integer *out_oi);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_constantComplexity(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _ii, modelica_metatype *out_oi);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_constantComplexity,2,0) {(void*) boxptr_Patternm_constantComplexity,0}};
#define boxvar_Patternm_constantComplexity MMC_REFSTRUCTLIT(boxvar_lit_Patternm_constantComplexity)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_patternComplexity(threadData_t *threadData, modelica_metatype _inPat, modelica_integer _inComplexity, modelica_integer *out_i);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_patternComplexity(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _inComplexity, modelica_metatype *out_i);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_patternComplexity,2,0) {(void*) boxptr_Patternm_patternComplexity,0}};
#define boxvar_Patternm_patternComplexity MMC_REFSTRUCTLIT(boxvar_lit_Patternm_patternComplexity)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_sortPatternsByComplexityWork(threadData_t *threadData, modelica_metatype _tpl1, modelica_metatype _tpl2);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_sortPatternsByComplexityWork(threadData_t *threadData, modelica_metatype _tpl1, modelica_metatype _tpl2);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_sortPatternsByComplexityWork,2,0) {(void*) boxptr_Patternm_sortPatternsByComplexityWork,0}};
#define boxvar_Patternm_sortPatternsByComplexityWork MMC_REFSTRUCTLIT(boxvar_lit_Patternm_sortPatternsByComplexityWork)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_setCasePatterns(threadData_t *threadData, modelica_metatype _case1, modelica_metatype _pats);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_setCasePatterns,2,0) {(void*) boxptr_Patternm_setCasePatterns,0}};
#define boxvar_Patternm_setCasePatterns MMC_REFSTRUCTLIT(boxvar_lit_Patternm_setCasePatterns)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_getCasePatterns(threadData_t *threadData, modelica_metatype _case_);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_getCasePatterns,2,0) {(void*) boxptr_Patternm_getCasePatterns,0}};
#define boxvar_Patternm_getCasePatterns MMC_REFSTRUCTLIT(boxvar_lit_Patternm_getCasePatterns)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_allPatternsAlwaysMatch(threadData_t *threadData, modelica_metatype _ipats);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_allPatternsAlwaysMatch(threadData_t *threadData, modelica_metatype _ipats);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_allPatternsAlwaysMatch,2,0) {(void*) boxptr_Patternm_allPatternsAlwaysMatch,0}};
#define boxvar_Patternm_allPatternsAlwaysMatch MMC_REFSTRUCTLIT(boxvar_lit_Patternm_allPatternsAlwaysMatch)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_allPatternsWild(threadData_t *threadData, modelica_metatype _ipats);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_allPatternsWild(threadData_t *threadData, modelica_metatype _ipats);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_allPatternsWild,2,0) {(void*) boxptr_Patternm_allPatternsWild,0}};
#define boxvar_Patternm_allPatternsWild MMC_REFSTRUCTLIT(boxvar_lit_Patternm_allPatternsWild)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_checkLocalShadowing(threadData_t *threadData, modelica_metatype _elt, modelica_metatype _env, modelica_metatype _inTpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_checkLocalShadowing,2,0) {(void*) boxptr_Patternm_checkLocalShadowing,0}};
#define boxvar_Patternm_checkLocalShadowing MMC_REFSTRUCTLIT(boxvar_lit_Patternm_checkLocalShadowing)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addLocalDecls(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _els, modelica_string _scopeName, modelica_boolean _impl, modelica_metatype _info, modelica_metatype *out_res);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_addLocalDecls(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _els, modelica_metatype _scopeName, modelica_metatype _impl, modelica_metatype _info, modelica_metatype *out_res);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_addLocalDecls,2,0) {(void*) boxptr_Patternm_addLocalDecls,0}};
#define boxvar_Patternm_addLocalDecls MMC_REFSTRUCTLIT(boxvar_lit_Patternm_addLocalDecls)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_filterEmptyPattern(threadData_t *threadData, modelica_metatype _tpl);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_filterEmptyPattern(threadData_t *threadData, modelica_metatype _tpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_filterEmptyPattern,2,0) {(void*) boxptr_Patternm_filterEmptyPattern,0}};
#define boxvar_Patternm_filterEmptyPattern MMC_REFSTRUCTLIT(boxvar_lit_Patternm_filterEmptyPattern)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_fixCaseReturnTypes(threadData_t *threadData, modelica_metatype _icases, modelica_metatype _iexps, modelica_metatype _itys, modelica_metatype _info, modelica_metatype *out_ty);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_fixCaseReturnTypes,2,0) {(void*) boxptr_Patternm_fixCaseReturnTypes,0}};
#define boxvar_Patternm_fixCaseReturnTypes MMC_REFSTRUCTLIT(boxvar_lit_Patternm_fixCaseReturnTypes)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabResultExp2(threadData_t *threadData, modelica_boolean _skipPhase, modelica_metatype _body, modelica_metatype _elabExp, modelica_metatype _info, modelica_metatype *out_outExp, modelica_metatype *out_outInfo);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_elabResultExp2(threadData_t *threadData, modelica_metatype _skipPhase, modelica_metatype _body, modelica_metatype _elabExp, modelica_metatype _info, modelica_metatype *out_outExp, modelica_metatype *out_outInfo);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_elabResultExp2,2,0) {(void*) boxptr_Patternm_elabResultExp2,0}};
#define boxvar_Patternm_elabResultExp2 MMC_REFSTRUCTLIT(boxvar_lit_Patternm_elabResultExp2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabPatternGuard(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _patternGuard, modelica_boolean _impl, modelica_boolean _performVectorization, modelica_metatype _pre, modelica_metatype _inInfo, modelica_metatype *out_outPatternGuard);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_elabPatternGuard(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _patternGuard, modelica_metatype _impl, modelica_metatype _performVectorization, modelica_metatype _pre, modelica_metatype _inInfo, modelica_metatype *out_outPatternGuard);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_elabPatternGuard,2,0) {(void*) boxptr_Patternm_elabPatternGuard,0}};
#define boxvar_Patternm_elabPatternGuard MMC_REFSTRUCTLIT(boxvar_lit_Patternm_elabPatternGuard)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabResultExp(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _inBody, modelica_metatype _exp, modelica_boolean _impl, modelica_boolean _performVectorization, modelica_metatype _pre, modelica_metatype _inInfo, modelica_metatype *out_outBody, modelica_metatype *out_resExp, modelica_metatype *out_resultInfo, modelica_metatype *out_resType);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_elabResultExp(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _inBody, modelica_metatype _exp, modelica_metatype _impl, modelica_metatype _performVectorization, modelica_metatype _pre, modelica_metatype _inInfo, modelica_metatype *out_outBody, modelica_metatype *out_resExp, modelica_metatype *out_resultInfo, modelica_metatype *out_resType);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_elabResultExp,2,0) {(void*) boxptr_Patternm_elabResultExp,0}};
#define boxvar_Patternm_elabResultExp MMC_REFSTRUCTLIT(boxvar_lit_Patternm_elabResultExp)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabMatchCase(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _acase, modelica_metatype _tys, modelica_metatype _inputAliases, modelica_metatype _matchExpLocalTree, modelica_boolean _impl, modelica_boolean _performVectorization, modelica_metatype _pre, modelica_metatype *out_elabCase, modelica_metatype *out_resExp, modelica_metatype *out_resType);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_elabMatchCase(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _acase, modelica_metatype _tys, modelica_metatype _inputAliases, modelica_metatype _matchExpLocalTree, modelica_metatype _impl, modelica_metatype _performVectorization, modelica_metatype _pre, modelica_metatype *out_elabCase, modelica_metatype *out_resExp, modelica_metatype *out_resType);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_elabMatchCase,2,0) {(void*) boxptr_Patternm_elabMatchCase,0}};
#define boxvar_Patternm_elabMatchCase MMC_REFSTRUCTLIT(boxvar_lit_Patternm_elabMatchCase)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabMatchCases2(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _cases, modelica_metatype _tys, modelica_metatype _inputAliases, modelica_metatype _matchExpLocalTree, modelica_boolean _impl, modelica_boolean _performVectorization, modelica_metatype _pre, modelica_metatype _inAccCases, modelica_metatype _inAccExps, modelica_metatype _inAccTypes, modelica_metatype *out_elabCases, modelica_metatype *out_resExps, modelica_metatype *out_resTypes);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_elabMatchCases2(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _cases, modelica_metatype _tys, modelica_metatype _inputAliases, modelica_metatype _matchExpLocalTree, modelica_metatype _impl, modelica_metatype _performVectorization, modelica_metatype _pre, modelica_metatype _inAccCases, modelica_metatype _inAccExps, modelica_metatype _inAccTypes, modelica_metatype *out_elabCases, modelica_metatype *out_resExps, modelica_metatype *out_resTypes);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_elabMatchCases2,2,0) {(void*) boxptr_Patternm_elabMatchCases2,0}};
#define boxvar_Patternm_elabMatchCases2 MMC_REFSTRUCTLIT(boxvar_lit_Patternm_elabMatchCases2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabMatchCases(threadData_t *threadData, modelica_metatype _cache, modelica_metatype _env, modelica_metatype _cases, modelica_metatype _tys, modelica_metatype _inputAliases, modelica_metatype _matchExpLocalTree, modelica_boolean _impl, modelica_boolean _performVectorization, modelica_metatype _pre, modelica_metatype _info, modelica_metatype *out_elabCases, modelica_metatype *out_resType);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_elabMatchCases(threadData_t *threadData, modelica_metatype _cache, modelica_metatype _env, modelica_metatype _cases, modelica_metatype _tys, modelica_metatype _inputAliases, modelica_metatype _matchExpLocalTree, modelica_metatype _impl, modelica_metatype _performVectorization, modelica_metatype _pre, modelica_metatype _info, modelica_metatype *out_elabCases, modelica_metatype *out_resType);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_elabMatchCases,2,0) {(void*) boxptr_Patternm_elabMatchCases,0}};
#define boxvar_Patternm_elabMatchCases MMC_REFSTRUCTLIT(boxvar_lit_Patternm_elabMatchCases)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_patternsDoNotOverlap(threadData_t *threadData, modelica_metatype _ip1, modelica_metatype _ip2);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_patternsDoNotOverlap(threadData_t *threadData, modelica_metatype _ip1, modelica_metatype _ip2);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_patternsDoNotOverlap,2,0) {(void*) boxptr_Patternm_patternsDoNotOverlap,0}};
#define boxvar_Patternm_patternsDoNotOverlap MMC_REFSTRUCTLIT(boxvar_lit_Patternm_patternsDoNotOverlap)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_patternListsDoNotOverlap(threadData_t *threadData, modelica_metatype _ips1, modelica_metatype _ips2);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_patternListsDoNotOverlap(threadData_t *threadData, modelica_metatype _ips1, modelica_metatype _ips2);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_patternListsDoNotOverlap,2,0) {(void*) boxptr_Patternm_patternListsDoNotOverlap,0}};
#define boxvar_Patternm_patternListsDoNotOverlap MMC_REFSTRUCTLIT(boxvar_lit_Patternm_patternListsDoNotOverlap)
PROTECTED_FUNCTION_STATIC void omc_Patternm_assertAllPatternListsDoNotOverlap(threadData_t *threadData, modelica_metatype _ipss1, modelica_metatype _ps2);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_assertAllPatternListsDoNotOverlap,2,0) {(void*) boxptr_Patternm_assertAllPatternListsDoNotOverlap,0}};
#define boxvar_Patternm_assertAllPatternListsDoNotOverlap MMC_REFSTRUCTLIT(boxvar_lit_Patternm_assertAllPatternListsDoNotOverlap)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_optimizeContinueToMatch2(threadData_t *threadData, modelica_metatype _icases, modelica_metatype _prevPatterns, modelica_metatype _info);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_optimizeContinueToMatch2,2,0) {(void*) boxptr_Patternm_optimizeContinueToMatch2,0}};
#define boxvar_Patternm_optimizeContinueToMatch2 MMC_REFSTRUCTLIT(boxvar_lit_Patternm_optimizeContinueToMatch2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_optimizeContinueToMatch(threadData_t *threadData, modelica_metatype _matchType, modelica_metatype _cases, modelica_metatype _info);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_optimizeContinueToMatch,2,0) {(void*) boxptr_Patternm_optimizeContinueToMatch,0}};
#define boxvar_Patternm_optimizeContinueToMatch MMC_REFSTRUCTLIT(boxvar_lit_Patternm_optimizeContinueToMatch)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_updateMatchCaseJump(threadData_t *threadData, modelica_metatype _case_, modelica_integer _jump);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_updateMatchCaseJump(threadData_t *threadData, modelica_metatype _case_, modelica_metatype _jump);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_updateMatchCaseJump,2,0) {(void*) boxptr_Patternm_updateMatchCaseJump,0}};
#define boxvar_Patternm_updateMatchCaseJump MMC_REFSTRUCTLIT(boxvar_lit_Patternm_updateMatchCaseJump)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_optimizeContinueJump(threadData_t *threadData, modelica_metatype _case_, modelica_metatype _icases, modelica_integer _jump);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_optimizeContinueJump(threadData_t *threadData, modelica_metatype _case_, modelica_metatype _icases, modelica_metatype _jump);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_optimizeContinueJump,2,0) {(void*) boxptr_Patternm_optimizeContinueJump,0}};
#define boxvar_Patternm_optimizeContinueJump MMC_REFSTRUCTLIT(boxvar_lit_Patternm_optimizeContinueJump)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_optimizeContinueJumps2(threadData_t *threadData, modelica_metatype _icases);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_optimizeContinueJumps2,2,0) {(void*) boxptr_Patternm_optimizeContinueJumps2,0}};
#define boxvar_Patternm_optimizeContinueJumps2 MMC_REFSTRUCTLIT(boxvar_lit_Patternm_optimizeContinueJumps2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_optimizeContinueJumps(threadData_t *threadData, modelica_metatype _matchType, modelica_metatype _cases);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_optimizeContinueJumps,2,0) {(void*) boxptr_Patternm_optimizeContinueJumps,0}};
#define boxvar_Patternm_optimizeContinueJumps MMC_REFSTRUCTLIT(boxvar_lit_Patternm_optimizeContinueJumps)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_caseDeadCodeElimination(threadData_t *threadData, modelica_metatype _matchType, modelica_metatype _cases, modelica_metatype _prevPatterns, modelica_metatype _iacc, modelica_boolean _iter);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_caseDeadCodeElimination(threadData_t *threadData, modelica_metatype _matchType, modelica_metatype _cases, modelica_metatype _prevPatterns, modelica_metatype _iacc, modelica_metatype _iter);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_caseDeadCodeElimination,2,0) {(void*) boxptr_Patternm_caseDeadCodeElimination,0}};
#define boxvar_Patternm_caseDeadCodeElimination MMC_REFSTRUCTLIT(boxvar_lit_Patternm_caseDeadCodeElimination)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_filterUnusedDecls(threadData_t *threadData, modelica_metatype _matchDecls, modelica_metatype _ht, modelica_metatype _iacc, modelica_metatype _iunusedHt, modelica_metatype *out_outUnusedHt);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_filterUnusedDecls,2,0) {(void*) boxptr_Patternm_filterUnusedDecls,0}};
#define boxvar_Patternm_filterUnusedDecls MMC_REFSTRUCTLIT(boxvar_lit_Patternm_filterUnusedDecls)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addPatternAsBindings(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _inHt, modelica_metatype *out_ht);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_addPatternAsBindings,2,0) {(void*) boxptr_Patternm_addPatternAsBindings,0}};
#define boxvar_Patternm_addPatternAsBindings MMC_REFSTRUCTLIT(boxvar_lit_Patternm_addPatternAsBindings)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_simplifyPattern(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _extra, modelica_metatype *out_outExtra);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_simplifyPattern,2,0) {(void*) boxptr_Patternm_simplifyPattern,0}};
#define boxvar_Patternm_simplifyPattern MMC_REFSTRUCTLIT(boxvar_lit_Patternm_simplifyPattern)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addCasesLocalCref(threadData_t *threadData, modelica_metatype _icases, modelica_metatype _iht);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_addCasesLocalCref,2,0) {(void*) boxptr_Patternm_addCasesLocalCref,0}};
#define boxvar_Patternm_addCasesLocalCref MMC_REFSTRUCTLIT(boxvar_lit_Patternm_addCasesLocalCref)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_useCasesLocalCref(threadData_t *threadData, modelica_metatype _icases, modelica_metatype _inTree);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_useCasesLocalCref,2,0) {(void*) boxptr_Patternm_useCasesLocalCref,0}};
#define boxvar_Patternm_useCasesLocalCref MMC_REFSTRUCTLIT(boxvar_lit_Patternm_useCasesLocalCref)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_usePatternAsBindings(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _inTree, modelica_metatype *out_outTree);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_usePatternAsBindings,2,0) {(void*) boxptr_Patternm_usePatternAsBindings,0}};
#define boxvar_Patternm_usePatternAsBindings MMC_REFSTRUCTLIT(boxvar_lit_Patternm_usePatternAsBindings)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_useLocalCrefSubs(threadData_t *threadData, modelica_metatype _isubs, modelica_metatype _inTree);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_useLocalCrefSubs,2,0) {(void*) boxptr_Patternm_useLocalCrefSubs,0}};
#define boxvar_Patternm_useLocalCrefSubs MMC_REFSTRUCTLIT(boxvar_lit_Patternm_useLocalCrefSubs)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_useLocalCrefHelper(threadData_t *threadData, modelica_metatype _cr, modelica_metatype _inTree);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_useLocalCrefHelper,2,0) {(void*) boxptr_Patternm_useLocalCrefHelper,0}};
#define boxvar_Patternm_useLocalCrefHelper MMC_REFSTRUCTLIT(boxvar_lit_Patternm_useLocalCrefHelper)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_useLocalCref(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _inTree, modelica_metatype *out_outTree);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_useLocalCref,2,0) {(void*) boxptr_Patternm_useLocalCref,0}};
#define boxvar_Patternm_useLocalCref MMC_REFSTRUCTLIT(boxvar_lit_Patternm_useLocalCref)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_checkDefUsePattern(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _inTpl, modelica_metatype *out_outTpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_checkDefUsePattern,2,0) {(void*) boxptr_Patternm_checkDefUsePattern,0}};
#define boxvar_Patternm_checkDefUsePattern MMC_REFSTRUCTLIT(boxvar_lit_Patternm_checkDefUsePattern)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_checkDefUse(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _inTpl, modelica_metatype *out_outTpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_checkDefUse,2,0) {(void*) boxptr_Patternm_checkDefUse,0}};
#define boxvar_Patternm_checkDefUse MMC_REFSTRUCTLIT(boxvar_lit_Patternm_checkDefUse)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addLocalCrefSubs(threadData_t *threadData, modelica_metatype _isubs, modelica_metatype _iht);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_addLocalCrefSubs,2,0) {(void*) boxptr_Patternm_addLocalCrefSubs,0}};
#define boxvar_Patternm_addLocalCrefSubs MMC_REFSTRUCTLIT(boxvar_lit_Patternm_addLocalCrefSubs)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addLocalCrefHelper(threadData_t *threadData, modelica_metatype _cr, modelica_metatype _iht);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_addLocalCrefHelper,2,0) {(void*) boxptr_Patternm_addLocalCrefHelper,0}};
#define boxvar_Patternm_addLocalCrefHelper MMC_REFSTRUCTLIT(boxvar_lit_Patternm_addLocalCrefHelper)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addLocalCref(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _inHt, modelica_metatype *out_outHt);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_addLocalCref,2,0) {(void*) boxptr_Patternm_addLocalCref,0}};
#define boxvar_Patternm_addLocalCref MMC_REFSTRUCTLIT(boxvar_lit_Patternm_addLocalCref)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_removePatternAsBinding(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _inTpl, modelica_metatype *out_outTpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_removePatternAsBinding,2,0) {(void*) boxptr_Patternm_removePatternAsBinding,0}};
#define boxvar_Patternm_removePatternAsBinding MMC_REFSTRUCTLIT(boxvar_lit_Patternm_removePatternAsBinding)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_filterUnusedAsBindings(threadData_t *threadData, modelica_metatype _inCases, modelica_metatype _ht);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_filterUnusedAsBindings,2,0) {(void*) boxptr_Patternm_filterUnusedAsBindings,0}};
#define boxvar_Patternm_filterUnusedAsBindings MMC_REFSTRUCTLIT(boxvar_lit_Patternm_filterUnusedAsBindings)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_getUsedLocalCrefs(threadData_t *threadData, modelica_boolean _skipFilterUnusedAsBindings, modelica_metatype _exp, modelica_integer _hashSize);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_getUsedLocalCrefs(threadData_t *threadData, modelica_metatype _skipFilterUnusedAsBindings, modelica_metatype _exp, modelica_metatype _hashSize);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_getUsedLocalCrefs,2,0) {(void*) boxptr_Patternm_getUsedLocalCrefs,0}};
#define boxvar_Patternm_getUsedLocalCrefs MMC_REFSTRUCTLIT(boxvar_lit_Patternm_getUsedLocalCrefs)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_filterUnusedPatterns2(threadData_t *threadData, modelica_metatype _inInputs, modelica_metatype _inAliases, modelica_metatype _inPatternMatrix, modelica_boolean _change, modelica_metatype _inputsAcc, modelica_metatype _aliasesAcc, modelica_metatype _patternMatrixAcc, modelica_metatype *out_outInputs, modelica_metatype *out_outAliases, modelica_metatype *out_outPatternMatrix);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_filterUnusedPatterns2(threadData_t *threadData, modelica_metatype _inInputs, modelica_metatype _inAliases, modelica_metatype _inPatternMatrix, modelica_metatype _change, modelica_metatype _inputsAcc, modelica_metatype _aliasesAcc, modelica_metatype _patternMatrixAcc, modelica_metatype *out_outInputs, modelica_metatype *out_outAliases, modelica_metatype *out_outPatternMatrix);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_filterUnusedPatterns2,2,0) {(void*) boxptr_Patternm_filterUnusedPatterns2,0}};
#define boxvar_Patternm_filterUnusedPatterns2 MMC_REFSTRUCTLIT(boxvar_lit_Patternm_filterUnusedPatterns2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_setCasePatternsCheckZero(threadData_t *threadData, modelica_metatype _inCases, modelica_metatype _patternMatrix);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_setCasePatternsCheckZero,2,0) {(void*) boxptr_Patternm_setCasePatternsCheckZero,0}};
#define boxvar_Patternm_setCasePatternsCheckZero MMC_REFSTRUCTLIT(boxvar_lit_Patternm_setCasePatternsCheckZero)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_filterUnusedPatterns(threadData_t *threadData, modelica_metatype _inputs, modelica_metatype _inAliases, modelica_metatype _inCases, modelica_metatype *out_outAliases, modelica_metatype *out_outCases);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_filterUnusedPatterns,2,0) {(void*) boxptr_Patternm_filterUnusedPatterns,0}};
#define boxvar_Patternm_filterUnusedPatterns MMC_REFSTRUCTLIT(boxvar_lit_Patternm_filterUnusedPatterns)
PROTECTED_FUNCTION_STATIC modelica_integer omc_Patternm_findMinMod(threadData_t *threadData, modelica_metatype _inIxs, modelica_integer _inMod);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_findMinMod(threadData_t *threadData, modelica_metatype _inIxs, modelica_metatype _inMod);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_findMinMod,2,0) {(void*) boxptr_Patternm_findMinMod,0}};
#define boxvar_Patternm_findMinMod MMC_REFSTRUCTLIT(boxvar_lit_Patternm_findMinMod)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_findPatternToConvertToSwitch2(threadData_t *threadData, modelica_metatype _ipats, modelica_metatype _ixs, modelica_metatype _ity, modelica_boolean _allSubPatternsMatch, modelica_integer _numPatternsInMatrix, modelica_integer *out_extraarg);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_findPatternToConvertToSwitch2(threadData_t *threadData, modelica_metatype _ipats, modelica_metatype _ixs, modelica_metatype _ity, modelica_metatype _allSubPatternsMatch, modelica_metatype _numPatternsInMatrix, modelica_metatype *out_extraarg);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_findPatternToConvertToSwitch2,2,0) {(void*) boxptr_Patternm_findPatternToConvertToSwitch2,0}};
#define boxvar_Patternm_findPatternToConvertToSwitch2 MMC_REFSTRUCTLIT(boxvar_lit_Patternm_findPatternToConvertToSwitch2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_findPatternToConvertToSwitch(threadData_t *threadData, modelica_metatype _inPatternMatrix, modelica_integer _index, modelica_integer _numPatternsInMatrix, modelica_metatype _info);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_findPatternToConvertToSwitch(threadData_t *threadData, modelica_metatype _inPatternMatrix, modelica_metatype _index, modelica_metatype _numPatternsInMatrix, modelica_metatype _info);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_findPatternToConvertToSwitch,2,0) {(void*) boxptr_Patternm_findPatternToConvertToSwitch,0}};
#define boxvar_Patternm_findPatternToConvertToSwitch MMC_REFSTRUCTLIT(boxvar_lit_Patternm_findPatternToConvertToSwitch)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_removeWildPatternColumnsFromMatrix(threadData_t *threadData, modelica_metatype _inPatternMatrix, modelica_metatype _inAcc, modelica_integer _inNumAcc, modelica_integer *out_numNonEmptyColumns);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_removeWildPatternColumnsFromMatrix(threadData_t *threadData, modelica_metatype _inPatternMatrix, modelica_metatype _inAcc, modelica_metatype _inNumAcc, modelica_metatype *out_numNonEmptyColumns);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_removeWildPatternColumnsFromMatrix,2,0) {(void*) boxptr_Patternm_removeWildPatternColumnsFromMatrix,0}};
#define boxvar_Patternm_removeWildPatternColumnsFromMatrix MMC_REFSTRUCTLIT(boxvar_lit_Patternm_removeWildPatternColumnsFromMatrix)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_optimizeSwitchedMatchCases(threadData_t *threadData, modelica_metatype _inMatchType, modelica_metatype _inCases);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_optimizeSwitchedMatchCases,2,0) {(void*) boxptr_Patternm_optimizeSwitchedMatchCases,0}};
#define boxvar_Patternm_optimizeSwitchedMatchCases MMC_REFSTRUCTLIT(boxvar_lit_Patternm_optimizeSwitchedMatchCases)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_optimizeMatchToSwitch(threadData_t *threadData, modelica_metatype _matchTy, modelica_metatype _cases, modelica_metatype _info, modelica_metatype *out_outCases);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_optimizeMatchToSwitch,2,0) {(void*) boxptr_Patternm_optimizeMatchToSwitch,0}};
#define boxvar_Patternm_optimizeMatchToSwitch MMC_REFSTRUCTLIT(boxvar_lit_Patternm_optimizeMatchToSwitch)
PROTECTED_FUNCTION_STATIC void omc_Patternm_checkConstantMatchInputs(threadData_t *threadData, modelica_metatype _inputs, modelica_metatype _info);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_checkConstantMatchInputs,2,0) {(void*) boxptr_Patternm_checkConstantMatchInputs,0}};
#define boxvar_Patternm_checkConstantMatchInputs MMC_REFSTRUCTLIT(boxvar_lit_Patternm_checkConstantMatchInputs)
PROTECTED_FUNCTION_STATIC void omc_Patternm_validUniontype(threadData_t *threadData, modelica_metatype _path1, modelica_metatype _path2, modelica_metatype _info, modelica_metatype _lhs);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_validUniontype,2,0) {(void*) boxptr_Patternm_validUniontype,0}};
#define boxvar_Patternm_validUniontype MMC_REFSTRUCTLIT(boxvar_lit_Patternm_validUniontype)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_validPatternType(threadData_t *threadData, modelica_metatype _inTy1, modelica_metatype _inTy2, modelica_metatype _lhs, modelica_metatype _info);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_validPatternType,2,0) {(void*) boxptr_Patternm_validPatternType,0}};
#define boxvar_Patternm_validPatternType MMC_REFSTRUCTLIT(boxvar_lit_Patternm_validPatternType)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_checkForAllWildCall(threadData_t *threadData, modelica_metatype _args, modelica_metatype _named, modelica_integer _numFields, modelica_metatype *out_outNamed);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_checkForAllWildCall(threadData_t *threadData, modelica_metatype _args, modelica_metatype _named, modelica_metatype _numFields, modelica_metatype *out_outNamed);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_checkForAllWildCall,2,0) {(void*) boxptr_Patternm_checkForAllWildCall,0}};
#define boxvar_Patternm_checkForAllWildCall MMC_REFSTRUCTLIT(boxvar_lit_Patternm_checkForAllWildCall)
PROTECTED_FUNCTION_STATIC void omc_Patternm_checkMissingArgs(threadData_t *threadData, modelica_metatype _path, modelica_integer _numPosArgs, modelica_metatype _missingFieldNames, modelica_integer _numNamedArgs, modelica_metatype _info);
PROTECTED_FUNCTION_STATIC void boxptr_Patternm_checkMissingArgs(threadData_t *threadData, modelica_metatype _path, modelica_metatype _numPosArgs, modelica_metatype _missingFieldNames, modelica_metatype _numNamedArgs, modelica_metatype _info);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_checkMissingArgs,2,0) {(void*) boxptr_Patternm_checkMissingArgs,0}};
#define boxvar_Patternm_checkMissingArgs MMC_REFSTRUCTLIT(boxvar_lit_Patternm_checkMissingArgs)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabPatternCall(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _env, modelica_metatype _callPath, modelica_metatype _fargs, modelica_metatype _utPath, modelica_metatype _info, modelica_metatype _lhs, modelica_metatype *out_pattern);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_elabPatternCall,2,0) {(void*) boxptr_Patternm_elabPatternCall,0}};
#define boxvar_Patternm_elabPatternCall MMC_REFSTRUCTLIT(boxvar_lit_Patternm_elabPatternCall)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabPatternTuple(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _env, modelica_metatype _inExps, modelica_metatype _inTys, modelica_metatype _info, modelica_metatype _lhs, modelica_metatype *out_patterns);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_elabPatternTuple,2,0) {(void*) boxptr_Patternm_elabPatternTuple,0}};
#define boxvar_Patternm_elabPatternTuple MMC_REFSTRUCTLIT(boxvar_lit_Patternm_elabPatternTuple)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabPattern2(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _env, modelica_metatype _inLhs, modelica_metatype _ty, modelica_metatype _info, modelica_integer _numError, modelica_metatype *out_pattern);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_elabPattern2(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _env, modelica_metatype _inLhs, modelica_metatype _ty, modelica_metatype _info, modelica_metatype _numError, modelica_metatype *out_pattern);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_elabPattern2,2,0) {(void*) boxptr_Patternm_elabPattern2,0}};
#define boxvar_Patternm_elabPattern2 MMC_REFSTRUCTLIT(boxvar_lit_Patternm_elabPattern2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_findBoundVariables(threadData_t *threadData, modelica_metatype _pat, modelica_metatype _boundVars, modelica_metatype *out_outBoundVars);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_findBoundVariables,2,0) {(void*) boxptr_Patternm_findBoundVariables,0}};
#define boxvar_Patternm_findBoundVariables MMC_REFSTRUCTLIT(boxvar_lit_Patternm_findBoundVariables)
PROTECTED_FUNCTION_STATIC void omc_Patternm_checkPatternsDuplicateAsBindings(threadData_t *threadData, modelica_metatype _patterns, modelica_metatype _info);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_checkPatternsDuplicateAsBindings,2,0) {(void*) boxptr_Patternm_checkPatternsDuplicateAsBindings,0}};
#define boxvar_Patternm_checkPatternsDuplicateAsBindings MMC_REFSTRUCTLIT(boxvar_lit_Patternm_checkPatternsDuplicateAsBindings)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabPattern(threadData_t *threadData, modelica_metatype _cache, modelica_metatype _env, modelica_metatype _lhs, modelica_metatype _ty, modelica_metatype _info, modelica_metatype *out_pattern);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_elabPattern,2,0) {(void*) boxptr_Patternm_elabPattern,0}};
#define boxvar_Patternm_elabPattern MMC_REFSTRUCTLIT(boxvar_lit_Patternm_elabPattern)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_checkInvalidPatternNamedArgs(threadData_t *threadData, modelica_metatype _args, modelica_metatype _fieldNameList, modelica_metatype _status, modelica_metatype _info);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_checkInvalidPatternNamedArgs,2,0) {(void*) boxptr_Patternm_checkInvalidPatternNamedArgs,0}};
#define boxvar_Patternm_checkInvalidPatternNamedArgs MMC_REFSTRUCTLIT(boxvar_lit_Patternm_checkInvalidPatternNamedArgs)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_findFieldExpInList(threadData_t *threadData, modelica_string _firstFieldName, modelica_metatype _namedArgList, modelica_metatype *out_outNamedArgList);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_findFieldExpInList,2,0) {(void*) boxptr_Patternm_findFieldExpInList,0}};
#define boxvar_Patternm_findFieldExpInList MMC_REFSTRUCTLIT(boxvar_lit_Patternm_findFieldExpInList)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_generatePositionalArgs(threadData_t *threadData, modelica_metatype _fieldNameList, modelica_metatype _namedArgList, modelica_metatype _accList, modelica_metatype *out_outInvalidNames);
static const MMC_DEFSTRUCTLIT(boxvar_lit_Patternm_generatePositionalArgs,2,0) {(void*) boxptr_Patternm_generatePositionalArgs,0}};
#define boxvar_Patternm_generatePositionalArgs MMC_REFSTRUCTLIT(boxvar_lit_Patternm_generatePositionalArgs)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_convertExpToPatterns(threadData_t *threadData, modelica_metatype _inExp)
{
modelica_metatype _outInputs = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inExp;
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,16,1) == 0) goto tmp2_end;
tmpMeta[0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inExp), 2)));
goto tmp2_done;
}
case 1: {
tmpMeta[1] = mmc_mk_cons(_inExp, MMC_REFSTRUCTLIT(mmc_nil));
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outInputs = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outInputs;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_makeTupleFromMetaTuple(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _inType, modelica_metatype *out_ty)
{
modelica_metatype _exp = NULL;
modelica_metatype _ty = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _inExp;
tmp4_2 = _inType;
{
modelica_metatype _exps = NULL;
modelica_metatype _tys = NULL;
modelica_metatype _tys2 = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,30,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,18,1) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
_exps = tmpMeta[2];
_tys = tmpMeta[3];
_tys2 = omc_List_map(threadData, _tys, boxvar_Types_unboxedType);
_exps = omc_Types_matchTypeTuple(threadData, _exps, _tys, _tys2, 0 ,&_tys2);
tmpMeta[2] = mmc_mk_box2(22, &DAE_Exp_TUPLE__desc, _exps);
tmpMeta[3] = mmc_mk_box3(17, &DAE_Type_T__TUPLE__desc, _tys2, mmc_mk_none());
tmpMeta[0+0] = tmpMeta[2];
tmpMeta[0+1] = tmpMeta[3];
goto tmp3_done;
}
case 1: {
tmpMeta[0+0] = _inExp;
tmpMeta[0+1] = _inType;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_exp = tmpMeta[0+0];
_ty = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_ty) { *out_ty = _ty; }
return _exp;
}
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_isNotDummyStatement(threadData_t *threadData, modelica_metatype _statement)
{
modelica_boolean _b;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_b = omc_Algorithm_isNotDummyStatement(threadData, _statement);
omc_Error_assertionOrAddSourceMessage(threadData, (_b || (!omc_Flags_isSet(threadData, _OMC_LIT3))), _OMC_LIT8, _OMC_LIT10, omc_ElementSource_getElementSourceFileInfo(threadData, omc_Algorithm_getStatementSource(threadData, _statement)));
_return: OMC_LABEL_UNUSED
return _b;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_isNotDummyStatement(threadData_t *threadData, modelica_metatype _statement)
{
modelica_boolean _b;
modelica_metatype out_b;
_b = omc_Patternm_isNotDummyStatement(threadData, _statement);
out_b = mmc_mk_icon(_b);
return out_b;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elseFindDeadStore(threadData_t *threadData, modelica_metatype _inElse, modelica_metatype _localsTree, modelica_metatype _inUseTree, modelica_metatype *out_useTree)
{
modelica_metatype _outElse = NULL;
modelica_metatype _useTree = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inElse;
{
modelica_metatype _exp = NULL;
modelica_metatype _body = NULL;
modelica_metatype _else_ = NULL;
modelica_metatype _elseTree = NULL;
int tmp4;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
case 3: {
tmpMeta[0+0] = _inElse;
tmpMeta[0+1] = _inUseTree;
goto tmp3_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
_exp = tmpMeta[2];
_body = tmpMeta[3];
_else_ = tmpMeta[4];
_body = omc_Patternm_statementListFindDeadStoreRemoveEmptyStatements(threadData, _body, _localsTree, _inUseTree ,&_useTree);
omc_Expression_traverseExpBottomUp(threadData, _exp, boxvar_Patternm_useLocalCref, _useTree ,&_useTree);
_else_ = omc_Patternm_elseFindDeadStore(threadData, _else_, _localsTree, _inUseTree ,&_elseTree);
_useTree = omc_AvlSetString_join(threadData, _useTree, _elseTree);
tmpMeta[2] = mmc_mk_box4(4, &DAE_Else_ELSEIF__desc, _exp, _body, _else_);
_else_ = tmpMeta[2];
tmpMeta[0+0] = _else_;
tmpMeta[0+1] = _useTree;
goto tmp3_done;
}
case 5: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_body = tmpMeta[2];
_body = omc_Patternm_statementListFindDeadStoreRemoveEmptyStatements(threadData, _body, _localsTree, _inUseTree ,&_useTree);
tmpMeta[2] = mmc_mk_box2(5, &DAE_Else_ELSE__desc, _body);
_else_ = tmpMeta[2];
tmpMeta[0+0] = _else_;
tmpMeta[0+1] = _useTree;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outElse = tmpMeta[0+0];
_useTree = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_useTree) { *out_useTree = _useTree; }
return _outElse;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_statementFindDeadStore(threadData_t *threadData, modelica_metatype _inStatement, modelica_metatype _localsTree, modelica_metatype _inUseTree, modelica_metatype *out_useTree)
{
modelica_metatype _outStatement = NULL;
modelica_metatype _useTree = NULL;
modelica_metatype tmpMeta[9] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inStatement;
{
modelica_metatype _elseTree = NULL;
modelica_metatype _body = NULL;
modelica_metatype _exp = NULL;
modelica_metatype _lhs = NULL;
modelica_metatype _cond = NULL;
modelica_metatype _msg = NULL;
modelica_metatype _level = NULL;
modelica_metatype _exps = NULL;
modelica_metatype _else_ = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _info = NULL;
modelica_boolean _b;
modelica_string _id = NULL;
modelica_integer _index;
modelica_metatype _source = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 18; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[5]), 2));
_ty = tmpMeta[2];
_lhs = tmpMeta[3];
_exp = tmpMeta[4];
_source = tmpMeta[5];
_info = tmpMeta[6];
omc_Expression_traverseExpBottomUp(threadData, _exp, boxvar_Patternm_useLocalCref, _inUseTree ,&_useTree);
tmpMeta[2] = mmc_mk_box3(0, _localsTree, _useTree, _info);
_lhs = omc_Expression_traverseExpBottomUp(threadData, _lhs, boxvar_Patternm_checkDefUse, tmpMeta[2], NULL);
_outStatement = omc_Algorithm_makeAssignmentNoTypeCheck(threadData, _ty, _lhs, _exp, _source);
tmpMeta[0+0] = _outStatement;
tmpMeta[0+1] = _useTree;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,4) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[5]), 2));
_ty = tmpMeta[2];
_exps = tmpMeta[3];
_exp = tmpMeta[4];
_source = tmpMeta[5];
_info = tmpMeta[6];
omc_Expression_traverseExpBottomUp(threadData, _exp, boxvar_Patternm_useLocalCref, _inUseTree ,&_useTree);
tmpMeta[2] = mmc_mk_box2(22, &DAE_Exp_TUPLE__desc, _exps);
tmpMeta[3] = mmc_mk_box3(0, _localsTree, _useTree, _info);
tmpMeta[4] = omc_Expression_traverseExpBottomUp(threadData, tmpMeta[2], boxvar_Patternm_checkDefUse, tmpMeta[3], NULL);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[4],19,1) == 0) goto goto_2;
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 2));
_exps = tmpMeta[5];
_outStatement = omc_Algorithm_makeTupleAssignmentNoTypeCheck(threadData, _ty, _exps, _exp, _source);
tmpMeta[0+0] = _outStatement;
tmpMeta[0+1] = _useTree;
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,4) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[5]), 2));
_ty = tmpMeta[2];
_lhs = tmpMeta[3];
_exp = tmpMeta[4];
_source = tmpMeta[5];
_info = tmpMeta[6];
omc_Expression_traverseExpBottomUp(threadData, _exp, boxvar_Patternm_useLocalCref, _inUseTree ,&_useTree);
tmpMeta[2] = mmc_mk_box3(0, _localsTree, _useTree, _info);
_lhs = omc_Expression_traverseExpBottomUp(threadData, _lhs, boxvar_Patternm_checkDefUse, tmpMeta[2], NULL);
_outStatement = omc_Algorithm_makeArrayAssignmentNoTypeCheck(threadData, _ty, _lhs, _exp, _source);
tmpMeta[0+0] = _outStatement;
tmpMeta[0+1] = _useTree;
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,4) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_exp = tmpMeta[2];
_body = tmpMeta[3];
_else_ = tmpMeta[4];
_source = tmpMeta[5];
_else_ = omc_Patternm_elseFindDeadStore(threadData, _else_, _localsTree, _inUseTree ,&_elseTree);
_body = omc_Patternm_statementListFindDeadStoreRemoveEmptyStatements(threadData, _body, _localsTree, _inUseTree ,&_useTree);
omc_Expression_traverseExpBottomUp(threadData, _exp, boxvar_Patternm_useLocalCref, _useTree ,&_useTree);
_useTree = omc_AvlSetString_join(threadData, _useTree, _elseTree);
tmpMeta[2] = mmc_mk_box5(6, &DAE_Statement_STMT__IF__desc, _exp, _body, _else_, _source);
tmpMeta[0+0] = tmpMeta[2];
tmpMeta[0+1] = _useTree;
goto tmp3_done;
}
case 4: {
modelica_integer tmp6;
modelica_integer tmp7;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,7) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmp6 = mmc_unbox_integer(tmpMeta[3]);
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
tmp7 = mmc_unbox_integer(tmpMeta[5]);
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 7));
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 8));
_ty = tmpMeta[2];
_b = tmp6;
_id = tmpMeta[4];
_index = tmp7;
_exp = tmpMeta[6];
_body = tmpMeta[7];
_source = tmpMeta[8];
omc_ErrorExt_setCheckpoint(threadData, _OMC_LIT11);
omc_List_map1Fold(threadData, _body, boxvar_Patternm_statementFindDeadStore, _localsTree, _inUseTree ,&_useTree);
omc_ErrorExt_rollBack(threadData, _OMC_LIT11);
_body = omc_Patternm_statementListFindDeadStoreRemoveEmptyStatements(threadData, _body, _localsTree, _useTree ,&_useTree);
omc_Expression_traverseExpBottomUp(threadData, _exp, boxvar_Patternm_useLocalCref, _useTree ,&_useTree);
_useTree = omc_AvlSetString_join(threadData, _useTree, _inUseTree);
tmpMeta[2] = mmc_mk_box8(7, &DAE_Statement_STMT__FOR__desc, _ty, mmc_mk_boolean(_b), _id, mmc_mk_integer(_index), _exp, _body, _source);
tmpMeta[0+0] = tmpMeta[2];
tmpMeta[0+1] = _useTree;
goto tmp3_done;
}
case 5: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,3) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
_exp = tmpMeta[2];
_body = tmpMeta[3];
_source = tmpMeta[4];
omc_ErrorExt_setCheckpoint(threadData, _OMC_LIT11);
omc_List_map1Fold(threadData, _body, boxvar_Patternm_statementFindDeadStore, _localsTree, _inUseTree ,&_useTree);
omc_ErrorExt_rollBack(threadData, _OMC_LIT11);
_body = omc_Patternm_statementListFindDeadStoreRemoveEmptyStatements(threadData, _body, _localsTree, _useTree ,&_useTree);
omc_Expression_traverseExpBottomUp(threadData, _exp, boxvar_Patternm_useLocalCref, _useTree ,&_useTree);
_useTree = omc_AvlSetString_join(threadData, _useTree, _inUseTree);
tmpMeta[2] = mmc_mk_box4(9, &DAE_Statement_STMT__WHILE__desc, _exp, _body, _source);
tmpMeta[0+0] = tmpMeta[2];
tmpMeta[0+1] = _useTree;
goto tmp3_done;
}
case 6: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,8) == 0) goto tmp3_end;
goto goto_2;
goto tmp3_done;
}
case 7: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,8,4) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
_cond = tmpMeta[2];
_msg = tmpMeta[3];
_level = tmpMeta[4];
omc_Expression_traverseExpBottomUp(threadData, _cond, boxvar_Patternm_useLocalCref, _inUseTree ,&_useTree);
omc_Expression_traverseExpBottomUp(threadData, _msg, boxvar_Patternm_useLocalCref, _useTree ,&_useTree);
omc_Expression_traverseExpBottomUp(threadData, _level, boxvar_Patternm_useLocalCref, _useTree ,&_useTree);
tmpMeta[0+0] = _inStatement;
tmpMeta[0+1] = _useTree;
goto tmp3_done;
}
case 8: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,9,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_exp = tmpMeta[2];
omc_Expression_traverseExpBottomUp(threadData, _exp, boxvar_Patternm_useLocalCref, omc_AvlSetString_new(threadData) ,&_useTree);
tmpMeta[0+0] = _inStatement;
tmpMeta[0+1] = _useTree;
goto tmp3_done;
}
case 9: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,6) == 0) goto tmp3_end;
goto goto_2;
goto tmp3_done;
}
case 10: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,10,3) == 0) goto tmp3_end;
goto goto_2;
goto tmp3_done;
}
case 11: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,11,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],13,3) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[3],1,1) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 2));
if (4 != MMC_STRLEN(tmpMeta[4]) || strcmp(MMC_STRINGDATA(_OMC_LIT12), MMC_STRINGDATA(tmpMeta[4])) != 0) goto tmp3_end;
tmpMeta[0+0] = _inStatement;
tmpMeta[0+1] = omc_AvlSetString_new(threadData);
goto tmp3_done;
}
case 12: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,12,1) == 0) goto tmp3_end;
tmpMeta[0+0] = _inStatement;
tmpMeta[0+1] = omc_AvlSetString_new(threadData);
goto tmp3_done;
}
case 13: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,11,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_exp = tmpMeta[2];
omc_Expression_traverseExpBottomUp(threadData, _exp, boxvar_Patternm_useLocalCref, _inUseTree ,&_useTree);
tmpMeta[0+0] = _inStatement;
tmpMeta[0+1] = _useTree;
goto tmp3_done;
}
case 14: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,13,1) == 0) goto tmp3_end;
tmpMeta[0+0] = _inStatement;
tmpMeta[0+1] = _inUseTree;
goto tmp3_done;
}
case 15: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,14,1) == 0) goto tmp3_end;
tmpMeta[0+0] = _inStatement;
tmpMeta[0+1] = _inUseTree;
goto tmp3_done;
}
case 16: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,15,3) == 0) goto tmp3_end;
tmpMeta[0+0] = _inStatement;
tmpMeta[0+1] = _inUseTree;
goto tmp3_done;
}
case 17: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,16,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
_body = tmpMeta[2];
_source = tmpMeta[3];
_body = omc_Patternm_statementListFindDeadStoreRemoveEmptyStatements(threadData, _body, _localsTree, _inUseTree ,&_useTree);
tmpMeta[2] = mmc_mk_box3(19, &DAE_Statement_STMT__FAILURE__desc, _body, _source);
tmpMeta[0+0] = tmpMeta[2];
tmpMeta[0+1] = _useTree;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outStatement = tmpMeta[0+0];
_useTree = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_useTree) { *out_useTree = _useTree; }
return _outStatement;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_statementListFindDeadStoreRemoveEmptyStatements(threadData_t *threadData, modelica_metatype _inBody, modelica_metatype _localsTree, modelica_metatype _inUseTree, modelica_metatype *out_useTree)
{
modelica_metatype _body = NULL;
modelica_metatype _useTree = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_body = omc_List_map1Fold(threadData, listReverse(_inBody), boxvar_Patternm_statementFindDeadStore, _localsTree, _inUseTree ,&_useTree);
_body = omc_List_select(threadData, _body, boxvar_Patternm_isNotDummyStatement);
_body = listReverse(_body);
_return: OMC_LABEL_UNUSED
if (out_useTree) { *out_useTree = _useTree; }
return _body;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addAliasesToEnv(threadData_t *threadData, modelica_metatype _inEnv, modelica_metatype _inTypes, modelica_metatype _inAliases, modelica_metatype _info)
{
modelica_metatype _outEnv = NULL;
modelica_metatype tmpMeta[7] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;modelica_metatype tmp3_2;modelica_metatype tmp3_3;
tmp3_1 = _inEnv;
tmp3_2 = _inTypes;
tmp3_3 = _inAliases;
{
modelica_metatype _tys = NULL;
modelica_metatype _aliases = NULL;
modelica_metatype _rest = NULL;
modelica_string _id = NULL;
modelica_metatype _env = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _attr = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 3; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_2)) goto tmp2_end;
if (!listEmpty(tmp3_3)) goto tmp2_end;
tmpMeta[0] = _inEnv;
goto tmp2_done;
}
case 1: {
if (listEmpty(tmp3_2)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_2);
tmpMeta[2] = MMC_CDR(tmp3_2);
if (listEmpty(tmp3_3)) goto tmp2_end;
tmpMeta[3] = MMC_CAR(tmp3_3);
tmpMeta[4] = MMC_CDR(tmp3_3);
if (!listEmpty(tmpMeta[3])) goto tmp2_end;
_tys = tmpMeta[2];
_aliases = tmpMeta[4];
_inTypes = _tys;
_inAliases = _aliases;
goto _tailrecursive;
goto tmp2_done;
}
case 2: {
if (listEmpty(tmp3_2)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_2);
tmpMeta[2] = MMC_CDR(tmp3_2);
if (listEmpty(tmp3_3)) goto tmp2_end;
tmpMeta[3] = MMC_CAR(tmp3_3);
tmpMeta[4] = MMC_CDR(tmp3_3);
if (listEmpty(tmpMeta[3])) goto tmp2_end;
tmpMeta[5] = MMC_CAR(tmpMeta[3]);
tmpMeta[6] = MMC_CDR(tmpMeta[3]);
_ty = tmpMeta[1];
_id = tmpMeta[5];
_rest = tmpMeta[6];
_aliases = tmpMeta[4];
_env = tmp3_1;
_attr = _OMC_LIT19;
tmpMeta[1] = mmc_mk_box7(3, &DAE_Var_TYPES__VAR__desc, _id, _attr, _ty, _OMC_LIT20, mmc_mk_boolean(0), mmc_mk_none());
tmpMeta[2] = mmc_mk_box9(6, &SCode_Element_COMPONENT__desc, _id, _OMC_LIT24, _OMC_LIT28, _OMC_LIT31, _OMC_LIT32, _OMC_LIT33, mmc_mk_none(), _info);
_env = omc_FGraph_mkComponentNode(threadData, _env, tmpMeta[1], tmpMeta[2], _OMC_LIT34, _OMC_LIT35, omc_FGraph_empty(threadData));
tmpMeta[1] = mmc_mk_cons(_rest, _aliases);
_inEnv = _env;
_inAliases = tmpMeta[1];
goto _tailrecursive;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outEnv = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outEnv;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addPatternAliases(threadData_t *threadData, modelica_metatype _inPattern, modelica_metatype _inAliases, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype *out_outCache)
{
modelica_metatype _pat = NULL;
modelica_metatype _outCache = NULL;
modelica_metatype _attr = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_pat = _inPattern;
_outCache = _inCache;
{
modelica_metatype _alias;
for (tmpMeta[0] = _inAliases; !listEmpty(tmpMeta[0]); tmpMeta[0]=MMC_CDR(tmpMeta[0]))
{
_alias = MMC_CAR(tmpMeta[0]);
tmpMeta[3] = omc_Lookup_lookupIdent(threadData, _outCache, _inEnv, _alias, &tmpMeta[1], NULL, NULL, NULL, NULL);
_outCache = tmpMeta[3];
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 3));
_attr = tmpMeta[2];
tmpMeta[1] = mmc_mk_box5(5, &DAE_Pattern_PAT__AS__desc, _alias, mmc_mk_none(), _attr, _pat);
_pat = tmpMeta[1];
}
}
_return: OMC_LABEL_UNUSED
if (out_outCache) { *out_outCache = _outCache; }
return _pat;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addPatternAliasesList(threadData_t *threadData, modelica_metatype _inPatterns, modelica_metatype _inAliases, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype *out_outCache)
{
modelica_metatype _outPatterns = NULL;
modelica_metatype _outCache = NULL;
modelica_metatype _aliases = NULL;
modelica_metatype _rest_aliases = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_outPatterns = tmpMeta[0];
_outCache = _inCache;
_rest_aliases = _inAliases;
{
modelica_metatype _pat;
for (tmpMeta[1] = _inPatterns; !listEmpty(tmpMeta[1]); tmpMeta[1]=MMC_CDR(tmpMeta[1]))
{
_pat = MMC_CAR(tmpMeta[1]);
tmpMeta[2] = _rest_aliases;
if (listEmpty(tmpMeta[2])) MMC_THROW_INTERNAL();
tmpMeta[3] = MMC_CAR(tmpMeta[2]);
tmpMeta[4] = MMC_CDR(tmpMeta[2]);
_aliases = tmpMeta[3];
_rest_aliases = tmpMeta[4];
_pat = omc_Patternm_addPatternAliases(threadData, _pat, _aliases, _outCache, _inEnv ,&_outCache);
tmpMeta[2] = mmc_mk_cons(_pat, _outPatterns);
_outPatterns = tmpMeta[2];
}
}
_outPatterns = listReverse(_outPatterns);
_return: OMC_LABEL_UNUSED
if (out_outCache) { *out_outCache = _outCache; }
return _outPatterns;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_getInputAsBinding(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype *out_aliases, modelica_metatype *out_aliasesAndCrefs)
{
modelica_metatype _exp = NULL;
modelica_metatype _aliases = NULL;
modelica_metatype _aliasesAndCrefs = NULL;
modelica_metatype tmpMeta[6] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _inExp;
{
modelica_string _id = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 3; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[3],2,2) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 2));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 3));
if (!listEmpty(tmpMeta[5])) goto tmp3_end;
_id = tmpMeta[4];
tmpMeta[3] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[4] = mmc_mk_cons(_id, MMC_REFSTRUCTLIT(mmc_nil));
tmpMeta[0+0] = _inExp;
tmpMeta[0+1] = tmpMeta[3];
tmpMeta[0+2] = tmpMeta[4];
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,19,2) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
_id = tmpMeta[3];
_exp = tmpMeta[4];
_exp = omc_Patternm_getInputAsBinding(threadData, _exp ,&_aliases ,&_aliasesAndCrefs);
tmpMeta[3] = mmc_mk_cons(_id, _aliases);
tmpMeta[4] = mmc_mk_cons(_id, _aliasesAndCrefs);
tmpMeta[0+0] = _exp;
tmpMeta[0+1] = tmpMeta[3];
tmpMeta[0+2] = tmpMeta[4];
goto tmp3_done;
}
case 2: {
tmpMeta[3] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[4] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0+0] = _inExp;
tmpMeta[0+1] = tmpMeta[3];
tmpMeta[0+2] = tmpMeta[4];
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_exp = tmpMeta[0+0];
_aliases = tmpMeta[0+1];
_aliasesAndCrefs = tmpMeta[0+2];
_return: OMC_LABEL_UNUSED
if (out_aliases) { *out_aliases = _aliases; }
if (out_aliasesAndCrefs) { *out_aliasesAndCrefs = _aliasesAndCrefs; }
return _exp;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_findFirstNonAsPattern(threadData_t *threadData, modelica_metatype _inPattern)
{
modelica_metatype _outPattern = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inPattern;
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_outPattern = tmpMeta[1];
_inPattern = _outPattern;
goto _tailrecursive;
goto tmp2_done;
}
case 1: {
tmpMeta[0] = _inPattern;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outPattern = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outPattern;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addEnvKnownAsBindings2(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _inEnv, modelica_metatype _firstPattern)
{
modelica_metatype _env = NULL;
modelica_metatype tmpMeta[8] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_env = _inEnv;
{
modelica_metatype tmp3_1;modelica_metatype tmp3_2;
tmp3_1 = _inPat;
tmp3_2 = _firstPattern;
{
modelica_metatype _name = NULL;
modelica_metatype _path = NULL;
modelica_string _id = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _fields = NULL;
modelica_integer _index;
modelica_boolean _knownSingleton;
modelica_metatype _attr = NULL;
modelica_metatype _typeVars = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
modelica_integer tmp5;
modelica_integer tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
if (mmc__uniontype__metarecord__typedef__equal(tmp3_2,7,6) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 3));
tmp5 = mmc_unbox_integer(tmpMeta[4]);
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 5));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 6));
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 7));
tmp6 = mmc_unbox_integer(tmpMeta[7]);
_id = tmpMeta[1];
_attr = tmpMeta[2];
_name = tmpMeta[3];
_index = tmp5;
_fields = tmpMeta[5];
_typeVars = tmpMeta[6];
_knownSingleton = tmp6;
_path = omc_AbsynUtil_stripLast(threadData, _name);
tmpMeta[1] = mmc_mk_box7(24, &DAE_Type_T__METARECORD__desc, _name, _path, _typeVars, mmc_mk_integer(_index), _fields, mmc_mk_boolean(_knownSingleton));
_ty = tmpMeta[1];
tmpMeta[1] = mmc_mk_box7(3, &DAE_Var_TYPES__VAR__desc, _id, _attr, _ty, _OMC_LIT20, mmc_mk_boolean(0), mmc_mk_none());
tmpMeta[2] = mmc_mk_box3(3, &Absyn_TypeSpec_TPATH__desc, _name, mmc_mk_none());
tmpMeta[3] = mmc_mk_box9(6, &SCode_Element_COMPONENT__desc, _id, _OMC_LIT24, _OMC_LIT28, tmpMeta[2], _OMC_LIT32, _OMC_LIT33, mmc_mk_none(), _OMC_LIT38);
tmpMeta[0] = omc_FGraph_mkComponentNode(threadData, _env, tmpMeta[1], tmpMeta[3], _OMC_LIT34, _OMC_LIT35, omc_FGraph_empty(threadData));
goto tmp2_done;
}
case 1: {
tmpMeta[0] = _env;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_env = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _env;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addEnvKnownAsBindings(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _inEnv, modelica_metatype *out_env)
{
modelica_metatype _pat = NULL;
modelica_metatype _env = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_pat = _inPat;
_env = _inEnv;
{
modelica_metatype tmp3_1;
tmp3_1 = _pat;
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,4) == 0) goto tmp2_end;
tmpMeta[0] = omc_Patternm_addEnvKnownAsBindings2(threadData, _pat, _env, omc_Patternm_findFirstNonAsPattern(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_pat), 5)))));
goto tmp2_done;
}
case 1: {
tmpMeta[0] = _env;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_env = tmpMeta[0];
_return: OMC_LABEL_UNUSED
if (out_env) { *out_env = _env; }
return _pat;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_constantComplexity(threadData_t *threadData, modelica_metatype _inExp, modelica_integer _ii, modelica_integer *out_oi)
{
modelica_metatype _outExp = NULL;
modelica_integer _oi;
modelica_integer tmp1_c1 __attribute__((unused)) = 0;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_integer tmp4_2;
tmp4_1 = _inExp;
tmp4_2 = _ii;
{
modelica_metatype _e = NULL;
modelica_string _str = NULL;
modelica_integer _i;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 5; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_e = tmp4_1;
_str = tmpMeta[2];
_i = tmp4_2;
tmpMeta[0+0] = _e;
tmp1_c1 = ((modelica_integer) 5) + _i + stringLength(_str);
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,1) == 0) goto tmp3_end;
_e = tmp4_1;
_i = tmp4_2;
tmpMeta[0+0] = _e;
tmp1_c1 = ((modelica_integer) 1) + _i;
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,1) == 0) goto tmp3_end;
_e = tmp4_1;
_i = tmp4_2;
tmpMeta[0+0] = _e;
tmp1_c1 = ((modelica_integer) 1) + _i;
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
_e = tmp4_1;
_i = tmp4_2;
tmpMeta[0+0] = _e;
tmp1_c1 = ((modelica_integer) 2) + _i;
goto tmp3_done;
}
case 4: {
_e = tmp4_1;
_i = tmp4_2;
tmpMeta[0+0] = _e;
tmp1_c1 = ((modelica_integer) 5) + _i;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outExp = tmpMeta[0+0];
_oi = tmp1_c1;
_return: OMC_LABEL_UNUSED
if (out_oi) { *out_oi = _oi; }
return _outExp;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_constantComplexity(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _ii, modelica_metatype *out_oi)
{
modelica_integer tmp1;
modelica_integer _oi;
modelica_metatype _outExp = NULL;
tmp1 = mmc_unbox_integer(_ii);
_outExp = omc_Patternm_constantComplexity(threadData, _inExp, tmp1, &_oi);
if (out_oi) { *out_oi = mmc_mk_icon(_oi); }
return _outExp;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_patternComplexity(threadData_t *threadData, modelica_metatype _inPat, modelica_integer _inComplexity, modelica_integer *out_i)
{
modelica_metatype _outPat = NULL;
modelica_integer _i;
modelica_integer tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outPat = _inPat;
_i = _inComplexity;
{
modelica_metatype tmp4_1;
tmp4_1 = _inPat;
{
modelica_metatype _exp = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 5; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
modelica_integer tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,2) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
_exp = tmpMeta[0];
omc_Expression_traverseExpBottomUp(threadData, _exp, boxvar_Patternm_constantComplexity, mmc_mk_integer(_i), &tmpMeta[0]);
tmp6 = mmc_unbox_integer(tmpMeta[0]);
_i = tmp6;
tmp1 = _i;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,2) == 0) goto tmp3_end;
tmp1 = ((modelica_integer) 5) + _i;
goto tmp3_done;
}
case 2: {
modelica_integer tmp7;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,6) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 7));
tmp7 = mmc_unbox_integer(tmpMeta[0]);
if (0 != tmp7) goto tmp3_end;
tmp1 = ((modelica_integer) 5) + _i;
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,9,1) == 0) goto tmp3_end;
tmp1 = ((modelica_integer) 5) + _i;
goto tmp3_done;
}
case 4: {
tmp1 = _i;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_i = tmp1;
_return: OMC_LABEL_UNUSED
if (out_i) { *out_i = _i; }
return _outPat;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_patternComplexity(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _inComplexity, modelica_metatype *out_i)
{
modelica_integer tmp1;
modelica_integer _i;
modelica_metatype _outPat = NULL;
tmp1 = mmc_unbox_integer(_inComplexity);
_outPat = omc_Patternm_patternComplexity(threadData, _inPat, tmp1, &_i);
if (out_i) { *out_i = mmc_mk_icon(_i); }
return _outPat;
}
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_sortPatternsByComplexityWork(threadData_t *threadData, modelica_metatype _tpl1, modelica_metatype _tpl2)
{
modelica_boolean _greater;
modelica_metatype _pat1 = NULL;
modelica_metatype _pat2 = NULL;
modelica_integer _i1;
modelica_integer _i2;
modelica_integer _c1;
modelica_integer _c2;
modelica_integer tmp1;
modelica_integer tmp2;
modelica_integer tmp3;
modelica_integer tmp4;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = _tpl1;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 1));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 2));
tmp1 = mmc_unbox_integer(tmpMeta[2]);
_pat1 = tmpMeta[1];
_i1 = tmp1;
tmpMeta[0] = _tpl2;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 1));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 2));
tmp2 = mmc_unbox_integer(tmpMeta[2]);
_pat2 = tmpMeta[1];
_i2 = tmp2;
omc_Patternm_traversePattern(threadData, _pat1, boxvar_Patternm_patternComplexity, mmc_mk_integer(((modelica_integer) 0)), &tmpMeta[0]);
tmp3 = mmc_unbox_integer(tmpMeta[0]);
_c1 = tmp3;
omc_Patternm_traversePattern(threadData, _pat2, boxvar_Patternm_patternComplexity, mmc_mk_integer(((modelica_integer) 0)), &tmpMeta[0]);
tmp4 = mmc_unbox_integer(tmpMeta[0]);
_c2 = tmp4;
_greater = ((_c1 == _c2)?(_i1 > _i2):((_c2 == ((modelica_integer) 0))?0:((_c1 == ((modelica_integer) 0))?1:(_c1 > _c2))));
_return: OMC_LABEL_UNUSED
return _greater;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_sortPatternsByComplexityWork(threadData_t *threadData, modelica_metatype _tpl1, modelica_metatype _tpl2)
{
modelica_boolean _greater;
modelica_metatype out_greater;
_greater = omc_Patternm_sortPatternsByComplexityWork(threadData, _tpl1, _tpl2);
out_greater = mmc_mk_icon(_greater);
return out_greater;
}
DLLExport
modelica_metatype omc_Patternm_sortPatternsByComplexity(threadData_t *threadData, modelica_metatype _inPatterns)
{
modelica_metatype _outPatterns = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outPatterns = omc_List_toListWithPositions(threadData, _inPatterns);
_outPatterns = omc_List_sort(threadData, _outPatterns, boxvar_Patternm_sortPatternsByComplexityWork);
_return: OMC_LABEL_UNUSED
return _outPatterns;
}
DLLExport
modelica_integer omc_Patternm_getValueCtor(threadData_t *threadData, modelica_integer _ix)
{
modelica_integer _ctor;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_ctor = ((modelica_integer) 3) + _ix;
_return: OMC_LABEL_UNUSED
return _ctor;
}
modelica_metatype boxptr_Patternm_getValueCtor(threadData_t *threadData, modelica_metatype _ix)
{
modelica_integer tmp1;
modelica_integer _ctor;
modelica_metatype out_ctor;
tmp1 = mmc_unbox_integer(_ix);
_ctor = omc_Patternm_getValueCtor(threadData, tmp1);
out_ctor = mmc_mk_icon(_ctor);
return out_ctor;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_setCasePatterns(threadData_t *threadData, modelica_metatype _case1, modelica_metatype _pats)
{
modelica_metatype _case2 = NULL;
modelica_metatype tmpMeta[8] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _case1;
{
modelica_metatype _localDecls = NULL;
modelica_metatype _body = NULL;
modelica_metatype _patternGuard = NULL;
modelica_metatype _result = NULL;
modelica_integer _jump;
modelica_metatype _resultInfo = NULL;
modelica_metatype _info = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 1; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
modelica_integer tmp5;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 6));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 7));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 8));
tmp5 = mmc_unbox_integer(tmpMeta[6]);
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 9));
_patternGuard = tmpMeta[1];
_localDecls = tmpMeta[2];
_body = tmpMeta[3];
_result = tmpMeta[4];
_resultInfo = tmpMeta[5];
_jump = tmp5;
_info = tmpMeta[7];
tmpMeta[1] = mmc_mk_box9(3, &DAE_MatchCase_CASE__desc, _pats, _patternGuard, _localDecls, _body, _result, _resultInfo, mmc_mk_integer(_jump), _info);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_case2 = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _case2;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_getCasePatterns(threadData_t *threadData, modelica_metatype _case_)
{
modelica_metatype _pats = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = _case_;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 2));
_pats = tmpMeta[1];
_return: OMC_LABEL_UNUSED
return _pats;
}
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_allPatternsAlwaysMatch(threadData_t *threadData, modelica_metatype _ipats)
{
modelica_boolean _b;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _ipats;
{
modelica_metatype _pat = NULL;
modelica_metatype _pats = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 5; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_1)) goto tmp3_end;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[0] = MMC_CAR(tmp4_1);
tmpMeta[1] = MMC_CDR(tmp4_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[0],0,0) == 0) goto tmp3_end;
_pats = tmpMeta[1];
_ipats = _pats;
goto _tailrecursive;
goto tmp3_done;
}
case 2: {
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[0] = MMC_CAR(tmp4_1);
tmpMeta[1] = MMC_CDR(tmp4_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[0],2,4) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 5));
_pat = tmpMeta[2];
_pats = tmpMeta[1];
tmpMeta[0] = mmc_mk_cons(_pat, _pats);
_ipats = tmpMeta[0];
goto _tailrecursive;
goto tmp3_done;
}
case 3: {
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[0] = MMC_CAR(tmp4_1);
tmpMeta[1] = MMC_CDR(tmp4_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[0],3,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 3));
_pat = tmpMeta[2];
_pats = tmpMeta[1];
tmpMeta[0] = mmc_mk_cons(_pat, _pats);
_ipats = tmpMeta[0];
goto _tailrecursive;
goto tmp3_done;
}
case 4: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_b = tmp1;
_return: OMC_LABEL_UNUSED
return _b;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_allPatternsAlwaysMatch(threadData_t *threadData, modelica_metatype _ipats)
{
modelica_boolean _b;
modelica_metatype out_b;
_b = omc_Patternm_allPatternsAlwaysMatch(threadData, _ipats);
out_b = mmc_mk_icon(_b);
return out_b;
}
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_allPatternsWild(threadData_t *threadData, modelica_metatype _ipats)
{
modelica_boolean _b;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _ipats;
{
modelica_metatype _pats = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 3; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_1)) goto tmp3_end;
tmp1 = 1;
goto tmp3_done;
}
case 1: {
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[0] = MMC_CAR(tmp4_1);
tmpMeta[1] = MMC_CDR(tmp4_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[0],0,0) == 0) goto tmp3_end;
_pats = tmpMeta[1];
_ipats = _pats;
goto _tailrecursive;
goto tmp3_done;
}
case 2: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_b = tmp1;
_return: OMC_LABEL_UNUSED
return _b;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_allPatternsWild(threadData_t *threadData, modelica_metatype _ipats)
{
modelica_boolean _b;
modelica_metatype out_b;
_b = omc_Patternm_allPatternsWild(threadData, _ipats);
out_b = mmc_mk_icon(_b);
return out_b;
}
DLLExport
modelica_metatype omc_Patternm_resultExps(threadData_t *threadData, modelica_metatype _inCases)
{
modelica_metatype _exps = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCases;
{
modelica_metatype _exp = NULL;
modelica_metatype _cases = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 3; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 6));
if (optionNone(tmpMeta[3])) goto tmp2_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 1));
_exp = tmpMeta[4];
_cases = tmpMeta[2];
_exps = omc_Patternm_resultExps(threadData, _cases);
tmpMeta[1] = mmc_mk_cons(_exp, _exps);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 2: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
_cases = tmpMeta[2];
_inCases = _cases;
goto _tailrecursive;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_exps = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _exps;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_checkLocalShadowing(threadData_t *threadData, modelica_metatype _elt, modelica_metatype _env, modelica_metatype _inTpl)
{
modelica_metatype _outTpl = NULL;
modelica_string _name = NULL;
modelica_metatype _cache = NULL;
modelica_boolean _b;
modelica_metatype _info = NULL;
modelica_metatype _var = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outTpl = _inTpl;
tmpMeta[0] = _elt;
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[0],3,8) == 0) MMC_THROW_INTERNAL();
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 9));
_name = tmpMeta[1];
_info = tmpMeta[2];
tmpMeta[0] = _inTpl;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 1));
_cache = tmpMeta[1];
{
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
modelica_boolean tmp5 = 0;
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[3] = omc_Lookup_lookupVarInternalIdent(threadData, _cache, _env, _name, tmpMeta[2], _OMC_LIT39, &tmpMeta[0], NULL, NULL, NULL, NULL, NULL, NULL, NULL);
_cache = tmpMeta[3];
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[0]), 4));
_var = tmpMeta[1];
{
modelica_metatype tmp8_1;
tmp8_1 = _var;
{
volatile mmc_switch_type tmp8;
int tmp9;
tmp8 = 0;
for (; tmp8 < 2; tmp8++) {
switch (MMC_SWITCH_CAST(tmp8)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp8_1,3,0) == 0) goto tmp7_end;
tmp5 = 1;
goto tmp7_done;
}
case 1: {
tmp5 = 0;
goto tmp7_done;
}
}
goto tmp7_end;
tmp7_end: ;
}
goto goto_6;
goto_6:;
goto goto_1;
goto tmp7_done;
tmp7_done:;
}
}
_b = tmp5;
goto tmp2_done;
}
case 1: {
_b = 1;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 2) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
;
if((!_b))
{
tmpMeta[0] = mmc_mk_cons(_name, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_addSourceMessage(threadData, _OMC_LIT43, tmpMeta[0], _info);
tmpMeta[0] = mmc_mk_box2(0, _cache, mmc_mk_boolean(1));
_outTpl = tmpMeta[0];
}
_return: OMC_LABEL_UNUSED
return _outTpl;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addLocalDecls(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _els, modelica_string _scopeName, modelica_boolean _impl, modelica_metatype _info, modelica_metatype *out_res)
{
modelica_metatype _outCache = NULL;
modelica_metatype _res = NULL;
modelica_metatype tmpMeta[6] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;volatile modelica_metatype tmp4_3;
tmp4_1 = _inCache;
tmp4_2 = _inEnv;
tmp4_3 = _els;
{
modelica_metatype _ld = NULL;
modelica_metatype _ld2 = NULL;
modelica_metatype _ld3 = NULL;
modelica_metatype _ld4 = NULL;
modelica_metatype _ld_mod = NULL;
modelica_metatype _dae1 = NULL;
modelica_metatype _env2 = NULL;
modelica_metatype _dummyFunc = NULL;
modelica_string _str = NULL;
modelica_metatype _cache = NULL;
modelica_metatype _env = NULL;
modelica_boolean _b;
modelica_metatype _declsTree = NULL;
modelica_metatype _names = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 5; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_3)) goto tmp3_end;
_cache = tmp4_1;
_env = tmp4_2;
_declsTree = omc_AvlSetString_new(threadData);
tmpMeta[2] = mmc_mk_box3(0, _env, _OMC_LIT44, _declsTree);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = mmc_mk_some(tmpMeta[2]);
goto tmp3_done;
}
case 1: {
modelica_integer tmp6;
modelica_integer tmp7;
modelica_boolean tmp8;
modelica_boolean tmp9;
_cache = tmp4_1;
_env = tmp4_2;
_ld = tmp4_3;
_env2 = omc_FGraph_openScope(threadData, _env, _OMC_LIT45, _scopeName, mmc_mk_none());
_ld2 = omc_AbsynToSCode_translateEitemlist(threadData, _ld, _OMC_LIT46);
tmpMeta[2] = omc_List_applyAndFold1(threadData, _ld2, boxvar_boolAnd, boxvar_SCodeUtil_isComponentWithDirection, _OMC_LIT26, mmc_mk_boolean(1));
tmp6 = mmc_unbox_integer(tmpMeta[2]);
if (1 != tmp6) goto goto_2;
tmpMeta[2] = mmc_mk_box2(0, _cache, mmc_mk_boolean(0));
tmpMeta[3] = omc_List_fold1(threadData, _ld2, boxvar_Patternm_checkLocalShadowing, _env, tmpMeta[2]);
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 1));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 2));
tmp7 = mmc_unbox_integer(tmpMeta[5]);
_cache = tmpMeta[4];
_b = tmp7;
tmp8 = (modelica_boolean)_b;
if(tmp8)
{
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[3] = tmpMeta[2];
}
else
{
tmpMeta[3] = _ld2;
}
_ld2 = tmpMeta[3];
_ld_mod = omc_InstUtil_addNomod(threadData, _ld2);
_dummyFunc = _OMC_LIT49;
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
_cache = omc_InstUtil_addComponentsToEnv(threadData, _cache, _env2, tmpMeta[2], _OMC_LIT34, _OMC_LIT50, _dummyFunc, _ld_mod, _impl ,&_env2 ,NULL);
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[3] = MMC_REFSTRUCTLIT(mmc_nil);
_cache = omc_Inst_instElementList(threadData, _cache, _env2, tmpMeta[2], _OMC_LIT51, _OMC_LIT34, _OMC_LIT50, _dummyFunc, _ld_mod, tmpMeta[3], _impl, _OMC_LIT52, _OMC_LIT53, _OMC_LIT56, 1 ,&_env2 ,NULL ,NULL ,&_dae1 ,NULL ,NULL ,NULL ,NULL ,NULL);
_names = omc_List_map(threadData, _ld2, boxvar_SCodeUtil_elementName);
_declsTree = omc_AvlSetString_addList(threadData, omc_AvlSetString_new(threadData), _names);
tmp9 = (modelica_boolean)_b;
if(tmp9)
{
tmpMeta[3] = mmc_mk_none();
}
else
{
tmpMeta[2] = mmc_mk_box3(0, _env2, _dae1, _declsTree);
tmpMeta[3] = mmc_mk_some(tmpMeta[2]);
}
_res = tmpMeta[3];
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = _res;
goto tmp3_done;
}
case 2: {
_cache = tmp4_1;
_ld = tmp4_3;
_ld2 = omc_AbsynToSCode_translateEitemlist(threadData, _ld, _OMC_LIT46);
tmpMeta[2] = omc_List_filterOnTrue(threadData, _ld2, boxvar_SCodeUtil_isNotComponent);
if (listEmpty(tmpMeta[2])) goto goto_2;
tmpMeta[3] = MMC_CAR(tmpMeta[2]);
tmpMeta[4] = MMC_CDR(tmpMeta[2]);
_ld2 = tmpMeta[2];
_str = stringDelimitList(omc_List_map1(threadData, _ld2, boxvar_SCodeDump_unparseElementStr, _OMC_LIT57), _OMC_LIT58);
tmpMeta[2] = mmc_mk_cons(_str, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_addSourceMessage(threadData, _OMC_LIT61, tmpMeta[2], _info);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = mmc_mk_none();
goto tmp3_done;
}
case 3: {
_cache = tmp4_1;
_ld = tmp4_3;
_ld2 = omc_AbsynToSCode_translateEitemlist(threadData, _ld, _OMC_LIT46);
_ld3 = omc_List_select1(threadData, _ld2, boxvar_SCodeUtil_isComponentWithDirection, _OMC_LIT16);
_ld4 = omc_List_select1(threadData, _ld2, boxvar_SCodeUtil_isComponentWithDirection, _OMC_LIT62);
tmpMeta[2] = listAppend(_ld3, _ld4);
if (listEmpty(tmpMeta[2])) goto goto_2;
tmpMeta[3] = MMC_CAR(tmpMeta[2]);
tmpMeta[4] = MMC_CDR(tmpMeta[2]);
_ld2 = tmpMeta[2];
_str = stringDelimitList(omc_List_map1(threadData, _ld2, boxvar_SCodeDump_unparseElementStr, _OMC_LIT57), _OMC_LIT58);
tmpMeta[2] = mmc_mk_cons(_str, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_addSourceMessage(threadData, _OMC_LIT61, tmpMeta[2], _info);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = mmc_mk_none();
goto tmp3_done;
}
case 4: {
omc_Error_addSourceMessage(threadData, _OMC_LIT65, _OMC_LIT67, _info);
tmpMeta[0+0] = _inCache;
tmpMeta[0+1] = mmc_mk_none();
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 5) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outCache = tmpMeta[0+0];
_res = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_res) { *out_res = _res; }
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_addLocalDecls(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _els, modelica_metatype _scopeName, modelica_metatype _impl, modelica_metatype _info, modelica_metatype *out_res)
{
modelica_integer tmp1;
modelica_metatype _outCache = NULL;
tmp1 = mmc_unbox_integer(_impl);
_outCache = omc_Patternm_addLocalDecls(threadData, _inCache, _inEnv, _els, _scopeName, tmp1, _info, out_res);
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_filterEmptyPattern(threadData_t *threadData, modelica_metatype _tpl)
{
modelica_boolean _outB;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;
tmp4_1 = _tpl;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[0],0,0) == 0) goto tmp3_end;
tmp1 = 0;
goto tmp3_done;
}
case 1: {
tmp1 = 1;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outB = tmp1;
_return: OMC_LABEL_UNUSED
return _outB;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_filterEmptyPattern(threadData_t *threadData, modelica_metatype _tpl)
{
modelica_boolean _outB;
modelica_metatype out_outB;
_outB = omc_Patternm_filterEmptyPattern(threadData, _tpl);
out_outB = mmc_mk_icon(_outB);
return out_outB;
}
DLLExport
modelica_metatype omc_Patternm_traverseCasesTopDown(threadData_t *threadData, modelica_metatype _inCases, modelica_fnptr _func, modelica_metatype _inA, modelica_metatype *out_a)
{
modelica_metatype _cases = NULL;
modelica_metatype _a = NULL;
modelica_metatype _patterns = NULL;
modelica_metatype _decls = NULL;
modelica_metatype _body = NULL;
modelica_metatype _body1 = NULL;
modelica_metatype _result = NULL;
modelica_metatype _result1 = NULL;
modelica_metatype _patternGuard = NULL;
modelica_metatype _patternGuard1 = NULL;
modelica_integer _jump;
modelica_metatype _resultInfo = NULL;
modelica_metatype _info = NULL;
modelica_metatype _tpl = NULL;
modelica_integer tmp1;
modelica_metatype tmpMeta[11] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_cases = tmpMeta[0];
_a = _inA;
{
modelica_metatype _c;
for (tmpMeta[1] = _inCases; !listEmpty(tmpMeta[1]); tmpMeta[1]=MMC_CDR(tmpMeta[1]))
{
_c = MMC_CAR(tmpMeta[1]);
tmpMeta[2] = _c;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 4));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 5));
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 6));
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 7));
tmpMeta[9] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 8));
tmp1 = mmc_unbox_integer(tmpMeta[9]);
tmpMeta[10] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 9));
_patterns = tmpMeta[3];
_patternGuard = tmpMeta[4];
_decls = tmpMeta[5];
_body = tmpMeta[6];
_result = tmpMeta[7];
_resultInfo = tmpMeta[8];
_jump = tmp1;
_info = tmpMeta[10];
tmpMeta[2] = mmc_mk_box2(0, ((modelica_fnptr) _func), _a);
_tpl = tmpMeta[2];
tmpMeta[4] = omc_DAEUtil_traverseDAEEquationsStmts(threadData, _body, boxvar_Expression_traverseSubexpressionsTopDownHelper, _tpl, &tmpMeta[2]);
_body1 = tmpMeta[4];
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
_a = tmpMeta[3];
_patternGuard1 = omc_Expression_traverseExpOptTopDown(threadData, _patternGuard, ((modelica_fnptr) _func), _a ,&_a);
_result1 = omc_Expression_traverseExpOptTopDown(threadData, _result, ((modelica_fnptr) _func), _a ,&_a);
tmpMeta[3] = mmc_mk_box9(3, &DAE_MatchCase_CASE__desc, _patterns, _patternGuard1, _decls, _body1, _result1, _resultInfo, mmc_mk_integer(_jump), _info);
tmpMeta[2] = mmc_mk_cons(tmpMeta[3], _cases);
_cases = tmpMeta[2];
}
}
_cases = listReverse(_cases);
_return: OMC_LABEL_UNUSED
if (out_a) { *out_a = _a; }
return _cases;
}
DLLExport
modelica_metatype omc_Patternm_traverseCases(threadData_t *threadData, modelica_metatype _inCases, modelica_fnptr _func, modelica_metatype _inA, modelica_metatype *out_oa)
{
modelica_metatype _outCases = NULL;
modelica_metatype _oa = NULL;
modelica_metatype tmpMeta[12] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _inCases;
tmp4_2 = _inA;
{
modelica_metatype _patterns = NULL;
modelica_metatype _decls = NULL;
modelica_metatype _body = NULL;
modelica_metatype _body1 = NULL;
modelica_metatype _result = NULL;
modelica_metatype _result1 = NULL;
modelica_metatype _patternGuard = NULL;
modelica_metatype _patternGuard1 = NULL;
modelica_integer _jump;
modelica_metatype _resultInfo = NULL;
modelica_metatype _info = NULL;
modelica_metatype _cases = NULL;
modelica_metatype _cases1 = NULL;
modelica_metatype _a = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_1)) goto tmp3_end;
_a = tmp4_2;
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0+0] = tmpMeta[2];
tmpMeta[0+1] = _a;
goto tmp3_done;
}
case 1: {
modelica_integer tmp6;
modelica_boolean tmp7;
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_1);
tmpMeta[3] = MMC_CDR(tmp4_1);
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 4));
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 5));
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 6));
tmpMeta[9] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 7));
tmpMeta[10] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 8));
tmp6 = mmc_unbox_integer(tmpMeta[10]);
tmpMeta[11] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 9));
_patterns = tmpMeta[4];
_patternGuard = tmpMeta[5];
_decls = tmpMeta[6];
_body = tmpMeta[7];
_result = tmpMeta[8];
_resultInfo = tmpMeta[9];
_jump = tmp6;
_info = tmpMeta[11];
_cases = tmpMeta[3];
_a = tmp4_2;
tmpMeta[4] = mmc_mk_box2(0, ((modelica_fnptr) _func), _a);
tmpMeta[5] = omc_DAEUtil_traverseDAEEquationsStmts(threadData, _body, boxvar_Expression_traverseSubexpressionsHelper, tmpMeta[4], &tmpMeta[2]);
_body1 = tmpMeta[5];
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
_a = tmpMeta[3];
_patternGuard1 = omc_Expression_traverseExpOpt(threadData, _patternGuard, ((modelica_fnptr) _func), _a ,&_a);
_result1 = omc_Expression_traverseExpOpt(threadData, _result, ((modelica_fnptr) _func), _a ,&_a);
_cases1 = omc_Patternm_traverseCases(threadData, _cases, ((modelica_fnptr) _func), _a ,&_a);
tmp7 = (modelica_boolean)(((referenceEq(_cases, _cases1) && referenceEq(_patternGuard, _patternGuard1)) && referenceEq(_result, _result1)) && referenceEq(_body, _body1));
if(tmp7)
{
tmpMeta[4] = _inCases;
}
else
{
tmpMeta[3] = mmc_mk_box9(3, &DAE_MatchCase_CASE__desc, _patterns, _patternGuard1, _decls, _body1, _result1, _resultInfo, mmc_mk_integer(_jump), _info);
tmpMeta[2] = mmc_mk_cons(tmpMeta[3], _cases1);
tmpMeta[4] = tmpMeta[2];
}
_cases = tmpMeta[4];
tmpMeta[0+0] = _cases;
tmpMeta[0+1] = _a;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outCases = tmpMeta[0+0];
_oa = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_oa) { *out_oa = _oa; }
return _outCases;
}
DLLExport
modelica_metatype omc_Patternm_traverseConstantPatternsHelper2(threadData_t *threadData, modelica_metatype _inPattern, modelica_metatype _inExtra, modelica_fnptr _func, modelica_metatype *out_extra)
{
modelica_metatype _outPattern = NULL;
modelica_metatype _extra = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_extra = _inExtra;
{
modelica_metatype tmp3_1;
tmp3_1 = _inPattern;
{
modelica_metatype _exp = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,2) == 0) goto tmp2_end;
_outPattern = tmp3_1;
_exp = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_outPattern), 3))), _extra ,&_extra) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_outPattern), 3))), _extra ,&_extra);
if((!referenceEq((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_outPattern), 3))), _exp)))
{
tmpMeta[1] = MMC_TAGPTR(mmc_alloc_words(4));
memcpy(MMC_UNTAGPTR(tmpMeta[1]), MMC_UNTAGPTR(_outPattern), 4*sizeof(modelica_metatype));
((modelica_metatype*)MMC_UNTAGPTR(tmpMeta[1]))[3] = _exp;
_outPattern = tmpMeta[1];
}
tmpMeta[0] = _outPattern;
goto tmp2_done;
}
case 1: {
tmpMeta[0] = _inPattern;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outPattern = tmpMeta[0];
_return: OMC_LABEL_UNUSED
if (out_extra) { *out_extra = _extra; }
return _outPattern;
}
static modelica_metatype closure0_Patternm_traverseConstantPatternsHelper2(threadData_t *thData, modelica_metatype closure, modelica_metatype inPattern, modelica_metatype inExtra, modelica_metatype tmp9)
{
modelica_fnptr func = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
return boxptr_Patternm_traverseConstantPatternsHelper2(thData, inPattern, inExtra, func, tmp9);
}
DLLExport
modelica_metatype omc_Patternm_traverseConstantPatternsHelper(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _inT, modelica_fnptr _func, modelica_metatype *out_outT)
{
modelica_metatype _outExp = NULL;
modelica_metatype _outT = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outT = _inT;
{
modelica_metatype tmp3_1;
tmp3_1 = _inExp;
{
modelica_metatype _cases = NULL;
modelica_metatype _cases2 = NULL;
modelica_metatype _case_ = NULL;
modelica_metatype _patterns = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,33,6) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 6));
_outExp = tmp3_1;
_cases = tmpMeta[1];
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
_cases2 = tmpMeta[1];
{
modelica_metatype _c;
for (tmpMeta[1] = _cases; !listEmpty(tmpMeta[1]); tmpMeta[1]=MMC_CDR(tmpMeta[1]))
{
_c = MMC_CAR(tmpMeta[1]);
_case_ = _c;
{
modelica_metatype tmp7_1;
tmp7_1 = _case_;
{
volatile mmc_switch_type tmp7;
int tmp8;
tmp7 = 0;
for (; tmp7 < 1; tmp7++) {
switch (MMC_SWITCH_CAST(tmp7)) {
case 0: {
tmpMeta[3] = mmc_mk_box1(0, ((modelica_fnptr) _func));
_patterns = omc_Patternm_traversePatternList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_case_), 2))), (modelica_fnptr) mmc_mk_box2(0,closure0_Patternm_traverseConstantPatternsHelper2,tmpMeta[3]), _outT ,&_outT);
if((!valueEq((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_case_), 2))), _patterns)))
{
tmpMeta[3] = MMC_TAGPTR(mmc_alloc_words(10));
memcpy(MMC_UNTAGPTR(tmpMeta[3]), MMC_UNTAGPTR(_case_), 10*sizeof(modelica_metatype));
((modelica_metatype*)MMC_UNTAGPTR(tmpMeta[3]))[2] = _patterns;
_case_ = tmpMeta[3];
}
tmpMeta[2] = _case_;
goto tmp6_done;
}
}
goto tmp6_end;
tmp6_end: ;
}
goto goto_5;
goto_5:;
goto goto_1;
goto tmp6_done;
tmp6_done:;
}
}
_case_ = tmpMeta[2];
tmpMeta[2] = mmc_mk_cons(_case_, _cases2);
_cases2 = tmpMeta[2];
}
}
_cases2 = listReverseInPlace(_cases2);
if((!valueEq(_cases, _cases2)))
{
tmpMeta[1] = MMC_TAGPTR(mmc_alloc_words(8));
memcpy(MMC_UNTAGPTR(tmpMeta[1]), MMC_UNTAGPTR(_outExp), 8*sizeof(modelica_metatype));
((modelica_metatype*)MMC_UNTAGPTR(tmpMeta[1]))[6] = _cases2;
_outExp = tmpMeta[1];
}
_outExp = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _outExp, _outT ,&_outT) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _outExp, _outT ,&_outT);
tmpMeta[0] = _outExp;
goto tmp2_done;
}
case 1: {
_outExp = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _inExp, _outT ,&_outT) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _inExp, _outT ,&_outT);
tmpMeta[0] = _outExp;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outExp = tmpMeta[0];
_return: OMC_LABEL_UNUSED
if (out_outT) { *out_outT = _outT; }
return _outExp;
}
DLLExport
modelica_metatype omc_Patternm_fixCaseReturnTypes2(threadData_t *threadData, modelica_metatype _inCases, modelica_metatype _inExps, modelica_metatype _inInfo)
{
modelica_metatype _outCases = NULL;
modelica_metatype tmpMeta[14] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp3_1;volatile modelica_metatype tmp3_2;volatile modelica_metatype tmp3_3;
tmp3_1 = _inCases;
tmp3_2 = _inExps;
tmp3_3 = _inInfo;
{
modelica_metatype _patterns = NULL;
modelica_metatype _decls = NULL;
modelica_metatype _body = NULL;
modelica_metatype _patternGuard = NULL;
modelica_metatype _exp = NULL;
modelica_metatype _case_ = NULL;
modelica_integer _jump;
modelica_metatype _resultInfo = NULL;
modelica_metatype _info2 = NULL;
modelica_metatype _cases = NULL;
modelica_metatype _exps = NULL;
modelica_metatype _info = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 4; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
if (!listEmpty(tmp3_2)) goto tmp2_end;
tmp3 += 2;
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
modelica_integer tmp5;
if (listEmpty(tmp3_2)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_2);
tmpMeta[2] = MMC_CDR(tmp3_2);
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[3] = MMC_CAR(tmp3_1);
tmpMeta[4] = MMC_CDR(tmp3_1);
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 2));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 3));
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 4));
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 5));
tmpMeta[9] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 6));
if (optionNone(tmpMeta[9])) goto tmp2_end;
tmpMeta[10] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[9]), 1));
tmpMeta[11] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 7));
tmpMeta[12] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 8));
tmp5 = mmc_unbox_integer(tmpMeta[12]);
tmpMeta[13] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 9));
_exp = tmpMeta[1];
_exps = tmpMeta[2];
_patterns = tmpMeta[5];
_patternGuard = tmpMeta[6];
_decls = tmpMeta[7];
_body = tmpMeta[8];
_resultInfo = tmpMeta[11];
_jump = tmp5;
_info2 = tmpMeta[13];
_cases = tmpMeta[4];
_info = tmp3_3;
tmp3 += 1;
_cases = omc_Patternm_fixCaseReturnTypes2(threadData, _cases, _exps, _info);
tmpMeta[2] = mmc_mk_box9(3, &DAE_MatchCase_CASE__desc, _patterns, _patternGuard, _decls, _body, mmc_mk_some(_exp), _resultInfo, mmc_mk_integer(_jump), _info2);
tmpMeta[1] = mmc_mk_cons(tmpMeta[2], _cases);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 2: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 6));
if (!optionNone(tmpMeta[3])) goto tmp2_end;
_case_ = tmpMeta[1];
_cases = tmpMeta[2];
_exps = tmp3_2;
_info = tmp3_3;
_cases = omc_Patternm_fixCaseReturnTypes2(threadData, _cases, _exps, _info);
tmpMeta[1] = mmc_mk_cons(_case_, _cases);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 3: {
omc_Error_addSourceMessage(threadData, _OMC_LIT65, _OMC_LIT69, _inInfo);
goto goto_1;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 4) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_outCases = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCases;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_fixCaseReturnTypes(threadData_t *threadData, modelica_metatype _icases, modelica_metatype _iexps, modelica_metatype _itys, modelica_metatype _info, modelica_metatype *out_ty)
{
modelica_metatype _outCases = NULL;
modelica_metatype _ty = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;volatile modelica_metatype tmp4_3;
tmp4_1 = _icases;
tmp4_2 = _iexps;
tmp4_3 = _itys;
{
modelica_string _str = NULL;
modelica_metatype _cases = NULL;
modelica_metatype _exps = NULL;
modelica_metatype _tys = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 4; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_2)) goto tmp3_end;
if (!listEmpty(tmp4_3)) goto tmp3_end;
_cases = tmp4_1;
tmpMeta[0+0] = _cases;
tmpMeta[0+1] = _OMC_LIT70;
goto tmp3_done;
}
case 1: {
_cases = tmp4_1;
_exps = tmp4_2;
_tys = tmp4_3;
_ty = omc_List_reduce(threadData, omc_List_map(threadData, _tys, boxvar_Types_boxIfUnboxedType), boxvar_Types_superType);
_ty = omc_Types_superType(threadData, _ty, _ty);
_ty = omc_Types_unboxedType(threadData, _ty);
_ty = omc_Types_makeRegularTupleFromMetaTupleOnTrue(threadData, omc_Types_allTuple(threadData, _tys), _ty);
_ty = omc_Types_getUniontypeIfMetarecordReplaceAllSubtypes(threadData, _ty);
_exps = omc_Types_matchTypes(threadData, _exps, _tys, _ty, 1, NULL);
_cases = omc_Patternm_fixCaseReturnTypes2(threadData, _cases, _exps, _info);
tmpMeta[0+0] = _cases;
tmpMeta[0+1] = _ty;
goto tmp3_done;
}
case 2: {
_cases = tmp4_1;
_exps = tmp4_2;
_tys = tmp4_3;
_ty = omc_List_reduce(threadData, _tys, boxvar_Types_superType);
_ty = omc_Types_superType(threadData, _ty, _ty);
_ty = omc_Types_unboxedType(threadData, _ty);
_ty = omc_Types_makeRegularTupleFromMetaTupleOnTrue(threadData, omc_Types_allTuple(threadData, _tys), _ty);
_ty = omc_Types_getUniontypeIfMetarecordReplaceAllSubtypes(threadData, _ty);
_exps = omc_Types_matchTypes(threadData, _exps, _tys, _ty, 1, NULL);
_cases = omc_Patternm_fixCaseReturnTypes2(threadData, _cases, _exps, _info);
tmpMeta[0+0] = _cases;
tmpMeta[0+1] = _ty;
goto tmp3_done;
}
case 3: {
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
_tys = omc_List_unionOnTrue(threadData, _itys, tmpMeta[2], boxvar_Types_equivtypes);
_str = stringAppendList(omc_List_map1r(threadData, omc_List_map(threadData, _tys, boxvar_Types_unparseType), boxvar_stringAppend, _OMC_LIT71));
tmpMeta[2] = mmc_mk_cons(_str, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_addSourceMessage(threadData, _OMC_LIT74, tmpMeta[2], _info);
goto goto_2;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 4) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outCases = tmpMeta[0+0];
_ty = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_ty) { *out_ty = _ty; }
return _outCases;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabResultExp2(threadData_t *threadData, modelica_boolean _skipPhase, modelica_metatype _body, modelica_metatype _elabExp, modelica_metatype _info, modelica_metatype *out_outExp, modelica_metatype *out_outInfo)
{
modelica_metatype _outBody = NULL;
modelica_metatype _outExp = NULL;
modelica_metatype _outInfo = NULL;
modelica_metatype tmpMeta[9] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_boolean tmp4_1;volatile modelica_metatype tmp4_2;volatile modelica_metatype tmp4_3;volatile modelica_metatype tmp4_4;
tmp4_1 = _skipPhase;
tmp4_2 = _body;
tmp4_3 = _elabExp;
tmp4_4 = _info;
{
modelica_metatype _elabCr1 = NULL;
modelica_metatype _elabCr2 = NULL;
modelica_metatype _elabCrs1 = NULL;
modelica_metatype _elabCrs2 = NULL;
modelica_metatype _b = NULL;
modelica_metatype _e = NULL;
modelica_metatype _i = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 4; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (1 != tmp4_1) goto tmp3_end;
_b = tmp4_2;
_e = tmp4_3;
_i = tmp4_4;
tmpMeta[0+0] = _b;
tmpMeta[0+1] = _e;
tmpMeta[0+2] = _i;
goto tmp3_done;
}
case 1: {
modelica_boolean tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_3,6,2) == 0) goto tmp3_end;
_elabCr2 = tmp4_3;
_b = tmp4_2;
tmp4 += 1;
tmpMeta[4] = omc_List_splitLast(threadData, _b, &tmpMeta[3]);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[4],0,4) == 0) goto goto_2;
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 3));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 4));
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 5));
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[7]), 2));
_elabCr1 = tmpMeta[5];
_e = tmpMeta[6];
_i = tmpMeta[8];
_b = tmpMeta[3];
tmp6 = omc_Expression_expEqual(threadData, _elabCr1, _elabCr2);
if (1 != tmp6) goto goto_2;
tmpMeta[0+0] = omc_Patternm_elabResultExp2(threadData, 0, _b, _e, _i, &tmpMeta[0+1], &tmpMeta[0+2]);
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_3,19,1) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 2));
_elabCrs2 = tmpMeta[3];
_b = tmp4_2;
tmpMeta[4] = omc_List_splitLast(threadData, _b, &tmpMeta[3]);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[4],1,4) == 0) goto goto_2;
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 3));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 4));
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 5));
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[7]), 2));
_elabCrs1 = tmpMeta[5];
_e = tmpMeta[6];
_i = tmpMeta[8];
_b = tmpMeta[3];
omc_List_threadMapAllValue(threadData, _elabCrs1, _elabCrs2, boxvar_Expression_expEqual, mmc_mk_boolean(1));
tmpMeta[0+0] = omc_Patternm_elabResultExp2(threadData, 0, _b, _e, _i, &tmpMeta[0+1], &tmpMeta[0+2]);
goto tmp3_done;
}
case 3: {
tmpMeta[0+0] = _body;
tmpMeta[0+1] = _elabExp;
tmpMeta[0+2] = _info;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 4) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outBody = tmpMeta[0+0];
_outExp = tmpMeta[0+1];
_outInfo = tmpMeta[0+2];
_return: OMC_LABEL_UNUSED
if (out_outExp) { *out_outExp = _outExp; }
if (out_outInfo) { *out_outInfo = _outInfo; }
return _outBody;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_elabResultExp2(threadData_t *threadData, modelica_metatype _skipPhase, modelica_metatype _body, modelica_metatype _elabExp, modelica_metatype _info, modelica_metatype *out_outExp, modelica_metatype *out_outInfo)
{
modelica_integer tmp1;
modelica_metatype _outBody = NULL;
tmp1 = mmc_unbox_integer(_skipPhase);
_outBody = omc_Patternm_elabResultExp2(threadData, tmp1, _body, _elabExp, _info, out_outExp, out_outInfo);
return _outBody;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabPatternGuard(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _patternGuard, modelica_boolean _impl, modelica_boolean _performVectorization, modelica_metatype _pre, modelica_metatype _inInfo, modelica_metatype *out_outPatternGuard)
{
modelica_metatype _outCache = NULL;
modelica_metatype _outPatternGuard = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;volatile modelica_metatype tmp4_3;volatile modelica_metatype tmp4_4;
tmp4_1 = _inCache;
tmp4_2 = _inEnv;
tmp4_3 = _patternGuard;
tmp4_4 = _inInfo;
{
modelica_metatype _exp = NULL;
modelica_metatype _elabExp = NULL;
modelica_metatype _prop = NULL;
modelica_metatype _cache = NULL;
modelica_metatype _env = NULL;
modelica_metatype _info = NULL;
modelica_string _str = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 3; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!optionNone(tmp4_3)) goto tmp3_end;
_cache = tmp4_1;
tmp4 += 2;
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = mmc_mk_none();
goto tmp3_done;
}
case 1: {
if (optionNone(tmp4_3)) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 1));
_exp = tmpMeta[2];
_cache = tmp4_1;
_env = tmp4_2;
_info = tmp4_4;
_cache = omc_Static_elabExp(threadData, _cache, _env, _exp, _impl, _performVectorization, _pre, _info ,&_elabExp ,&_prop);
_elabExp = omc_Types_matchType(threadData, _elabExp, omc_Types_getPropType(threadData, _prop), _OMC_LIT75, 1, NULL);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = mmc_mk_some(_elabExp);
goto tmp3_done;
}
case 2: {
if (optionNone(tmp4_3)) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 1));
_exp = tmpMeta[2];
_cache = tmp4_1;
_env = tmp4_2;
_info = tmp4_4;
omc_Static_elabExp(threadData, _cache, _env, _exp, _impl, _performVectorization, _pre, _info ,NULL ,&_prop);
_str = omc_Types_unparseType(threadData, omc_Types_getPropType(threadData, _prop));
tmpMeta[2] = mmc_mk_cons(_str, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_addSourceMessage(threadData, _OMC_LIT79, tmpMeta[2], _info);
goto goto_2;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 3) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outCache = tmpMeta[0+0];
_outPatternGuard = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_outPatternGuard) { *out_outPatternGuard = _outPatternGuard; }
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_elabPatternGuard(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _patternGuard, modelica_metatype _impl, modelica_metatype _performVectorization, modelica_metatype _pre, modelica_metatype _inInfo, modelica_metatype *out_outPatternGuard)
{
modelica_integer tmp1;
modelica_integer tmp2;
modelica_metatype _outCache = NULL;
tmp1 = mmc_unbox_integer(_impl);
tmp2 = mmc_unbox_integer(_performVectorization);
_outCache = omc_Patternm_elabPatternGuard(threadData, _inCache, _inEnv, _patternGuard, tmp1, tmp2, _pre, _inInfo, out_outPatternGuard);
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabResultExp(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _inBody, modelica_metatype _exp, modelica_boolean _impl, modelica_boolean _performVectorization, modelica_metatype _pre, modelica_metatype _inInfo, modelica_metatype *out_outBody, modelica_metatype *out_resExp, modelica_metatype *out_resultInfo, modelica_metatype *out_resType)
{
modelica_metatype _outCache = NULL;
modelica_metatype _outBody = NULL;
modelica_metatype _resExp = NULL;
modelica_metatype _resultInfo = NULL;
modelica_metatype _resType = NULL;
modelica_metatype tmpMeta[11] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;volatile modelica_metatype tmp4_3;volatile modelica_metatype tmp4_4;
tmp4_1 = _inCache;
tmp4_2 = _inEnv;
tmp4_3 = _inBody;
tmp4_4 = _exp;
{
modelica_metatype _elabExp = NULL;
modelica_metatype _prop = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _cache = NULL;
modelica_metatype _env = NULL;
modelica_metatype _body = NULL;
modelica_metatype _info = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_4,11,3) == 0) goto tmp3_end;
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_4), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[5],2,2) == 0) goto tmp3_end;
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[5]), 2));
if (4 != MMC_STRLEN(tmpMeta[6]) || strcmp(MMC_STRINGDATA(_OMC_LIT12), MMC_STRINGDATA(tmpMeta[6])) != 0) goto tmp3_end;
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[5]), 3));
if (!listEmpty(tmpMeta[7])) goto tmp3_end;
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_4), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[8],0,2) == 0) goto tmp3_end;
tmpMeta[9] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[8]), 2));
if (!listEmpty(tmpMeta[9])) goto tmp3_end;
tmpMeta[10] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[8]), 3));
if (!listEmpty(tmpMeta[10])) goto tmp3_end;
_cache = tmp4_1;
_body = tmp4_3;
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = _body;
tmpMeta[0+2] = mmc_mk_none();
tmpMeta[0+3] = _inInfo;
tmpMeta[0+4] = mmc_mk_none();
goto tmp3_done;
}
case 1: {
_cache = tmp4_1;
_env = tmp4_2;
_body = tmp4_3;
_cache = omc_Static_elabExp(threadData, _cache, _env, _exp, _impl, _performVectorization, _pre, _inInfo ,&_elabExp ,&_prop);
_ty = omc_Types_getPropType(threadData, _prop);
_elabExp = omc_Patternm_makeTupleFromMetaTuple(threadData, _elabExp, _ty ,&_ty);
_body = omc_Patternm_elabResultExp2(threadData, (!omc_Flags_isSet(threadData, _OMC_LIT83)), _body, _elabExp, _inInfo ,&_elabExp ,&_info);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = _body;
tmpMeta[0+2] = mmc_mk_some(_elabExp);
tmpMeta[0+3] = _info;
tmpMeta[0+4] = mmc_mk_some(_ty);
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 2) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outCache = tmpMeta[0+0];
_outBody = tmpMeta[0+1];
_resExp = tmpMeta[0+2];
_resultInfo = tmpMeta[0+3];
_resType = tmpMeta[0+4];
_return: OMC_LABEL_UNUSED
if (out_outBody) { *out_outBody = _outBody; }
if (out_resExp) { *out_resExp = _resExp; }
if (out_resultInfo) { *out_resultInfo = _resultInfo; }
if (out_resType) { *out_resType = _resType; }
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_elabResultExp(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _inBody, modelica_metatype _exp, modelica_metatype _impl, modelica_metatype _performVectorization, modelica_metatype _pre, modelica_metatype _inInfo, modelica_metatype *out_outBody, modelica_metatype *out_resExp, modelica_metatype *out_resultInfo, modelica_metatype *out_resType)
{
modelica_integer tmp1;
modelica_integer tmp2;
modelica_metatype _outCache = NULL;
tmp1 = mmc_unbox_integer(_impl);
tmp2 = mmc_unbox_integer(_performVectorization);
_outCache = omc_Patternm_elabResultExp(threadData, _inCache, _inEnv, _inBody, _exp, tmp1, tmp2, _pre, _inInfo, out_outBody, out_resExp, out_resultInfo, out_resType);
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabMatchCase(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _acase, modelica_metatype _tys, modelica_metatype _inputAliases, modelica_metatype _matchExpLocalTree, modelica_boolean _impl, modelica_boolean _performVectorization, modelica_metatype _pre, modelica_metatype *out_elabCase, modelica_metatype *out_resExp, modelica_metatype *out_resType)
{
modelica_metatype _outCache = NULL;
modelica_metatype _elabCase = NULL;
modelica_metatype _resExp = NULL;
modelica_metatype _resType = NULL;
modelica_metatype tmpMeta[12] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;modelica_metatype tmp4_3;
tmp4_1 = _inCache;
tmp4_2 = _inEnv;
tmp4_3 = _acase;
{
modelica_metatype _result = NULL;
modelica_metatype _pattern = NULL;
modelica_metatype _patterns = NULL;
modelica_metatype _elabPatterns = NULL;
modelica_metatype _elabPatterns2 = NULL;
modelica_metatype _patternGuard = NULL;
modelica_metatype _elabResult = NULL;
modelica_metatype _dPatternGuard = NULL;
modelica_metatype _caseDecls = NULL;
modelica_metatype _cp = NULL;
modelica_metatype _eqAlgs = NULL;
modelica_metatype _algs = NULL;
modelica_metatype _body = NULL;
modelica_metatype _decls = NULL;
modelica_metatype _patternInfo = NULL;
modelica_metatype _resultInfo = NULL;
modelica_metatype _info = NULL;
modelica_integer _len;
modelica_metatype _cache = NULL;
modelica_metatype _env = NULL;
modelica_metatype _caseLocalTree = NULL;
modelica_metatype _localsTree = NULL;
modelica_metatype _useTree = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
modelica_boolean tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_3,0,9) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 2));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 3));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 4));
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 5));
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 6));
tmpMeta[9] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 7));
tmpMeta[10] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 8));
tmpMeta[11] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 10));
_pattern = tmpMeta[4];
_patternGuard = tmpMeta[5];
_patternInfo = tmpMeta[6];
_decls = tmpMeta[7];
_cp = tmpMeta[8];
_result = tmpMeta[9];
_resultInfo = tmpMeta[10];
_info = tmpMeta[11];
_cache = tmp4_1;
_env = tmp4_2;
tmpMeta[10] = omc_Patternm_addLocalDecls(threadData, _cache, _env, _decls, _OMC_LIT84, _impl, _info, &tmpMeta[4]);
_cache = tmpMeta[10];
if (optionNone(tmpMeta[4])) goto goto_2;
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 1));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[5]), 1));
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[5]), 2));
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[7]), 2));
tmpMeta[9] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[5]), 3));
_env = tmpMeta[6];
_caseDecls = tmpMeta[8];
_caseLocalTree = tmpMeta[9];
_patterns = omc_Patternm_convertExpToPatterns(threadData, _pattern);
tmp6 = (modelica_boolean)(listLength(_tys) == ((modelica_integer) 1));
if(tmp6)
{
tmpMeta[4] = mmc_mk_cons(_pattern, MMC_REFSTRUCTLIT(mmc_nil));
tmpMeta[5] = tmpMeta[4];
}
else
{
tmpMeta[5] = _patterns;
}
_patterns = tmpMeta[5];
_cache = omc_Patternm_elabPatternTuple(threadData, _cache, _env, _patterns, _tys, _patternInfo, _pattern ,&_elabPatterns);
omc_Patternm_checkPatternsDuplicateAsBindings(threadData, _elabPatterns, _patternInfo);
_env = omc_FGraph_openNewScope(threadData, _env, _OMC_LIT45, _OMC_LIT86, mmc_mk_none());
_elabPatterns2 = omc_Patternm_addPatternAliasesList(threadData, _elabPatterns, _inputAliases, _cache, _inEnv ,&_cache);
omc_Patternm_traversePatternList(threadData, _elabPatterns2, boxvar_Patternm_addEnvKnownAsBindings, _env ,&_env);
_eqAlgs = omc_Static_fromEquationsToAlgAssignments(threadData, _cp);
_algs = omc_AbsynToSCode_translateClassdefAlgorithmitems(threadData, _eqAlgs);
tmpMeta[4] = MMC_REFSTRUCTLIT(mmc_nil);
_cache = omc_InstSection_instStatements(threadData, _cache, _env, tmpMeta[4], _pre, _OMC_LIT89, _algs, omc_ElementSource_addElementSourceFileInfo(threadData, _OMC_LIT91, _patternInfo), _OMC_LIT92, 1, 0 ,&_body);
_cache = omc_Patternm_elabResultExp(threadData, _cache, _env, _body, _result, _impl, _performVectorization, _pre, _resultInfo ,&_body ,&_elabResult ,&_resultInfo ,&_resType);
_cache = omc_Patternm_elabPatternGuard(threadData, _cache, _env, _patternGuard, _impl, _performVectorization, _pre, _patternInfo ,&_dPatternGuard);
_localsTree = omc_AvlSetString_join(threadData, _matchExpLocalTree, _caseLocalTree);
_useTree = omc_AvlSetString_new(threadData);
tmpMeta[4] = mmc_mk_box2(34, &DAE_Exp_META__OPTION__desc, _elabResult);
omc_Expression_traverseExpBottomUp(threadData, tmpMeta[4], boxvar_Patternm_useLocalCref, _useTree ,&_useTree);
_body = omc_Patternm_statementListFindDeadStoreRemoveEmptyStatements(threadData, _body, _localsTree, _useTree ,&_useTree);
tmpMeta[4] = mmc_mk_box2(34, &DAE_Exp_META__OPTION__desc, _dPatternGuard);
omc_Expression_traverseExpBottomUp(threadData, tmpMeta[4], boxvar_Patternm_useLocalCref, _useTree ,&_useTree);
tmpMeta[4] = mmc_mk_box3(0, _localsTree, _useTree, _patternInfo);
_elabPatterns = omc_Patternm_traversePatternList(threadData, _elabPatterns, boxvar_Patternm_checkDefUsePattern, tmpMeta[4], NULL);
_useTree = omc_AvlSetString_new(threadData);
tmpMeta[4] = mmc_mk_box2(34, &DAE_Exp_META__OPTION__desc, _elabResult);
omc_Expression_traverseExpBottomUp(threadData, tmpMeta[4], boxvar_Patternm_useLocalCref, _useTree ,&_useTree);
_body = omc_Patternm_statementListFindDeadStoreRemoveEmptyStatements(threadData, _body, _localsTree, _useTree ,&_useTree);
tmpMeta[4] = mmc_mk_box2(34, &DAE_Exp_META__OPTION__desc, _dPatternGuard);
omc_Expression_traverseExpBottomUp(threadData, tmpMeta[4], boxvar_Patternm_useLocalCref, _useTree ,&_useTree);
tmpMeta[4] = mmc_mk_box3(0, _localsTree, _useTree, _patternInfo);
_elabPatterns = omc_Patternm_traversePatternList(threadData, _elabPatterns, boxvar_Patternm_checkDefUsePattern, tmpMeta[4], NULL);
tmpMeta[4] = mmc_mk_box9(3, &DAE_MatchCase_CASE__desc, _elabPatterns, _dPatternGuard, _caseDecls, _body, _elabResult, _resultInfo, mmc_mk_integer(((modelica_integer) 0)), _info);
_elabCase = tmpMeta[4];
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = _elabCase;
tmpMeta[0+2] = _elabResult;
tmpMeta[0+3] = _resType;
goto tmp3_done;
}
case 1: {
modelica_boolean tmp7;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_3,1,6) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 2));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 3));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 4));
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 5));
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 7));
_decls = tmpMeta[4];
_cp = tmpMeta[5];
_result = tmpMeta[6];
_resultInfo = tmpMeta[7];
_info = tmpMeta[8];
_cache = tmp4_1;
_env = tmp4_2;
_len = listLength(_tys);
_patterns = omc_List_fill(threadData, _OMC_LIT94, listLength(_tys));
tmp7 = (modelica_boolean)(_len == ((modelica_integer) 1));
if(tmp7)
{
tmpMeta[5] = _OMC_LIT94;
}
else
{
tmpMeta[4] = mmc_mk_box2(19, &Absyn_Exp_TUPLE__desc, _patterns);
tmpMeta[5] = tmpMeta[4];
}
_pattern = tmpMeta[5];
tmpMeta[4] = mmc_mk_box10(3, &Absyn_Case_CASE__desc, _pattern, mmc_mk_none(), _info, _decls, _cp, _result, _resultInfo, mmc_mk_none(), _info);
_inCache = _cache;
_inEnv = _env;
_acase = tmpMeta[4];
goto _tailrecursive;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outCache = tmpMeta[0+0];
_elabCase = tmpMeta[0+1];
_resExp = tmpMeta[0+2];
_resType = tmpMeta[0+3];
_return: OMC_LABEL_UNUSED
if (out_elabCase) { *out_elabCase = _elabCase; }
if (out_resExp) { *out_resExp = _resExp; }
if (out_resType) { *out_resType = _resType; }
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_elabMatchCase(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _acase, modelica_metatype _tys, modelica_metatype _inputAliases, modelica_metatype _matchExpLocalTree, modelica_metatype _impl, modelica_metatype _performVectorization, modelica_metatype _pre, modelica_metatype *out_elabCase, modelica_metatype *out_resExp, modelica_metatype *out_resType)
{
modelica_integer tmp1;
modelica_integer tmp2;
modelica_metatype _outCache = NULL;
tmp1 = mmc_unbox_integer(_impl);
tmp2 = mmc_unbox_integer(_performVectorization);
_outCache = omc_Patternm_elabMatchCase(threadData, _inCache, _inEnv, _acase, _tys, _inputAliases, _matchExpLocalTree, tmp1, tmp2, _pre, out_elabCase, out_resExp, out_resType);
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabMatchCases2(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _cases, modelica_metatype _tys, modelica_metatype _inputAliases, modelica_metatype _matchExpLocalTree, modelica_boolean _impl, modelica_boolean _performVectorization, modelica_metatype _pre, modelica_metatype _inAccCases, modelica_metatype _inAccExps, modelica_metatype _inAccTypes, modelica_metatype *out_elabCases, modelica_metatype *out_resExps, modelica_metatype *out_resTypes)
{
modelica_metatype _outCache = NULL;
modelica_metatype _elabCases = NULL;
modelica_metatype _resExps = NULL;
modelica_metatype _resTypes = NULL;
modelica_metatype tmpMeta[6] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;modelica_metatype tmp4_3;modelica_metatype tmp4_4;modelica_metatype tmp4_5;
tmp4_1 = _inCache;
tmp4_2 = _inEnv;
tmp4_3 = _cases;
tmp4_4 = _inAccExps;
tmp4_5 = _inAccTypes;
{
modelica_metatype _case_ = NULL;
modelica_metatype _rest = NULL;
modelica_metatype _elabCase = NULL;
modelica_metatype _optType = NULL;
modelica_metatype _optExp = NULL;
modelica_metatype _cache = NULL;
modelica_metatype _env = NULL;
modelica_metatype _accExps = NULL;
modelica_metatype _accTypes = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_3)) goto tmp3_end;
_cache = tmp4_1;
_accExps = tmp4_4;
_accTypes = tmp4_5;
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = listReverse(_inAccCases);
tmpMeta[0+2] = listReverse(_accExps);
tmpMeta[0+3] = listReverse(_accTypes);
goto tmp3_done;
}
case 1: {
if (listEmpty(tmp4_3)) goto tmp3_end;
tmpMeta[4] = MMC_CAR(tmp4_3);
tmpMeta[5] = MMC_CDR(tmp4_3);
_case_ = tmpMeta[4];
_rest = tmpMeta[5];
_cache = tmp4_1;
_env = tmp4_2;
_accExps = tmp4_4;
_accTypes = tmp4_5;
_cache = omc_Patternm_elabMatchCase(threadData, _cache, _env, _case_, _tys, _inputAliases, _matchExpLocalTree, _impl, _performVectorization, _pre ,&_elabCase ,&_optExp ,&_optType);
tmpMeta[4] = mmc_mk_cons(_elabCase, _inAccCases);
_inCache = _cache;
_inEnv = _env;
_cases = _rest;
_inAccCases = tmpMeta[4];
_inAccExps = omc_List_consOption(threadData, _optExp, _accExps);
_inAccTypes = omc_List_consOption(threadData, _optType, _accTypes);
goto _tailrecursive;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outCache = tmpMeta[0+0];
_elabCases = tmpMeta[0+1];
_resExps = tmpMeta[0+2];
_resTypes = tmpMeta[0+3];
_return: OMC_LABEL_UNUSED
if (out_elabCases) { *out_elabCases = _elabCases; }
if (out_resExps) { *out_resExps = _resExps; }
if (out_resTypes) { *out_resTypes = _resTypes; }
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_elabMatchCases2(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _cases, modelica_metatype _tys, modelica_metatype _inputAliases, modelica_metatype _matchExpLocalTree, modelica_metatype _impl, modelica_metatype _performVectorization, modelica_metatype _pre, modelica_metatype _inAccCases, modelica_metatype _inAccExps, modelica_metatype _inAccTypes, modelica_metatype *out_elabCases, modelica_metatype *out_resExps, modelica_metatype *out_resTypes)
{
modelica_integer tmp1;
modelica_integer tmp2;
modelica_metatype _outCache = NULL;
tmp1 = mmc_unbox_integer(_impl);
tmp2 = mmc_unbox_integer(_performVectorization);
_outCache = omc_Patternm_elabMatchCases2(threadData, _inCache, _inEnv, _cases, _tys, _inputAliases, _matchExpLocalTree, tmp1, tmp2, _pre, _inAccCases, _inAccExps, _inAccTypes, out_elabCases, out_resExps, out_resTypes);
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabMatchCases(threadData_t *threadData, modelica_metatype _cache, modelica_metatype _env, modelica_metatype _cases, modelica_metatype _tys, modelica_metatype _inputAliases, modelica_metatype _matchExpLocalTree, modelica_boolean _impl, modelica_boolean _performVectorization, modelica_metatype _pre, modelica_metatype _info, modelica_metatype *out_elabCases, modelica_metatype *out_resType)
{
modelica_metatype _outCache = NULL;
modelica_metatype _elabCases = NULL;
modelica_metatype _resType = NULL;
modelica_metatype _resExps = NULL;
modelica_metatype _resTypes = NULL;
modelica_metatype _tysFixed = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_tysFixed = omc_List_map(threadData, _tys, boxvar_Types_getUniontypeIfMetarecordReplaceAllSubtypes);
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
_outCache = omc_Patternm_elabMatchCases2(threadData, _cache, _env, _cases, _tysFixed, _inputAliases, _matchExpLocalTree, _impl, _performVectorization, _pre, tmpMeta[0], tmpMeta[1], tmpMeta[2] ,&_elabCases ,&_resExps ,&_resTypes);
_elabCases = omc_Patternm_fixCaseReturnTypes(threadData, _elabCases, _resExps, _resTypes, _info ,&_resType);
_return: OMC_LABEL_UNUSED
if (out_elabCases) { *out_elabCases = _elabCases; }
if (out_resType) { *out_resType = _resType; }
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_elabMatchCases(threadData_t *threadData, modelica_metatype _cache, modelica_metatype _env, modelica_metatype _cases, modelica_metatype _tys, modelica_metatype _inputAliases, modelica_metatype _matchExpLocalTree, modelica_metatype _impl, modelica_metatype _performVectorization, modelica_metatype _pre, modelica_metatype _info, modelica_metatype *out_elabCases, modelica_metatype *out_resType)
{
modelica_integer tmp1;
modelica_integer tmp2;
modelica_metatype _outCache = NULL;
tmp1 = mmc_unbox_integer(_impl);
tmp2 = mmc_unbox_integer(_performVectorization);
_outCache = omc_Patternm_elabMatchCases(threadData, _cache, _env, _cases, _tys, _inputAliases, _matchExpLocalTree, tmp1, tmp2, _pre, _info, out_elabCases, out_resType);
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_patternsDoNotOverlap(threadData_t *threadData, modelica_metatype _ip1, modelica_metatype _ip2)
{
modelica_boolean _b;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[6] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _ip1;
tmp4_2 = _ip2;
{
modelica_metatype _head1 = NULL;
modelica_metatype _tail1 = NULL;
modelica_metatype _head2 = NULL;
modelica_metatype _tail2 = NULL;
modelica_metatype _p1 = NULL;
modelica_metatype _p2 = NULL;
modelica_metatype _ps1 = NULL;
modelica_metatype _ps2 = NULL;
modelica_boolean _res;
modelica_metatype _name1 = NULL;
modelica_metatype _name2 = NULL;
modelica_integer _ix1;
modelica_integer _ix2;
modelica_metatype _e1 = NULL;
modelica_metatype _e2 = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 15; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,0) == 0) goto tmp3_end;
tmp1 = 0;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,0) == 0) goto tmp3_end;
tmp1 = 0;
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,2) == 0) goto tmp3_end;
tmp1 = 0;
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_p1 = tmpMeta[0];
_p2 = tmp4_2;
_ip1 = _p1;
_ip2 = _p2;
goto _tailrecursive;
goto tmp3_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 5));
_p2 = tmpMeta[0];
_p1 = tmp4_1;
_ip1 = _p1;
_ip2 = _p2;
goto _tailrecursive;
goto tmp3_done;
}
case 5: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,2) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,6,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
_head1 = tmpMeta[0];
_tail1 = tmpMeta[1];
_head2 = tmpMeta[2];
_tail2 = tmpMeta[3];
tmp1 = (omc_Patternm_patternsDoNotOverlap(threadData, _head1, _head2) || omc_Patternm_patternsDoNotOverlap(threadData, _tail1, _tail2));
goto tmp3_done;
}
case 6: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,9,1) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,9,1) == 0) goto tmp3_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
_p1 = tmpMeta[0];
_p2 = tmpMeta[1];
_ip1 = _p1;
_ip2 = _p2;
goto _tailrecursive;
goto tmp3_done;
}
case 7: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,1) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,4,1) == 0) goto tmp3_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
_ps1 = tmpMeta[0];
_ps2 = tmpMeta[1];
tmp1 = omc_Patternm_patternListsDoNotOverlap(threadData, _ps1, _ps2);
goto tmp3_done;
}
case 8: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,1) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,5,1) == 0) goto tmp3_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
_ps1 = tmpMeta[0];
_ps2 = tmpMeta[1];
tmp1 = omc_Patternm_patternListsDoNotOverlap(threadData, _ps1, _ps2);
goto tmp3_done;
}
case 9: {
modelica_integer tmp6;
modelica_integer tmp7;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,6) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmp6 = mmc_unbox_integer(tmpMeta[1]);
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (!listEmpty(tmpMeta[2])) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,7,6) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
tmp7 = mmc_unbox_integer(tmpMeta[4]);
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
if (!listEmpty(tmpMeta[5])) goto tmp3_end;
_name1 = tmpMeta[0];
_ix1 = tmp6;
_name2 = tmpMeta[3];
_ix2 = tmp7;
_res = (_ix1 == _ix2);
_res = (_res?omc_AbsynUtil_pathEqual(threadData, _name1, _name2):_res);
tmp1 = (!_res);
goto tmp3_done;
}
case 10: {
modelica_integer tmp8;
modelica_integer tmp9;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,6) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmp8 = mmc_unbox_integer(tmpMeta[1]);
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,7,6) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
tmp9 = mmc_unbox_integer(tmpMeta[4]);
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
_name1 = tmpMeta[0];
_ix1 = tmp8;
_ps1 = tmpMeta[2];
_name2 = tmpMeta[3];
_ix2 = tmp9;
_ps2 = tmpMeta[5];
_res = (_ix1 == _ix2);
_res = (_res?omc_AbsynUtil_pathEqual(threadData, _name1, _name2):_res);
tmp1 = (_res?omc_Patternm_patternListsDoNotOverlap(threadData, _ps1, _ps2):(!_res));
goto tmp3_done;
}
case 11: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,2) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,2) == 0) goto tmp3_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
_e1 = tmpMeta[0];
_e2 = tmpMeta[1];
tmp1 = (!omc_Expression_expEqual(threadData, _e1, _e2));
goto tmp3_done;
}
case 12: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,2) == 0) goto tmp3_end;
tmp1 = 1;
goto tmp3_done;
}
case 13: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,2) == 0) goto tmp3_end;
tmp1 = 1;
goto tmp3_done;
}
case 14: {
tmp1 = 0;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_b = tmp1;
_return: OMC_LABEL_UNUSED
return _b;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_patternsDoNotOverlap(threadData_t *threadData, modelica_metatype _ip1, modelica_metatype _ip2)
{
modelica_boolean _b;
modelica_metatype out_b;
_b = omc_Patternm_patternsDoNotOverlap(threadData, _ip1, _ip2);
out_b = mmc_mk_icon(_b);
return out_b;
}
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_patternListsDoNotOverlap(threadData_t *threadData, modelica_metatype _ips1, modelica_metatype _ips2)
{
modelica_boolean _b;
modelica_boolean tmp1 = 0;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _ips1;
tmp4_2 = _ips2;
{
modelica_boolean _res;
modelica_metatype _p1 = NULL;
modelica_metatype _p2 = NULL;
modelica_metatype _ps1 = NULL;
modelica_metatype _ps2 = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_1)) goto tmp3_end;
if (!listEmpty(tmp4_2)) goto tmp3_end;
tmp1 = 0;
goto tmp3_done;
}
case 1: {
modelica_boolean tmp6;
modelica_boolean tmp7;
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[0] = MMC_CAR(tmp4_1);
tmpMeta[1] = MMC_CDR(tmp4_1);
if (listEmpty(tmp4_2)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_2);
tmpMeta[3] = MMC_CDR(tmp4_2);
_p1 = tmpMeta[0];
_ps1 = tmpMeta[1];
_p2 = tmpMeta[2];
_ps2 = tmpMeta[3];
_res = omc_Patternm_patternsDoNotOverlap(threadData, _p1, _p2);
tmp6 = (modelica_boolean)(!_res);
if(tmp6)
{
_ips1 = _ps1;
_ips2 = _ps2;
goto _tailrecursive;
}
else
{
tmp7 = _res;
}
tmp1 = tmp7;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_b = tmp1;
_return: OMC_LABEL_UNUSED
return _b;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_patternListsDoNotOverlap(threadData_t *threadData, modelica_metatype _ips1, modelica_metatype _ips2)
{
modelica_boolean _b;
modelica_metatype out_b;
_b = omc_Patternm_patternListsDoNotOverlap(threadData, _ips1, _ips2);
out_b = mmc_mk_icon(_b);
return out_b;
}
PROTECTED_FUNCTION_STATIC void omc_Patternm_assertAllPatternListsDoNotOverlap(threadData_t *threadData, modelica_metatype _ipss1, modelica_metatype _ps2)
{
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _ipss1;
{
modelica_metatype _ps1 = NULL;
modelica_metatype _pss1 = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
goto tmp2_done;
}
case 1: {
modelica_boolean tmp5;
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[0] = MMC_CAR(tmp3_1);
tmpMeta[1] = MMC_CDR(tmp3_1);
_ps1 = tmpMeta[0];
_pss1 = tmpMeta[1];
tmp5 = omc_Patternm_patternListsDoNotOverlap(threadData, _ps1, _ps2);
if (1 != tmp5) goto goto_1;
_ipss1 = _pss1;
goto _tailrecursive;
;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
;
_return: OMC_LABEL_UNUSED
return;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_optimizeContinueToMatch2(threadData_t *threadData, modelica_metatype _icases, modelica_metatype _prevPatterns, modelica_metatype _info)
{
modelica_metatype _outMatchType = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp3_1;
tmp3_1 = _icases;
{
modelica_metatype _patterns = NULL;
modelica_metatype _cases = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 3; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
tmp3 += 1;
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
omc_Error_assertionOrAddSourceMessage(threadData, (!omc_Flags_isSet(threadData, _OMC_LIT3)), _OMC_LIT97, tmpMeta[1], _info);
tmpMeta[0] = _OMC_LIT98;
goto tmp2_done;
}
case 1: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
_patterns = tmpMeta[3];
_cases = tmpMeta[2];
omc_Patternm_assertAllPatternListsDoNotOverlap(threadData, _prevPatterns, _patterns);
tmpMeta[1] = mmc_mk_cons(_patterns, _prevPatterns);
tmpMeta[0] = omc_Patternm_optimizeContinueToMatch2(threadData, _cases, tmpMeta[1], _info);
goto tmp2_done;
}
case 2: {
tmpMeta[0] = _OMC_LIT99;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 3) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_outMatchType = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outMatchType;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_optimizeContinueToMatch(threadData_t *threadData, modelica_metatype _matchType, modelica_metatype _cases, modelica_metatype _info)
{
modelica_metatype _outMatchType = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _matchType;
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,0) == 0) goto tmp2_end;
tmpMeta[0] = _OMC_LIT98;
goto tmp2_done;
}
case 1: {
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = omc_Patternm_optimizeContinueToMatch2(threadData, _cases, tmpMeta[1], _info);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outMatchType = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outMatchType;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_updateMatchCaseJump(threadData_t *threadData, modelica_metatype _case_, modelica_integer _jump)
{
modelica_metatype _outCase = NULL;
modelica_metatype tmpMeta[8] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;modelica_integer tmp3_2;
tmp3_1 = _case_;
tmp3_2 = _jump;
{
modelica_metatype _patterns = NULL;
modelica_metatype _localDecls = NULL;
modelica_metatype _body = NULL;
modelica_metatype _result = NULL;
modelica_metatype _guardPattern = NULL;
modelica_metatype _resultInfo = NULL;
modelica_metatype _info = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (0 != tmp3_2) goto tmp2_end;
tmpMeta[0] = _case_;
goto tmp2_done;
}
case 1: {
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 6));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 7));
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 9));
_patterns = tmpMeta[1];
_guardPattern = tmpMeta[2];
_localDecls = tmpMeta[3];
_body = tmpMeta[4];
_result = tmpMeta[5];
_resultInfo = tmpMeta[6];
_info = tmpMeta[7];
tmpMeta[1] = mmc_mk_box9(3, &DAE_MatchCase_CASE__desc, _patterns, _guardPattern, _localDecls, _body, _result, _resultInfo, mmc_mk_integer(_jump), _info);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCase = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCase;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_updateMatchCaseJump(threadData_t *threadData, modelica_metatype _case_, modelica_metatype _jump)
{
modelica_integer tmp1;
modelica_metatype _outCase = NULL;
tmp1 = mmc_unbox_integer(_jump);
_outCase = omc_Patternm_updateMatchCaseJump(threadData, _case_, tmp1);
return _outCase;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_optimizeContinueJump(threadData_t *threadData, modelica_metatype _case_, modelica_metatype _icases, modelica_integer _jump)
{
modelica_metatype _outCase = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp3_1;volatile modelica_metatype tmp3_2;
tmp3_1 = _case_;
tmp3_2 = _icases;
{
modelica_metatype _case1 = NULL;
modelica_metatype _ps1 = NULL;
modelica_metatype _ps2 = NULL;
modelica_metatype _cases = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 3; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_2)) goto tmp2_end;
_case1 = tmp3_1;
tmp3 += 1;
tmpMeta[0] = omc_Patternm_updateMatchCaseJump(threadData, _case1, _jump);
goto tmp2_done;
}
case 1: {
modelica_boolean tmp5;
if (listEmpty(tmp3_2)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_2);
tmpMeta[2] = MMC_CDR(tmp3_2);
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_ps2 = tmpMeta[3];
_cases = tmpMeta[2];
_case1 = tmp3_1;
_ps1 = tmpMeta[4];
tmp5 = omc_Patternm_patternListsDoNotOverlap(threadData, _ps1, _ps2);
if (1 != tmp5) goto goto_1;
tmpMeta[0] = omc_Patternm_optimizeContinueJump(threadData, _case1, _cases, ((modelica_integer) 1) + _jump);
goto tmp2_done;
}
case 2: {
_case1 = tmp3_1;
tmpMeta[0] = omc_Patternm_updateMatchCaseJump(threadData, _case1, _jump);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 3) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_outCase = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCase;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_optimizeContinueJump(threadData_t *threadData, modelica_metatype _case_, modelica_metatype _icases, modelica_metatype _jump)
{
modelica_integer tmp1;
modelica_metatype _outCase = NULL;
tmp1 = mmc_unbox_integer(_jump);
_outCase = omc_Patternm_optimizeContinueJump(threadData, _case_, _icases, tmp1);
return _outCase;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_optimizeContinueJumps2(threadData_t *threadData, modelica_metatype _icases)
{
modelica_metatype _outCases = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _icases;
{
modelica_metatype _case_ = NULL;
modelica_metatype _cases = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
_case_ = tmpMeta[1];
_cases = tmpMeta[2];
_case_ = omc_Patternm_optimizeContinueJump(threadData, _case_, _cases, ((modelica_integer) 0));
_cases = omc_Patternm_optimizeContinueJumps2(threadData, _cases);
tmpMeta[1] = mmc_mk_cons(_case_, _cases);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCases = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCases;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_optimizeContinueJumps(threadData_t *threadData, modelica_metatype _matchType, modelica_metatype _cases)
{
modelica_metatype _outCases = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _matchType;
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,0) == 0) goto tmp2_end;
tmpMeta[0] = _cases;
goto tmp2_done;
}
case 1: {
tmpMeta[0] = omc_Patternm_optimizeContinueJumps2(threadData, _cases);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCases = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCases;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_caseDeadCodeElimination(threadData_t *threadData, modelica_metatype _matchType, modelica_metatype _cases, modelica_metatype _prevPatterns, modelica_metatype _iacc, modelica_boolean _iter)
{
modelica_metatype _outCases = NULL;
modelica_metatype tmpMeta[7] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp3_1;volatile modelica_metatype tmp3_2;volatile modelica_metatype tmp3_3;volatile modelica_boolean tmp3_4;
tmp3_1 = _matchType;
tmp3_2 = _cases;
tmp3_3 = _iacc;
tmp3_4 = _iter;
{
modelica_metatype _rest = NULL;
modelica_metatype _pats = NULL;
modelica_metatype _case_ = NULL;
modelica_metatype _info = NULL;
modelica_metatype _acc = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 5; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (0 != tmp3_4) goto tmp2_end;
if (!listEmpty(tmp3_2)) goto tmp2_end;
_acc = tmp3_3;
tmp3 += 4;
tmpMeta[0] = listReverse(_acc);
goto tmp2_done;
}
case 1: {
if (1 != tmp3_4) goto tmp2_end;
if (!listEmpty(tmp3_2)) goto tmp2_end;
_acc = tmp3_3;
tmp3 += 3;
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = omc_Patternm_caseDeadCodeElimination(threadData, _matchType, listReverse(_acc), tmpMeta[1], tmpMeta[2], 0);
goto tmp2_done;
}
case 2: {
if (listEmpty(tmp3_2)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_2);
tmpMeta[2] = MMC_CDR(tmp3_2);
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 5));
if (!listEmpty(tmpMeta[3])) goto tmp2_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 6));
if (!optionNone(tmpMeta[4])) goto tmp2_end;
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 9));
if (!listEmpty(tmpMeta[2])) goto tmp2_end;
_info = tmpMeta[5];
_acc = tmp3_3;
omc_Error_assertionOrAddSourceMessage(threadData, (!omc_Flags_isSet(threadData, _OMC_LIT3)), _OMC_LIT8, _OMC_LIT101, _info);
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = omc_Patternm_caseDeadCodeElimination(threadData, _matchType, listReverse(_acc), tmpMeta[1], tmpMeta[2], 0);
goto tmp2_done;
}
case 3: {
modelica_boolean tmp5;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,0) == 0) goto tmp2_end;
if (listEmpty(tmp3_2)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_2);
tmpMeta[2] = MMC_CDR(tmp3_2);
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 5));
if (!listEmpty(tmpMeta[4])) goto tmp2_end;
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 6));
if (!optionNone(tmpMeta[5])) goto tmp2_end;
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 9));
_pats = tmpMeta[3];
_info = tmpMeta[6];
_rest = tmpMeta[2];
_acc = tmp3_3;
tmp5 = omc_Flags_isSet(threadData, _OMC_LIT105);
if (1 != tmp5) goto goto_1;
omc_Error_assertionOrAddSourceMessage(threadData, (!omc_Flags_isSet(threadData, _OMC_LIT3)), _OMC_LIT8, _OMC_LIT107, _info);
tmpMeta[1] = mmc_mk_cons(_pats, _prevPatterns);
tmpMeta[0] = omc_Patternm_caseDeadCodeElimination(threadData, _matchType, _rest, tmpMeta[1], _acc, 1);
goto tmp2_done;
}
case 4: {
if (listEmpty(tmp3_2)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_2);
tmpMeta[2] = MMC_CDR(tmp3_2);
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
_case_ = tmpMeta[1];
_pats = tmpMeta[3];
_rest = tmpMeta[2];
_acc = tmp3_3;
tmpMeta[1] = mmc_mk_cons(_pats, _prevPatterns);
tmpMeta[2] = mmc_mk_cons(_case_, _acc);
tmpMeta[0] = omc_Patternm_caseDeadCodeElimination(threadData, _matchType, _rest, tmpMeta[1], tmpMeta[2], _iter);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 5) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_outCases = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCases;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_caseDeadCodeElimination(threadData_t *threadData, modelica_metatype _matchType, modelica_metatype _cases, modelica_metatype _prevPatterns, modelica_metatype _iacc, modelica_metatype _iter)
{
modelica_integer tmp1;
modelica_metatype _outCases = NULL;
tmp1 = mmc_unbox_integer(_iter);
_outCases = omc_Patternm_caseDeadCodeElimination(threadData, _matchType, _cases, _prevPatterns, _iacc, tmp1);
return _outCases;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_filterUnusedDecls(threadData_t *threadData, modelica_metatype _matchDecls, modelica_metatype _ht, modelica_metatype _iacc, modelica_metatype _iunusedHt, modelica_metatype *out_outUnusedHt)
{
modelica_metatype _outDecls = NULL;
modelica_metatype _outUnusedHt = NULL;
modelica_metatype tmpMeta[8] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;volatile modelica_metatype tmp4_3;
tmp4_1 = _matchDecls;
tmp4_2 = _iacc;
tmp4_3 = _iunusedHt;
{
modelica_metatype _el = NULL;
modelica_metatype _rest = NULL;
modelica_metatype _info = NULL;
modelica_string _name = NULL;
modelica_metatype _acc = NULL;
modelica_metatype _unusedHt = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 3; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_1)) goto tmp3_end;
_acc = tmp4_2;
_unusedHt = tmp4_3;
tmp4 += 2;
tmpMeta[0+0] = listReverse(_acc);
tmpMeta[0+1] = _unusedHt;
goto tmp3_done;
}
case 1: {
modelica_boolean tmp6;
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_1);
tmpMeta[3] = MMC_CDR(tmp4_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],0,13) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[4],1,3) == 0) goto tmp3_end;
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 2));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 11));
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[6]), 2));
_name = tmpMeta[5];
_info = tmpMeta[7];
_rest = tmpMeta[3];
_acc = tmp4_2;
_unusedHt = tmp4_3;
tmp6 = omc_BaseHashTable_hasKey(threadData, _name, _ht);
if (0 != tmp6) goto goto_2;
tmpMeta[2] = mmc_mk_box2(0, _name, _OMC_LIT108);
_unusedHt = omc_BaseHashTable_add(threadData, tmpMeta[2], _unusedHt);
tmpMeta[2] = mmc_mk_cons(_name, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_assertionOrAddSourceMessage(threadData, (!omc_Flags_isSet(threadData, _OMC_LIT3)), _OMC_LIT111, tmpMeta[2], _info);
tmpMeta[0+0] = omc_Patternm_filterUnusedDecls(threadData, _rest, _ht, _acc, _unusedHt, &tmpMeta[0+1]);
goto tmp3_done;
}
case 2: {
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_1);
tmpMeta[3] = MMC_CDR(tmp4_1);
_el = tmpMeta[2];
_rest = tmpMeta[3];
_acc = tmp4_2;
_unusedHt = tmp4_3;
tmpMeta[2] = mmc_mk_cons(_el, _acc);
tmpMeta[0+0] = omc_Patternm_filterUnusedDecls(threadData, _rest, _ht, tmpMeta[2], _unusedHt, &tmpMeta[0+1]);
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 3) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outDecls = tmpMeta[0+0];
_outUnusedHt = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_outUnusedHt) { *out_outUnusedHt = _outUnusedHt; }
return _outDecls;
}
DLLExport
modelica_metatype omc_Patternm_traversePattern(threadData_t *threadData, modelica_metatype _inPattern, modelica_fnptr _func, modelica_metatype _inExtra, modelica_metatype *out_extra)
{
modelica_metatype _outPattern = NULL;
modelica_metatype _extra = NULL;
modelica_metatype tmpMeta[8] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_extra = _inExtra;
{
modelica_metatype tmp4_1;
tmp4_1 = _inPattern;
{
modelica_metatype _pat = NULL;
modelica_metatype _pat1 = NULL;
modelica_metatype _pat2 = NULL;
modelica_metatype _pats = NULL;
modelica_metatype _fields = NULL;
modelica_metatype _types = NULL;
modelica_metatype _typeVars = NULL;
modelica_string _id = NULL;
modelica_string _str = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _name = NULL;
modelica_integer _index;
modelica_metatype _namedpats = NULL;
modelica_boolean _knownSingleton;
modelica_metatype _fieldVars = NULL;
modelica_metatype _attr = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 11; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,4) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_id = tmpMeta[2];
_ty = tmpMeta[3];
_attr = tmpMeta[4];
_pat2 = tmpMeta[5];
_pat2 = omc_Patternm_traversePattern(threadData, _pat2, ((modelica_fnptr) _func), _extra ,&_extra);
tmpMeta[2] = mmc_mk_box5(5, &DAE_Pattern_PAT__AS__desc, _id, _ty, _attr, _pat2);
_pat = tmpMeta[2];
tmpMeta[0+0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _pat, _extra, &tmpMeta[0+1]) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _pat, _extra, &tmpMeta[0+1]);
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
_id = tmpMeta[2];
_pat2 = tmpMeta[3];
_pat2 = omc_Patternm_traversePattern(threadData, _pat2, ((modelica_fnptr) _func), _extra ,&_extra);
tmpMeta[2] = mmc_mk_box3(6, &DAE_Pattern_PAT__AS__FUNC__PTR__desc, _id, _pat2);
_pat = tmpMeta[2];
tmpMeta[0+0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _pat, _extra, &tmpMeta[0+1]) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _pat, _extra, &tmpMeta[0+1]);
goto tmp3_done;
}
case 2: {
modelica_integer tmp6;
modelica_integer tmp7;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,6) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmp6 = mmc_unbox_integer(tmpMeta[3]);
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 7));
tmp7 = mmc_unbox_integer(tmpMeta[7]);
_name = tmpMeta[2];
_index = tmp6;
_pats = tmpMeta[4];
_fieldVars = tmpMeta[5];
_typeVars = tmpMeta[6];
_knownSingleton = tmp7;
_pats = omc_Patternm_traversePatternList(threadData, _pats, ((modelica_fnptr) _func), _extra ,&_extra);
tmpMeta[2] = mmc_mk_box7(10, &DAE_Pattern_PAT__CALL__desc, _name, mmc_mk_integer(_index), _pats, _fieldVars, _typeVars, mmc_mk_boolean(_knownSingleton));
_pat = tmpMeta[2];
tmpMeta[0+0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _pat, _extra, &tmpMeta[0+1]) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _pat, _extra, &tmpMeta[0+1]);
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,8,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
_name = tmpMeta[2];
_namedpats = tmpMeta[3];
_pats = omc_List_unzip3(threadData, _namedpats ,&_fields ,&_types);
_pats = omc_Patternm_traversePatternList(threadData, _pats, ((modelica_fnptr) _func), _extra ,&_extra);
_namedpats = omc_List_zip3(threadData, _pats, _fields, _types);
tmpMeta[2] = mmc_mk_box3(11, &DAE_Pattern_PAT__CALL__NAMED__desc, _name, _namedpats);
_pat = tmpMeta[2];
tmpMeta[0+0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _pat, _extra, &tmpMeta[0+1]) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _pat, _extra, &tmpMeta[0+1]);
goto tmp3_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_pats = tmpMeta[2];
_pats = omc_Patternm_traversePatternList(threadData, _pats, ((modelica_fnptr) _func), _extra ,&_extra);
tmpMeta[2] = mmc_mk_box2(8, &DAE_Pattern_PAT__CALL__TUPLE__desc, _pats);
_pat = tmpMeta[2];
tmpMeta[0+0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _pat, _extra, &tmpMeta[0+1]) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _pat, _extra, &tmpMeta[0+1]);
goto tmp3_done;
}
case 5: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_pats = tmpMeta[2];
_pats = omc_Patternm_traversePatternList(threadData, _pats, ((modelica_fnptr) _func), _extra ,&_extra);
tmpMeta[2] = mmc_mk_box2(7, &DAE_Pattern_PAT__META__TUPLE__desc, _pats);
_pat = tmpMeta[2];
tmpMeta[0+0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _pat, _extra, &tmpMeta[0+1]) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _pat, _extra, &tmpMeta[0+1]);
goto tmp3_done;
}
case 6: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
_pat1 = tmpMeta[2];
_pat2 = tmpMeta[3];
_pat1 = omc_Patternm_traversePattern(threadData, _pat1, ((modelica_fnptr) _func), _extra ,&_extra);
_pat2 = omc_Patternm_traversePattern(threadData, _pat2, ((modelica_fnptr) _func), _extra ,&_extra);
tmpMeta[2] = mmc_mk_box3(9, &DAE_Pattern_PAT__CONS__desc, _pat1, _pat2);
_pat = tmpMeta[2];
tmpMeta[0+0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _pat, _extra, &tmpMeta[0+1]) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _pat, _extra, &tmpMeta[0+1]);
goto tmp3_done;
}
case 7: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,2) == 0) goto tmp3_end;
_pat = tmp4_1;
tmpMeta[0+0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _pat, _extra, &tmpMeta[0+1]) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _pat, _extra, &tmpMeta[0+1]);
goto tmp3_done;
}
case 8: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,9,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_pat1 = tmpMeta[2];
_pat1 = omc_Patternm_traversePattern(threadData, _pat1, ((modelica_fnptr) _func), _extra ,&_extra);
tmpMeta[2] = mmc_mk_box2(12, &DAE_Pattern_PAT__SOME__desc, _pat1);
_pat = tmpMeta[2];
tmpMeta[0+0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _pat, _extra, &tmpMeta[0+1]) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _pat, _extra, &tmpMeta[0+1]);
goto tmp3_done;
}
case 9: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,0) == 0) goto tmp3_end;
_pat = tmp4_1;
tmpMeta[0+0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _pat, _extra, &tmpMeta[0+1]) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _pat, _extra, &tmpMeta[0+1]);
goto tmp3_done;
}
case 10: {
_pat = tmp4_1;
tmpMeta[2] = stringAppend(_OMC_LIT112,omc_Patternm_patternStr(threadData, _pat));
_str = tmpMeta[2];
tmpMeta[2] = mmc_mk_cons(_str, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_addMessage(threadData, _OMC_LIT65, tmpMeta[2]);
goto goto_2;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outPattern = tmpMeta[0+0];
_extra = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_extra) { *out_extra = _extra; }
return _outPattern;
}
DLLExport
modelica_metatype omc_Patternm_traversePatternList(threadData_t *threadData, modelica_metatype _inPatterns, modelica_fnptr _func, modelica_metatype _inExtra, modelica_metatype *out_extra)
{
modelica_metatype _outPatterns = NULL;
modelica_metatype _extra = NULL;
modelica_metatype _p = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
_outPatterns = tmpMeta[0];
_extra = _inExtra;
{
modelica_metatype _pat;
for (tmpMeta[1] = _inPatterns; !listEmpty(tmpMeta[1]); tmpMeta[1]=MMC_CDR(tmpMeta[1]))
{
_pat = MMC_CAR(tmpMeta[1]);
_p = omc_Patternm_traversePattern(threadData, _pat, ((modelica_fnptr) _func), _extra ,&_extra);
tmpMeta[2] = mmc_mk_cons(_p, _outPatterns);
_outPatterns = tmpMeta[2];
}
}
_outPatterns = listReverseInPlace(_outPatterns);
_return: OMC_LABEL_UNUSED
if (out_extra) { *out_extra = _extra; }
return _outPatterns;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addPatternAsBindings(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _inHt, modelica_metatype *out_ht)
{
modelica_metatype _pat = NULL;
modelica_metatype _ht = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_pat = _inPat;
_ht = _inHt;
{
volatile modelica_metatype tmp3_1;
tmp3_1 = _inPat;
{
modelica_string _id = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 3; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_id = tmpMeta[1];
tmp3 += 1;
tmpMeta[1] = mmc_mk_box2(0, _id, _OMC_LIT108);
tmpMeta[0] = omc_BaseHashTable_add(threadData, tmpMeta[1], _ht);
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,3,2) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_id = tmpMeta[1];
tmpMeta[1] = mmc_mk_box2(0, _id, _OMC_LIT108);
tmpMeta[0] = omc_BaseHashTable_add(threadData, tmpMeta[1], _ht);
goto tmp2_done;
}
case 2: {
tmpMeta[0] = _ht;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 3) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_ht = tmpMeta[0];
_return: OMC_LABEL_UNUSED
if (out_ht) { *out_ht = _ht; }
return _pat;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_simplifyPattern(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _extra, modelica_metatype *out_outExtra)
{
modelica_metatype _outPat = NULL;
modelica_metatype _outExtra = NULL;
modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outExtra = _extra;
{
modelica_metatype tmp3_1;
tmp3_1 = _inPat;
{
modelica_metatype _name = NULL;
modelica_metatype _namedPatterns = NULL;
modelica_metatype _patterns = NULL;
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 11: {
modelica_boolean tmp4;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,8,2) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
_name = tmpMeta[1];
_namedPatterns = tmpMeta[2];
_namedPatterns = omc_List_filterOnTrue(threadData, _namedPatterns, boxvar_Patternm_filterEmptyPattern);
tmp4 = (modelica_boolean)listEmpty(_namedPatterns);
if(tmp4)
{
tmpMeta[2] = _OMC_LIT113;
}
else
{
tmpMeta[1] = mmc_mk_box3(11, &DAE_Pattern_PAT__CALL__NAMED__desc, _name, _namedPatterns);
tmpMeta[2] = tmpMeta[1];
}
tmpMeta[0] = tmpMeta[2];
goto tmp2_done;
}
case 8: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,5,1) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_patterns = tmpMeta[1];
tmpMeta[0] = (omc_Patternm_allPatternsWild(threadData, _patterns)?_OMC_LIT113:_inPat);
goto tmp2_done;
}
case 7: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,4,1) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_patterns = tmpMeta[1];
tmpMeta[0] = (omc_Patternm_allPatternsWild(threadData, _patterns)?_OMC_LIT113:_inPat);
goto tmp2_done;
}
default:
tmp2_default: OMC_LABEL_UNUSED; {
tmpMeta[0] = _inPat;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outPat = tmpMeta[0];
_return: OMC_LABEL_UNUSED
if (out_outExtra) { *out_outExtra = _outExtra; }
return _outPat;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addCasesLocalCref(threadData_t *threadData, modelica_metatype _icases, modelica_metatype _iht)
{
modelica_metatype _outHt = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;modelica_metatype tmp3_2;
tmp3_1 = _icases;
tmp3_2 = _iht;
{
modelica_metatype _pats = NULL;
modelica_metatype _cases = NULL;
modelica_metatype _ht = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
_ht = tmp3_2;
tmpMeta[0] = _ht;
goto tmp2_done;
}
case 1: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
_pats = tmpMeta[3];
_cases = tmpMeta[2];
_ht = tmp3_2;
omc_Patternm_traversePatternList(threadData, _pats, boxvar_Patternm_addPatternAsBindings, _ht ,&_ht);
_icases = _cases;
_iht = _ht;
goto _tailrecursive;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outHt = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outHt;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_useCasesLocalCref(threadData_t *threadData, modelica_metatype _icases, modelica_metatype _inTree)
{
modelica_metatype _tree = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _icases;
{
modelica_metatype _pats = NULL;
modelica_metatype _cases = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[0] = _inTree;
goto tmp2_done;
}
case 1: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
_pats = tmpMeta[3];
_cases = tmpMeta[2];
omc_Patternm_traversePatternList(threadData, _pats, boxvar_Patternm_usePatternAsBindings, _inTree ,&_tree);
_icases = _cases;
_inTree = _tree;
goto _tailrecursive;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_tree = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _tree;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_usePatternAsBindings(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _inTree, modelica_metatype *out_outTree)
{
modelica_metatype _outPat = NULL;
modelica_metatype _outTree = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outPat = _inPat;
{
volatile modelica_metatype tmp3_1;
tmp3_1 = _inPat;
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 3; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,4) == 0) goto tmp2_end;
tmp3 += 1;
tmpMeta[0] = omc_AvlSetString_add(threadData, _inTree, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inPat), 2))));
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,3,2) == 0) goto tmp2_end;
tmpMeta[0] = omc_AvlSetString_add(threadData, _inTree, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inPat), 2))));
goto tmp2_done;
}
case 2: {
tmpMeta[0] = _inTree;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 3) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_outTree = tmpMeta[0];
_return: OMC_LABEL_UNUSED
if (out_outTree) { *out_outTree = _outTree; }
return _outPat;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_useLocalCrefSubs(threadData_t *threadData, modelica_metatype _isubs, modelica_metatype _inTree)
{
modelica_metatype _tree = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _isubs;
{
modelica_metatype _exp = NULL;
modelica_metatype _subs = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 4; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[0] = _inTree;
goto tmp2_done;
}
case 1: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],1,1) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
_exp = tmpMeta[3];
_subs = tmpMeta[2];
omc_Expression_traverseExpBottomUp(threadData, _exp, boxvar_Patternm_useLocalCref, _inTree ,&_tree);
_isubs = _subs;
_inTree = _tree;
goto _tailrecursive;
goto tmp2_done;
}
case 2: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],2,1) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
_exp = tmpMeta[3];
_subs = tmpMeta[2];
omc_Expression_traverseExpBottomUp(threadData, _exp, boxvar_Patternm_useLocalCref, _inTree ,&_tree);
_isubs = _subs;
_inTree = _tree;
goto _tailrecursive;
goto tmp2_done;
}
case 3: {
tmpMeta[0] = _inTree;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_tree = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _tree;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_useLocalCrefHelper(threadData_t *threadData, modelica_metatype _cr, modelica_metatype _inTree)
{
modelica_metatype _tree = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _cr;
{
modelica_string _name = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cr2 = NULL;
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_name = tmpMeta[1];
_subs = tmpMeta[2];
_tree = omc_Patternm_useLocalCrefSubs(threadData, _subs, _inTree);
tmpMeta[0] = omc_AvlSetString_add(threadData, _tree, _name);
goto tmp2_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_name = tmpMeta[1];
_subs = tmpMeta[2];
_cr2 = tmpMeta[3];
_tree = omc_Patternm_useLocalCrefSubs(threadData, _subs, _inTree);
_tree = omc_AvlSetString_add(threadData, _tree, _name);
_cr = _cr2;
_inTree = _tree;
goto _tailrecursive;
goto tmp2_done;
}
default:
tmp2_default: OMC_LABEL_UNUSED; {
tmpMeta[0] = _inTree;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_tree = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _tree;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_useLocalCref(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _inTree, modelica_metatype *out_outTree)
{
modelica_metatype _outExp = NULL;
modelica_metatype _outTree = NULL;
modelica_metatype tmpMeta[6] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _inExp;
tmp4_2 = _inTree;
{
modelica_metatype _exp = NULL;
modelica_metatype _tree = NULL;
modelica_string _name = NULL;
modelica_metatype _cases = NULL;
modelica_metatype _pat = NULL;
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 5; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_exp = tmp4_1;
_cr = tmpMeta[2];
_tree = tmp4_2;
_tree = omc_Patternm_useLocalCrefHelper(threadData, _cr, _tree);
tmpMeta[0+0] = _exp;
tmpMeta[0+1] = _tree;
goto tmp3_done;
}
case 1: {
modelica_integer tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,13,3) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],1,1) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 4));
tmp6 = mmc_unbox_integer(tmpMeta[5]);
if (0 != tmp6) goto tmp3_end;
_exp = tmp4_1;
_name = tmpMeta[3];
_tree = tmp4_2;
_tree = omc_AvlSetString_add(threadData, _tree, _name);
tmpMeta[0+0] = _exp;
tmpMeta[0+1] = _tree;
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,37,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_exp = tmp4_1;
_pat = tmpMeta[2];
_tree = tmp4_2;
omc_Patternm_traversePattern(threadData, _pat, boxvar_Patternm_usePatternAsBindings, _tree ,&_tree);
tmpMeta[0+0] = _exp;
tmpMeta[0+1] = _tree;
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,33,6) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
_exp = tmp4_1;
_cases = tmpMeta[2];
_tree = tmp4_2;
_tree = omc_Patternm_useCasesLocalCref(threadData, _cases, _tree);
tmpMeta[0+0] = _exp;
tmpMeta[0+1] = _tree;
goto tmp3_done;
}
case 4: {
tmpMeta[0+0] = _inExp;
tmpMeta[0+1] = _inTree;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outExp = tmpMeta[0+0];
_outTree = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_outTree) { *out_outTree = _outTree; }
return _outExp;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_checkDefUsePattern(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _inTpl, modelica_metatype *out_outTpl)
{
modelica_metatype _outPat = NULL;
modelica_metatype _outTpl = NULL;
modelica_metatype tmpMeta[6] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outTpl = _inTpl;
{
modelica_metatype tmp3_1;modelica_metatype tmp3_2;
tmp3_1 = _inPat;
tmp3_2 = _inTpl;
{
modelica_metatype _localsTree = NULL;
modelica_metatype _useTree = NULL;
modelica_string _name = NULL;
modelica_metatype _pat = NULL;
modelica_metatype _info = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 3; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 1));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 2));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 3));
_name = tmpMeta[1];
_pat = tmpMeta[2];
_localsTree = tmpMeta[3];
_useTree = tmpMeta[4];
_info = tmpMeta[5];
if((omc_AvlSetString_hasKey(threadData, _localsTree, _name) && (!omc_AvlSetString_hasKey(threadData, _useTree, _name))))
{
tmpMeta[1] = mmc_mk_cons(_name, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_assertionOrAddSourceMessage(threadData, (!omc_Flags_isSet(threadData, _OMC_LIT3)), _OMC_LIT116, tmpMeta[1], _info);
}
else
{
_pat = _inPat;
}
tmpMeta[0] = _pat;
goto tmp2_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,3,2) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 1));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 2));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 3));
_name = tmpMeta[1];
_pat = tmpMeta[2];
_localsTree = tmpMeta[3];
_useTree = tmpMeta[4];
_info = tmpMeta[5];
if((omc_AvlSetString_hasKey(threadData, _localsTree, _name) && (!omc_AvlSetString_hasKey(threadData, _useTree, _name))))
{
tmpMeta[1] = mmc_mk_cons(_name, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_assertionOrAddSourceMessage(threadData, (!omc_Flags_isSet(threadData, _OMC_LIT3)), _OMC_LIT116, tmpMeta[1], _info);
}
else
{
_pat = _inPat;
}
tmpMeta[0] = _pat;
goto tmp2_done;
}
case 2: {
tmpMeta[0] = omc_Patternm_simplifyPattern(threadData, _inPat, mmc_mk_integer(((modelica_integer) 1)), NULL);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outPat = tmpMeta[0];
_return: OMC_LABEL_UNUSED
if (out_outTpl) { *out_outTpl = _outTpl; }
return _outPat;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_checkDefUse(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _inTpl, modelica_metatype *out_outTpl)
{
modelica_metatype _outExp = NULL;
modelica_metatype _outTpl = NULL;
modelica_metatype tmpMeta[7] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;
tmp4_1 = _inExp;
tmp4_2 = _inTpl;
{
modelica_metatype _localsTree = NULL;
modelica_metatype _useTree = NULL;
modelica_string _name = NULL;
modelica_metatype _pat = NULL;
modelica_metatype _cr = NULL;
modelica_metatype _info = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _extra = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 3; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
_cr = tmpMeta[2];
_ty = tmpMeta[3];
_extra = tmp4_2;
_localsTree = tmpMeta[4];
_useTree = tmpMeta[5];
_info = tmpMeta[6];
tmp4 += 1;
_name = omc_ComponentReference_crefFirstIdent(threadData, _cr);
if((omc_AvlSetString_hasKey(threadData, _localsTree, _name) && (!omc_AvlSetString_hasKey(threadData, _useTree, _name))))
{
tmpMeta[2] = mmc_mk_cons(_name, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_assertionOrAddSourceMessage(threadData, (!omc_Flags_isSet(threadData, _OMC_LIT3)), _OMC_LIT119, tmpMeta[2], _info);
tmpMeta[2] = mmc_mk_box3(9, &DAE_Exp_CREF__desc, _OMC_LIT54, _ty);
_outExp = tmpMeta[2];
}
else
{
_outExp = _inExp;
}
tmpMeta[0+0] = _outExp;
tmpMeta[0+1] = _extra;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,37,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_pat = tmpMeta[2];
_extra = tmp4_2;
_pat = omc_Patternm_traversePattern(threadData, _pat, boxvar_Patternm_checkDefUsePattern, _extra ,&_extra);
tmpMeta[2] = mmc_mk_box2(40, &DAE_Exp_PATTERN__desc, _pat);
tmpMeta[0+0] = tmpMeta[2];
tmpMeta[0+1] = _extra;
goto tmp3_done;
}
case 2: {
tmpMeta[0+0] = _inExp;
tmpMeta[0+1] = _inTpl;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 3) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outExp = tmpMeta[0+0];
_outTpl = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_outTpl) { *out_outTpl = _outTpl; }
return _outExp;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addLocalCrefSubs(threadData_t *threadData, modelica_metatype _isubs, modelica_metatype _iht)
{
modelica_metatype _outHt = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;modelica_metatype tmp3_2;
tmp3_1 = _isubs;
tmp3_2 = _iht;
{
modelica_metatype _exp = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _ht = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 4; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
_ht = tmp3_2;
tmpMeta[0] = _ht;
goto tmp2_done;
}
case 1: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],1,1) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
_exp = tmpMeta[3];
_subs = tmpMeta[2];
_ht = tmp3_2;
omc_Expression_traverseExpBottomUp(threadData, _exp, boxvar_Patternm_addLocalCref, _ht ,&_ht);
_isubs = _subs;
_iht = _ht;
goto _tailrecursive;
goto tmp2_done;
}
case 2: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],2,1) == 0) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
_exp = tmpMeta[3];
_subs = tmpMeta[2];
_ht = tmp3_2;
omc_Expression_traverseExpBottomUp(threadData, _exp, boxvar_Patternm_addLocalCref, _ht ,&_ht);
_isubs = _subs;
_iht = _ht;
goto _tailrecursive;
goto tmp2_done;
}
case 3: {
tmpMeta[0] = _iht;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outHt = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outHt;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addLocalCrefHelper(threadData_t *threadData, modelica_metatype _cr, modelica_metatype _iht)
{
modelica_metatype _ht = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;modelica_metatype tmp3_2;
tmp3_1 = _cr;
tmp3_2 = _iht;
{
modelica_string _name = NULL;
modelica_metatype _subs = NULL;
modelica_metatype _cr2 = NULL;
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
_name = tmpMeta[1];
_subs = tmpMeta[2];
_ht = tmp3_2;
_ht = omc_Patternm_addLocalCrefSubs(threadData, _subs, _ht);
tmpMeta[1] = mmc_mk_box2(0, _name, _OMC_LIT108);
tmpMeta[0] = omc_BaseHashTable_add(threadData, tmpMeta[1], _ht);
goto tmp2_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
_name = tmpMeta[1];
_subs = tmpMeta[2];
_cr2 = tmpMeta[3];
_ht = tmp3_2;
_ht = omc_Patternm_addLocalCrefSubs(threadData, _subs, _ht);
tmpMeta[1] = mmc_mk_box2(0, _name, _OMC_LIT108);
_ht = omc_BaseHashTable_add(threadData, tmpMeta[1], _ht);
_cr = _cr2;
_iht = _ht;
goto _tailrecursive;
goto tmp2_done;
}
default:
tmp2_default: OMC_LABEL_UNUSED; {
tmpMeta[0] = _iht;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_ht = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _ht;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_addLocalCref(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _inHt, modelica_metatype *out_outHt)
{
modelica_metatype _outExp = NULL;
modelica_metatype _outHt = NULL;
modelica_metatype tmpMeta[6] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _inExp;
tmp4_2 = _inHt;
{
modelica_metatype _exp = NULL;
modelica_metatype _ht = NULL;
modelica_string _name = NULL;
modelica_metatype _cases = NULL;
modelica_metatype _pat = NULL;
modelica_metatype _cr = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 5; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_exp = tmp4_1;
_cr = tmpMeta[2];
_ht = tmp4_2;
_ht = omc_Patternm_addLocalCrefHelper(threadData, _cr, _ht);
tmpMeta[0+0] = _exp;
tmpMeta[0+1] = _ht;
goto tmp3_done;
}
case 1: {
modelica_integer tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,13,3) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],1,1) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 4));
tmp6 = mmc_unbox_integer(tmpMeta[5]);
if (0 != tmp6) goto tmp3_end;
_exp = tmp4_1;
_name = tmpMeta[3];
_ht = tmp4_2;
tmpMeta[2] = mmc_mk_box2(0, _name, _OMC_LIT108);
_ht = omc_BaseHashTable_add(threadData, tmpMeta[2], _ht);
tmpMeta[0+0] = _exp;
tmpMeta[0+1] = _ht;
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,37,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_exp = tmp4_1;
_pat = tmpMeta[2];
_ht = tmp4_2;
omc_Patternm_traversePattern(threadData, _pat, boxvar_Patternm_addPatternAsBindings, _ht ,&_ht);
tmpMeta[0+0] = _exp;
tmpMeta[0+1] = _ht;
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,33,6) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
_exp = tmp4_1;
_cases = tmpMeta[2];
_ht = tmp4_2;
_ht = omc_Patternm_addCasesLocalCref(threadData, _cases, _ht);
tmpMeta[0+0] = _exp;
tmpMeta[0+1] = _ht;
goto tmp3_done;
}
case 4: {
tmpMeta[0+0] = _inExp;
tmpMeta[0+1] = _inHt;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outExp = tmpMeta[0+0];
_outHt = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_outHt) { *out_outHt = _outHt; }
return _outExp;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_removePatternAsBinding(threadData_t *threadData, modelica_metatype _inPat, modelica_metatype _inTpl, modelica_metatype *out_outTpl)
{
modelica_metatype _pat = NULL;
modelica_metatype _outTpl = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_pat = _inPat;
_outTpl = _inTpl;
{
volatile modelica_metatype tmp3_1;volatile modelica_metatype tmp3_2;
tmp3_1 = _pat;
tmp3_2 = _inTpl;
{
modelica_metatype _ht = NULL;
modelica_string _id = NULL;
modelica_metatype _info = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 3; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
modelica_boolean tmp5;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,4) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 1));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 2));
_id = tmpMeta[1];
_pat = tmpMeta[2];
_ht = tmpMeta[3];
_info = tmpMeta[4];
tmp3 += 1;
tmp5 = omc_BaseHashTable_hasKey(threadData, _id, _ht);
if (1 != tmp5) goto goto_1;
tmpMeta[1] = mmc_mk_cons(_id, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_assertionOrAddSourceMessage(threadData, (!omc_Flags_isSet(threadData, _OMC_LIT3)), _OMC_LIT116, tmpMeta[1], _info);
tmpMeta[0] = _pat;
goto tmp2_done;
}
case 1: {
modelica_boolean tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,3,2) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 3));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 1));
_id = tmpMeta[1];
_pat = tmpMeta[2];
_ht = tmpMeta[3];
tmp6 = omc_BaseHashTable_hasKey(threadData, _id, _ht);
if (1 != tmp6) goto goto_1;
tmpMeta[0] = _pat;
goto tmp2_done;
}
case 2: {
tmpMeta[0] = omc_Patternm_simplifyPattern(threadData, _inPat, mmc_mk_integer(((modelica_integer) 1)), NULL);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 3) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_pat = tmpMeta[0];
_return: OMC_LABEL_UNUSED
if (out_outTpl) { *out_outTpl = _outTpl; }
return _pat;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_filterUnusedAsBindings(threadData_t *threadData, modelica_metatype _inCases, modelica_metatype _ht)
{
modelica_metatype _outCases = NULL;
modelica_metatype tmpMeta[11] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inCases;
{
modelica_metatype _patterns = NULL;
modelica_metatype _localDecls = NULL;
modelica_metatype _body = NULL;
modelica_metatype _guardPattern = NULL;
modelica_metatype _result = NULL;
modelica_integer _jump;
modelica_metatype _resultInfo = NULL;
modelica_metatype _info = NULL;
modelica_metatype _cases = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
modelica_integer tmp5;
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 3));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 4));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 5));
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 6));
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 7));
tmpMeta[9] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 8));
tmp5 = mmc_unbox_integer(tmpMeta[9]);
tmpMeta[10] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 9));
_patterns = tmpMeta[3];
_guardPattern = tmpMeta[4];
_localDecls = tmpMeta[5];
_body = tmpMeta[6];
_result = tmpMeta[7];
_resultInfo = tmpMeta[8];
_jump = tmp5;
_info = tmpMeta[10];
_cases = tmpMeta[2];
tmpMeta[1] = mmc_mk_box2(0, _ht, _info);
_patterns = omc_Patternm_traversePatternList(threadData, _patterns, boxvar_Patternm_removePatternAsBinding, tmpMeta[1], NULL);
_cases = omc_Patternm_filterUnusedAsBindings(threadData, _cases, _ht);
tmpMeta[2] = mmc_mk_box9(3, &DAE_MatchCase_CASE__desc, _patterns, _guardPattern, _localDecls, _body, _result, _resultInfo, mmc_mk_integer(_jump), _info);
tmpMeta[1] = mmc_mk_cons(tmpMeta[2], _cases);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCases = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCases;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_getUsedLocalCrefs(threadData_t *threadData, modelica_boolean _skipFilterUnusedAsBindings, modelica_metatype _exp, modelica_integer _hashSize)
{
modelica_metatype _ht = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_boolean tmp3_1;modelica_metatype tmp3_2;
tmp3_1 = _skipFilterUnusedAsBindings;
tmp3_2 = _exp;
{
modelica_metatype _cases = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (1 != tmp3_1) goto tmp2_end;
omc_Expression_traverseExpBottomUp(threadData, _exp, boxvar_Patternm_addLocalCref, omc_HashTableStringToPath_emptyHashTableSized(threadData, _hashSize) ,&_ht);
tmpMeta[0] = _ht;
goto tmp2_done;
}
case 1: {
if (0 != tmp3_1) goto tmp2_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp3_2,33,6) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 6));
_cases = tmpMeta[1];
omc_Patternm_traverseCases(threadData, _cases, boxvar_Patternm_addLocalCref, omc_HashTableStringToPath_emptyHashTableSized(threadData, _hashSize) ,&_ht);
tmpMeta[0] = _ht;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_ht = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _ht;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_getUsedLocalCrefs(threadData_t *threadData, modelica_metatype _skipFilterUnusedAsBindings, modelica_metatype _exp, modelica_metatype _hashSize)
{
modelica_integer tmp1;
modelica_integer tmp2;
modelica_metatype _ht = NULL;
tmp1 = mmc_unbox_integer(_skipFilterUnusedAsBindings);
tmp2 = mmc_unbox_integer(_hashSize);
_ht = omc_Patternm_getUsedLocalCrefs(threadData, tmp1, _exp, tmp2);
return _ht;
}
PROTECTED_FUNCTION_STATIC modelica_boolean omc_Patternm_filterUnusedPatterns2(threadData_t *threadData, modelica_metatype _inInputs, modelica_metatype _inAliases, modelica_metatype _inPatternMatrix, modelica_boolean _change, modelica_metatype _inputsAcc, modelica_metatype _aliasesAcc, modelica_metatype _patternMatrixAcc, modelica_metatype *out_outInputs, modelica_metatype *out_outAliases, modelica_metatype *out_outPatternMatrix)
{
modelica_boolean _outChange;
modelica_metatype _outInputs = NULL;
modelica_metatype _outAliases = NULL;
modelica_metatype _outPatternMatrix = NULL;
modelica_boolean tmp1_c0 __attribute__((unused)) = 0;
modelica_metatype tmpMeta[10] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;volatile modelica_metatype tmp4_3;volatile modelica_boolean tmp4_4;
tmp4_1 = _inInputs;
tmp4_2 = _inAliases;
tmp4_3 = _inPatternMatrix;
tmp4_4 = _change;
{
modelica_metatype _e = NULL;
modelica_metatype _pats = NULL;
modelica_metatype _inputs = NULL;
modelica_metatype _patternMatrix = NULL;
modelica_metatype _alias = NULL;
modelica_metatype _aliases = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 4; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (1 != tmp4_4) goto tmp3_end;
if (!listEmpty(tmp4_1)) goto tmp3_end;
if (!listEmpty(tmp4_2)) goto tmp3_end;
if (!listEmpty(tmp4_3)) goto tmp3_end;
tmp4 += 2;
tmp1_c0 = 1;
tmpMeta[0+1] = listReverse(_inputsAcc);
tmpMeta[0+2] = listReverse(_aliasesAcc);
tmpMeta[0+3] = listReverse(_patternMatrixAcc);
goto tmp3_done;
}
case 1: {
modelica_integer tmp6;
modelica_boolean tmp7;
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[4] = MMC_CAR(tmp4_1);
tmpMeta[5] = MMC_CDR(tmp4_1);
if (listEmpty(tmp4_2)) goto tmp3_end;
tmpMeta[6] = MMC_CAR(tmp4_2);
tmpMeta[7] = MMC_CDR(tmp4_2);
if (listEmpty(tmp4_3)) goto tmp3_end;
tmpMeta[8] = MMC_CAR(tmp4_3);
tmpMeta[9] = MMC_CDR(tmp4_3);
_e = tmpMeta[4];
_inputs = tmpMeta[5];
_aliases = tmpMeta[7];
_pats = tmpMeta[8];
_patternMatrix = tmpMeta[9];
omc_Expression_traverseExpBottomUp(threadData, _e, boxvar_Expression_hasNoSideEffects, mmc_mk_boolean(1), &tmpMeta[4]);
tmp6 = mmc_unbox_integer(tmpMeta[4]);
if (1 != tmp6) goto goto_2;
tmp7 = omc_Patternm_allPatternsWild(threadData, _pats);
if (1 != tmp7) goto goto_2;
tmp1_c0 = omc_Patternm_filterUnusedPatterns2(threadData, _inputs, _aliases, _patternMatrix, 1, _inputsAcc, _aliasesAcc, _patternMatrixAcc, &tmpMeta[0+1], &tmpMeta[0+2], &tmpMeta[0+3]);
goto tmp3_done;
}
case 2: {
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[4] = MMC_CAR(tmp4_1);
tmpMeta[5] = MMC_CDR(tmp4_1);
if (listEmpty(tmp4_2)) goto tmp3_end;
tmpMeta[6] = MMC_CAR(tmp4_2);
tmpMeta[7] = MMC_CDR(tmp4_2);
if (listEmpty(tmp4_3)) goto tmp3_end;
tmpMeta[8] = MMC_CAR(tmp4_3);
tmpMeta[9] = MMC_CDR(tmp4_3);
_e = tmpMeta[4];
_inputs = tmpMeta[5];
_alias = tmpMeta[6];
_aliases = tmpMeta[7];
_pats = tmpMeta[8];
_patternMatrix = tmpMeta[9];
tmpMeta[4] = mmc_mk_cons(_e, _inputsAcc);
tmpMeta[5] = mmc_mk_cons(_alias, _aliasesAcc);
tmpMeta[6] = mmc_mk_cons(_pats, _patternMatrixAcc);
tmp1_c0 = omc_Patternm_filterUnusedPatterns2(threadData, _inputs, _aliases, _patternMatrix, _change, tmpMeta[4], tmpMeta[5], tmpMeta[6], &tmpMeta[0+1], &tmpMeta[0+2], &tmpMeta[0+3]);
goto tmp3_done;
}
case 3: {
tmpMeta[4] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[5] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[6] = MMC_REFSTRUCTLIT(mmc_nil);
tmp1_c0 = 0;
tmpMeta[0+1] = tmpMeta[4];
tmpMeta[0+2] = tmpMeta[5];
tmpMeta[0+3] = tmpMeta[6];
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 4) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outChange = tmp1_c0;
_outInputs = tmpMeta[0+1];
_outAliases = tmpMeta[0+2];
_outPatternMatrix = tmpMeta[0+3];
_return: OMC_LABEL_UNUSED
if (out_outInputs) { *out_outInputs = _outInputs; }
if (out_outAliases) { *out_outAliases = _outAliases; }
if (out_outPatternMatrix) { *out_outPatternMatrix = _outPatternMatrix; }
return _outChange;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_filterUnusedPatterns2(threadData_t *threadData, modelica_metatype _inInputs, modelica_metatype _inAliases, modelica_metatype _inPatternMatrix, modelica_metatype _change, modelica_metatype _inputsAcc, modelica_metatype _aliasesAcc, modelica_metatype _patternMatrixAcc, modelica_metatype *out_outInputs, modelica_metatype *out_outAliases, modelica_metatype *out_outPatternMatrix)
{
modelica_integer tmp1;
modelica_boolean _outChange;
modelica_metatype out_outChange;
tmp1 = mmc_unbox_integer(_change);
_outChange = omc_Patternm_filterUnusedPatterns2(threadData, _inInputs, _inAliases, _inPatternMatrix, tmp1, _inputsAcc, _aliasesAcc, _patternMatrixAcc, out_outInputs, out_outAliases, out_outPatternMatrix);
out_outChange = mmc_mk_icon(_outChange);
return out_outChange;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_setCasePatternsCheckZero(threadData_t *threadData, modelica_metatype _inCases, modelica_metatype _patternMatrix)
{
modelica_metatype _outCases = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;modelica_metatype tmp3_2;
tmp3_1 = _inCases;
tmp3_2 = _patternMatrix;
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 3; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
if (!listEmpty(tmp3_2)) goto tmp2_end;
tmpMeta[0] = _inCases;
goto tmp2_done;
}
case 1: {
if (!listEmpty(tmp3_2)) goto tmp2_end;
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0] = omc_List_map1(threadData, _inCases, boxvar_Patternm_setCasePatterns, tmpMeta[1]);
goto tmp2_done;
}
case 2: {
tmpMeta[0] = omc_List_threadMap(threadData, _inCases, _patternMatrix, boxvar_Patternm_setCasePatterns);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCases = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCases;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_filterUnusedPatterns(threadData_t *threadData, modelica_metatype _inputs, modelica_metatype _inAliases, modelica_metatype _inCases, modelica_metatype *out_outAliases, modelica_metatype *out_outCases)
{
modelica_metatype _outInputs = NULL;
modelica_metatype _outAliases = NULL;
modelica_metatype _outCases = NULL;
modelica_metatype tmpMeta[9] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;
tmp4_1 = _inCases;
{
modelica_metatype _patternMatrix = NULL;
modelica_metatype _cases = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
modelica_boolean tmp6;
_cases = tmp4_1;
_patternMatrix = omc_List_transposeList(threadData, omc_List_map(threadData, _cases, boxvar_Patternm_getCasePatterns));
tmpMeta[6] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[7] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[8] = MMC_REFSTRUCTLIT(mmc_nil);
tmp6 = omc_Patternm_filterUnusedPatterns2(threadData, _inputs, _inAliases, _patternMatrix, 0, tmpMeta[6], tmpMeta[7], tmpMeta[8], &tmpMeta[3], &tmpMeta[4], &tmpMeta[5]);
if (1 != tmp6) goto goto_2;
_outInputs = tmpMeta[3];
_outAliases = tmpMeta[4];
_patternMatrix = tmpMeta[5];
_patternMatrix = omc_List_transposeList(threadData, _patternMatrix);
_cases = omc_Patternm_setCasePatternsCheckZero(threadData, _cases, _patternMatrix);
tmpMeta[0+0] = _outInputs;
tmpMeta[0+1] = _outAliases;
tmpMeta[0+2] = _cases;
goto tmp3_done;
}
case 1: {
tmpMeta[0+0] = _inputs;
tmpMeta[0+1] = _inAliases;
tmpMeta[0+2] = _inCases;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 2) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outInputs = tmpMeta[0+0];
_outAliases = tmpMeta[0+1];
_outCases = tmpMeta[0+2];
_return: OMC_LABEL_UNUSED
if (out_outAliases) { *out_outAliases = _outAliases; }
if (out_outCases) { *out_outCases = _outCases; }
return _outInputs;
}
PROTECTED_FUNCTION_STATIC modelica_integer omc_Patternm_findMinMod(threadData_t *threadData, modelica_metatype _inIxs, modelica_integer _inMod)
{
modelica_integer _outMod;
modelica_integer tmp1 = 0;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;volatile modelica_integer tmp4_2;
tmp4_1 = _inIxs;
tmp4_2 = _inMod;
{
modelica_metatype _ixs = NULL;
modelica_integer _mod;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
_ixs = tmp4_1;
_mod = tmp4_2;
_ixs = omc_List_map1(threadData, _ixs, boxvar_intMod, mmc_mk_integer(_mod));
_ixs = omc_List_sort(threadData, _ixs, boxvar_intLt);
tmpMeta[0] = omc_List_sortedDuplicates(threadData, _ixs, boxvar_intEq);
if (!listEmpty(tmpMeta[0])) goto goto_2;
tmp1 = _mod;
goto tmp3_done;
}
case 1: {
modelica_boolean tmp6;
tmp6 = (_inMod < ((modelica_integer) 65536));
if (1 != tmp6) goto goto_2;
tmp1 = omc_Patternm_findMinMod(threadData, _inIxs, (((modelica_integer) 2)) * (_inMod));
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 2) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outMod = tmp1;
_return: OMC_LABEL_UNUSED
return _outMod;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_findMinMod(threadData_t *threadData, modelica_metatype _inIxs, modelica_metatype _inMod)
{
modelica_integer tmp1;
modelica_integer _outMod;
modelica_metatype out_outMod;
tmp1 = mmc_unbox_integer(_inMod);
_outMod = omc_Patternm_findMinMod(threadData, _inIxs, tmp1);
out_outMod = mmc_mk_icon(_outMod);
return out_outMod;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_findPatternToConvertToSwitch2(threadData_t *threadData, modelica_metatype _ipats, modelica_metatype _ixs, modelica_metatype _ity, modelica_boolean _allSubPatternsMatch, modelica_integer _numPatternsInMatrix, modelica_integer *out_extraarg)
{
modelica_metatype _outTy = NULL;
modelica_integer _extraarg;
modelica_integer tmp1_c1 __attribute__((unused)) = 0;
modelica_metatype tmpMeta[6] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;modelica_boolean tmp4_3;modelica_integer tmp4_4;
tmp4_1 = _ipats;
tmp4_2 = _ity;
tmp4_3 = _allSubPatternsMatch;
tmp4_4 = _numPatternsInMatrix;
{
modelica_integer _ix;
modelica_string _str = NULL;
modelica_metatype _pats = NULL;
modelica_metatype _subpats = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 7; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
modelica_boolean tmp6;
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_1);
tmpMeta[3] = MMC_CDR(tmp4_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],1,2) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[4],2,1) == 0) goto tmp3_end;
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 2));
_str = tmpMeta[5];
_pats = tmpMeta[3];
_ix = stringHashDjb2Mod(_str, ((modelica_integer) 65536));
tmp6 = listMember(mmc_mk_integer(_ix), _ixs);
if (0 != tmp6) goto goto_2;
tmpMeta[2] = mmc_mk_cons(mmc_mk_integer(_ix), _ixs);
_ipats = _pats;
_ixs = tmpMeta[2];
_ity = _OMC_LIT120;
goto _tailrecursive;
goto tmp3_done;
}
case 1: {
modelica_integer tmp7;
modelica_boolean tmp8;
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_1);
tmpMeta[3] = MMC_CDR(tmp4_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],7,6) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
tmp7 = mmc_unbox_integer(tmpMeta[4]);
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 4));
_ix = tmp7;
_subpats = tmpMeta[5];
_pats = tmpMeta[3];
tmp8 = listMember(mmc_mk_integer(_ix), _ixs);
if (0 != tmp8) goto goto_2;
tmpMeta[2] = mmc_mk_cons(mmc_mk_integer(_ix), _ixs);
_ipats = _pats;
_ixs = tmpMeta[2];
_ity = _OMC_LIT122;
_allSubPatternsMatch = (_allSubPatternsMatch && omc_Patternm_allPatternsAlwaysMatch(threadData, _subpats));
goto _tailrecursive;
goto tmp3_done;
}
case 2: {
modelica_integer tmp9;
modelica_boolean tmp10;
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_1);
tmpMeta[3] = MMC_CDR(tmp4_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],1,2) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[4],0,1) == 0) goto tmp3_end;
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 2));
tmp9 = mmc_unbox_integer(tmpMeta[5]);
_ix = tmp9;
_pats = tmpMeta[3];
tmp10 = listMember(mmc_mk_integer(_ix), _ixs);
if (0 != tmp10) goto goto_2;
tmpMeta[2] = mmc_mk_cons(mmc_mk_integer(_ix), _ixs);
_ipats = _pats;
_ixs = tmpMeta[2];
_ity = _OMC_LIT123;
goto _tailrecursive;
goto tmp3_done;
}
case 3: {
modelica_boolean tmp11;
if (!listEmpty(tmp4_1)) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,1) == 0) goto tmp3_end;
tmp11 = (listLength(_ixs) > ((modelica_integer) 11));
if (1 != tmp11) goto goto_2;
_ix = omc_Patternm_findMinMod(threadData, _ixs, ((modelica_integer) 1));
tmpMeta[0+0] = _OMC_LIT120;
tmp1_c1 = _ix;
goto tmp3_done;
}
case 4: {
modelica_boolean tmp12;
if (1 != tmp4_4) goto tmp3_end;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,1) == 0) goto tmp3_end;
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_1);
tmpMeta[3] = MMC_CDR(tmp4_1);
if (!listEmpty(tmpMeta[3])) goto tmp3_end;
tmp12 = (listLength(_ixs) > ((modelica_integer) 11));
if (1 != tmp12) goto goto_2;
_ix = omc_Patternm_findMinMod(threadData, _ixs, ((modelica_integer) 1));
tmpMeta[0+0] = _OMC_LIT120;
tmp1_c1 = _ix;
goto tmp3_done;
}
case 5: {
if (!listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[0+0] = _ity;
tmp1_c1 = ((modelica_integer) 0);
goto tmp3_done;
}
case 6: {
if (1 != tmp4_3) goto tmp3_end;
if (1 != tmp4_4) goto tmp3_end;
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_1);
tmpMeta[3] = MMC_CDR(tmp4_1);
if (!listEmpty(tmpMeta[3])) goto tmp3_end;
tmpMeta[0+0] = _ity;
tmp1_c1 = ((modelica_integer) 0);
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outTy = tmpMeta[0+0];
_extraarg = tmp1_c1;
_return: OMC_LABEL_UNUSED
if (out_extraarg) { *out_extraarg = _extraarg; }
return _outTy;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_findPatternToConvertToSwitch2(threadData_t *threadData, modelica_metatype _ipats, modelica_metatype _ixs, modelica_metatype _ity, modelica_metatype _allSubPatternsMatch, modelica_metatype _numPatternsInMatrix, modelica_metatype *out_extraarg)
{
modelica_integer tmp1;
modelica_integer tmp2;
modelica_integer _extraarg;
modelica_metatype _outTy = NULL;
tmp1 = mmc_unbox_integer(_allSubPatternsMatch);
tmp2 = mmc_unbox_integer(_numPatternsInMatrix);
_outTy = omc_Patternm_findPatternToConvertToSwitch2(threadData, _ipats, _ixs, _ity, tmp1, tmp2, &_extraarg);
if (out_extraarg) { *out_extraarg = mmc_mk_icon(_extraarg); }
return _outTy;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_findPatternToConvertToSwitch(threadData_t *threadData, modelica_metatype _inPatternMatrix, modelica_integer _index, modelica_integer _numPatternsInMatrix, modelica_metatype _info)
{
modelica_metatype _tpl = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp3_1;
tmp3_1 = _inPatternMatrix;
{
modelica_metatype _pats = NULL;
modelica_metatype _ty = NULL;
modelica_integer _extraarg;
modelica_metatype _patternMatrix = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
if (optionNone(tmpMeta[1])) goto tmp2_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 1));
_pats = tmpMeta[3];
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
_ty = omc_Patternm_findPatternToConvertToSwitch2(threadData, _pats, tmpMeta[1], _OMC_LIT121, 1, _numPatternsInMatrix ,&_extraarg);
tmpMeta[1] = mmc_mk_box3(0, mmc_mk_integer(_index), _ty, mmc_mk_integer(_extraarg));
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
if (listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[1] = MMC_CAR(tmp3_1);
tmpMeta[2] = MMC_CDR(tmp3_1);
_patternMatrix = tmpMeta[2];
tmpMeta[0] = omc_Patternm_findPatternToConvertToSwitch(threadData, _patternMatrix, ((modelica_integer) 1) + _index, _numPatternsInMatrix, _info);
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 2) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_tpl = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _tpl;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_findPatternToConvertToSwitch(threadData_t *threadData, modelica_metatype _inPatternMatrix, modelica_metatype _index, modelica_metatype _numPatternsInMatrix, modelica_metatype _info)
{
modelica_integer tmp1;
modelica_integer tmp2;
modelica_metatype _tpl = NULL;
tmp1 = mmc_unbox_integer(_index);
tmp2 = mmc_unbox_integer(_numPatternsInMatrix);
_tpl = omc_Patternm_findPatternToConvertToSwitch(threadData, _inPatternMatrix, tmp1, tmp2, _info);
return _tpl;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_removeWildPatternColumnsFromMatrix(threadData_t *threadData, modelica_metatype _inPatternMatrix, modelica_metatype _inAcc, modelica_integer _inNumAcc, modelica_integer *out_numNonEmptyColumns)
{
modelica_metatype _optPatternMatrix = NULL;
modelica_integer _numNonEmptyColumns;
modelica_integer tmp1_c1 __attribute__((unused)) = 0;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;modelica_integer tmp4_3;
tmp4_1 = _inPatternMatrix;
tmp4_2 = _inAcc;
tmp4_3 = _inNumAcc;
{
modelica_boolean _alwaysMatch;
modelica_metatype _pats = NULL;
modelica_metatype _optPats = NULL;
modelica_metatype _patternMatrix = NULL;
modelica_metatype _acc = NULL;
modelica_integer _numAcc;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_1)) goto tmp3_end;
_acc = tmp4_2;
_numAcc = tmp4_3;
tmpMeta[0+0] = listReverse(_acc);
tmp1_c1 = _numAcc;
goto tmp3_done;
}
case 1: {
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_1);
tmpMeta[3] = MMC_CDR(tmp4_1);
_pats = tmpMeta[2];
_patternMatrix = tmpMeta[3];
_acc = tmp4_2;
_numAcc = tmp4_3;
_alwaysMatch = omc_Patternm_allPatternsAlwaysMatch(threadData, omc_List_stripLast(threadData, _pats));
_optPats = (_alwaysMatch?mmc_mk_none():mmc_mk_some(_pats));
_numAcc = (_alwaysMatch?_numAcc:((modelica_integer) 1) + _numAcc);
tmpMeta[2] = mmc_mk_cons(_optPats, _acc);
_inPatternMatrix = _patternMatrix;
_inAcc = tmpMeta[2];
_inNumAcc = _numAcc;
goto _tailrecursive;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_optPatternMatrix = tmpMeta[0+0];
_numNonEmptyColumns = tmp1_c1;
_return: OMC_LABEL_UNUSED
if (out_numNonEmptyColumns) { *out_numNonEmptyColumns = _numNonEmptyColumns; }
return _optPatternMatrix;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_removeWildPatternColumnsFromMatrix(threadData_t *threadData, modelica_metatype _inPatternMatrix, modelica_metatype _inAcc, modelica_metatype _inNumAcc, modelica_metatype *out_numNonEmptyColumns)
{
modelica_integer tmp1;
modelica_integer _numNonEmptyColumns;
modelica_metatype _optPatternMatrix = NULL;
tmp1 = mmc_unbox_integer(_inNumAcc);
_optPatternMatrix = omc_Patternm_removeWildPatternColumnsFromMatrix(threadData, _inPatternMatrix, _inAcc, tmp1, &_numNonEmptyColumns);
if (out_numNonEmptyColumns) { *out_numNonEmptyColumns = mmc_mk_icon(_numNonEmptyColumns); }
return _optPatternMatrix;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_optimizeSwitchedMatchCases(threadData_t *threadData, modelica_metatype _inMatchType, modelica_metatype _inCases)
{
modelica_metatype _outCases = NULL;
modelica_metatype tmpMeta[8] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _inMatchType;
{
modelica_metatype _pat = NULL;
modelica_metatype _patl = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,2,1) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
if (optionNone(tmpMeta[1])) goto tmp2_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[1]), 1));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[3],25,1) == 0) goto tmp2_end;
{
modelica_metatype __omcQ_24tmpVar1;
modelica_metatype* tmp5;
modelica_metatype __omcQ_24tmpVar0;
int tmp10;
modelica_metatype _c_loopVar = 0;
modelica_metatype _c;
_c_loopVar = _inCases;
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
__omcQ_24tmpVar1 = tmpMeta[2];
tmp5 = &__omcQ_24tmpVar1;
while(1) {
tmp10 = 1;
if (!listEmpty(_c_loopVar)) {
_c = MMC_CAR(_c_loopVar);
_c_loopVar = MMC_CDR(_c_loopVar);
tmp10--;
}
if (tmp10 == 0) {
{
modelica_metatype tmp8_1;
tmp8_1 = _c;
{
volatile mmc_switch_type tmp8;
int tmp9;
tmp8 = 0;
for (; tmp8 < 2; tmp8++) {
switch (MMC_SWITCH_CAST(tmp8)) {
case 0: {
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp8_1), 2));
if (listEmpty(tmpMeta[4])) goto tmp7_end;
tmpMeta[5] = MMC_CAR(tmpMeta[4]);
tmpMeta[6] = MMC_CDR(tmpMeta[4]);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[5],7,6) == 0) goto tmp7_end;
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[5]), 4));
if (!listEmpty(tmpMeta[6])) goto tmp7_end;
_pat = tmpMeta[5];
_patl = tmpMeta[7];
if(omc_Patternm_allPatternsWild(threadData, _patl))
{
tmpMeta[4] = MMC_TAGPTR(mmc_alloc_words(8));
memcpy(MMC_UNTAGPTR(tmpMeta[4]), MMC_UNTAGPTR(_pat), 8*sizeof(modelica_metatype));
((modelica_metatype*)MMC_UNTAGPTR(tmpMeta[4]))[7] = mmc_mk_boolean(1);
_pat = tmpMeta[4];
tmpMeta[5] = mmc_mk_cons(_pat, MMC_REFSTRUCTLIT(mmc_nil));
tmpMeta[4] = MMC_TAGPTR(mmc_alloc_words(10));
memcpy(MMC_UNTAGPTR(tmpMeta[4]), MMC_UNTAGPTR(_c), 10*sizeof(modelica_metatype));
((modelica_metatype*)MMC_UNTAGPTR(tmpMeta[4]))[2] = tmpMeta[5];
_c = tmpMeta[4];
}
tmpMeta[3] = _c;
goto tmp7_done;
}
case 1: {
tmpMeta[3] = _c;
goto tmp7_done;
}
}
goto tmp7_end;
tmp7_end: ;
}
goto goto_6;
goto_6:;
goto goto_1;
goto tmp7_done;
tmp7_done:;
}
}__omcQ_24tmpVar0 = tmpMeta[3];
*tmp5 = mmc_mk_cons(__omcQ_24tmpVar0,0);
tmp5 = &MMC_CDR(*tmp5);
} else if (tmp10 == 1) {
break;
} else {
goto goto_1;
}
}
*tmp5 = mmc_mk_nil();
tmpMeta[1] = __omcQ_24tmpVar1;
}
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 1: {
tmpMeta[0] = _inCases;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outCases = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outCases;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_optimizeMatchToSwitch(threadData_t *threadData, modelica_metatype _matchTy, modelica_metatype _cases, modelica_metatype _info, modelica_metatype *out_outCases)
{
modelica_metatype _outType = NULL;
modelica_metatype _outCases = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;
tmp4_1 = _matchTy;
{
modelica_metatype _tpl = NULL;
modelica_metatype _patternMatrix = NULL;
modelica_metatype _optPatternMatrix = NULL;
modelica_integer _numNonEmptyColumns;
modelica_string _str = NULL;
modelica_metatype _ty = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 3; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,0) == 0) goto tmp3_end;
tmpMeta[0+0] = _OMC_LIT124;
tmpMeta[0+1] = _cases;
goto tmp3_done;
}
case 1: {
modelica_boolean tmp6;
tmp6 = (listLength(_cases) > ((modelica_integer) 2));
if (1 != tmp6) goto goto_2;
{
modelica_metatype _c;
for (tmpMeta[2] = _cases; !listEmpty(tmpMeta[2]); tmpMeta[2]=MMC_CDR(tmpMeta[2]))
{
_c = MMC_CAR(tmpMeta[2]);
tmpMeta[3] = _c;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 3));
if (!optionNone(tmpMeta[4])) goto goto_2;
}
}
_patternMatrix = omc_List_transposeList(threadData, omc_List_map(threadData, _cases, boxvar_Patternm_getCasePatterns));
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
_optPatternMatrix = omc_Patternm_removeWildPatternColumnsFromMatrix(threadData, _patternMatrix, tmpMeta[2], ((modelica_integer) 0) ,&_numNonEmptyColumns);
_tpl = omc_Patternm_findPatternToConvertToSwitch(threadData, _optPatternMatrix, ((modelica_integer) 1), _numNonEmptyColumns, _info);
tmpMeta[2] = _tpl;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
_ty = tmpMeta[3];
_str = omc_Types_unparseType(threadData, _ty);
tmpMeta[2] = mmc_mk_cons(_str, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_assertionOrAddSourceMessage(threadData, (!omc_Flags_isSet(threadData, _OMC_LIT3)), _OMC_LIT127, tmpMeta[2], _info);
tmpMeta[2] = mmc_mk_box2(5, &DAE_MatchType_MATCH__desc, mmc_mk_some(_tpl));
_outType = tmpMeta[2];
_outCases = omc_Patternm_optimizeSwitchedMatchCases(threadData, _outType, _cases);
tmpMeta[0+0] = _outType;
tmpMeta[0+1] = _outCases;
goto tmp3_done;
}
case 2: {
tmpMeta[0+0] = _OMC_LIT128;
tmpMeta[0+1] = _cases;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 3) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outType = tmpMeta[0+0];
_outCases = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_outCases) { *out_outCases = _outCases; }
return _outType;
}
PROTECTED_FUNCTION_STATIC void omc_Patternm_checkConstantMatchInputs(threadData_t *threadData, modelica_metatype _inputs, modelica_metatype _info)
{
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype _i;
for (tmpMeta[0] = _inputs; !listEmpty(tmpMeta[0]); tmpMeta[0]=MMC_CDR(tmpMeta[0]))
{
_i = MMC_CAR(tmpMeta[0]);
if(omc_Expression_isConstValue(threadData, _i))
{
tmpMeta[1] = mmc_mk_cons(omc_ExpressionDump_printExpStr(threadData, _i), MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_addSourceMessage(threadData, _OMC_LIT131, tmpMeta[1], _info);
}
}
}
_return: OMC_LABEL_UNUSED
return;
}
DLLExport
modelica_metatype omc_Patternm_elabMatchExpression(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _matchExp, modelica_boolean _impl, modelica_boolean _performVectorization, modelica_metatype _inPrefix, modelica_metatype _info, modelica_metatype *out_outExp, modelica_metatype *out_outProperties)
{
modelica_metatype _outCache = NULL;
modelica_metatype _outExp = NULL;
modelica_metatype _outProperties = NULL;
modelica_integer _numError;
modelica_metatype tmpMeta[10] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_numError = omc_Error_getNumErrorMessages(threadData);
{
volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;volatile modelica_metatype tmp4_3;volatile modelica_metatype tmp4_4;
tmp4_1 = _inCache;
tmp4_2 = _inEnv;
tmp4_3 = _matchExp;
tmp4_4 = _inPrefix;
{
modelica_metatype _matchTy = NULL;
modelica_metatype _inExp = NULL;
modelica_metatype _inExps = NULL;
modelica_metatype _decls = NULL;
modelica_metatype _cases = NULL;
modelica_metatype _matchDecls = NULL;
modelica_metatype _pre = NULL;
modelica_metatype _elabExps = NULL;
modelica_metatype _elabCases = NULL;
modelica_metatype _tys = NULL;
modelica_metatype _prop = NULL;
modelica_metatype _elabProps = NULL;
modelica_metatype _resType = NULL;
modelica_metatype _et = NULL;
modelica_string _str = NULL;
modelica_metatype _exp = NULL;
modelica_metatype _ht = NULL;
modelica_metatype _elabMatchTy = NULL;
modelica_metatype _cache = NULL;
modelica_metatype _env = NULL;
modelica_integer _hashSize;
modelica_metatype _inputAliases = NULL;
modelica_metatype _inputAliasesAndCrefs = NULL;
modelica_metatype _declsTree = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_3,21,5) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 3));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 4));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 5));
_matchTy = tmpMeta[3];
_inExp = tmpMeta[4];
_decls = tmpMeta[5];
_cases = tmpMeta[6];
_cache = tmp4_1;
_env = tmp4_2;
_pre = tmp4_4;
_inExps = omc_Patternm_convertExpToPatterns(threadData, _inExp);
_inExps = omc_List_map__3(threadData, _inExps, boxvar_Patternm_getInputAsBinding ,&_inputAliases ,&_inputAliasesAndCrefs);
_cache = omc_Static_elabExpList(threadData, _cache, _env, _inExps, _impl, _performVectorization, _pre, _info, _OMC_LIT121 ,&_elabExps ,&_elabProps);
tmpMeta[9] = omc_Patternm_addLocalDecls(threadData, _cache, _env, _decls, _OMC_LIT132, _impl, _info, &tmpMeta[3]);
_cache = tmpMeta[9];
if (optionNone(tmpMeta[3])) goto goto_2;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 1));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 1));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 2));
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[6]), 2));
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 3));
_env = tmpMeta[5];
_matchDecls = tmpMeta[7];
_declsTree = tmpMeta[8];
_tys = omc_List_map(threadData, _elabProps, boxvar_Types_getPropType);
_env = omc_Patternm_addAliasesToEnv(threadData, _env, _tys, _inputAliases, _info);
_cache = omc_Patternm_elabMatchCases(threadData, _cache, _env, _cases, _tys, _inputAliasesAndCrefs, _declsTree, _impl, _performVectorization, _pre, _info ,&_elabCases ,&_resType);
tmpMeta[3] = mmc_mk_box3(3, &DAE_Properties_PROP__desc, _resType, _OMC_LIT133);
_prop = tmpMeta[3];
_et = omc_Types_simplifyType(threadData, _resType);
_elabExps = omc_Patternm_filterUnusedPatterns(threadData, _elabExps, _inputAliases, _elabCases ,&_inputAliases ,&_elabCases);
tmpMeta[3] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[4] = MMC_REFSTRUCTLIT(mmc_nil);
_elabCases = omc_Patternm_caseDeadCodeElimination(threadData, _matchTy, _elabCases, tmpMeta[3], tmpMeta[4], 0);
_matchTy = omc_Patternm_optimizeContinueToMatch(threadData, _matchTy, _elabCases, _info);
_elabCases = omc_Patternm_optimizeContinueJumps(threadData, _matchTy, _elabCases);
_hashSize = omc_Util_nextPrime(threadData, listLength(_matchDecls));
tmpMeta[3] = mmc_mk_box7(36, &DAE_Exp_MATCHEXPRESSION__desc, _OMC_LIT124, _elabExps, _inputAliases, _matchDecls, _elabCases, _et);
_ht = omc_Patternm_getUsedLocalCrefs(threadData, omc_Flags_isSet(threadData, _OMC_LIT136), tmpMeta[3], _hashSize);
tmpMeta[3] = MMC_REFSTRUCTLIT(mmc_nil);
_matchDecls = omc_Patternm_filterUnusedDecls(threadData, _matchDecls, _ht, tmpMeta[3], omc_HashTableStringToPath_emptyHashTableSized(threadData, _hashSize) ,&_ht);
_elabExps = omc_Patternm_filterUnusedPatterns(threadData, _elabExps, _inputAliases, _elabCases ,&_inputAliases ,&_elabCases);
_elabMatchTy = omc_Patternm_optimizeMatchToSwitch(threadData, _matchTy, _elabCases, _info ,&_elabCases);
omc_Patternm_checkConstantMatchInputs(threadData, _elabExps, _info);
tmpMeta[3] = mmc_mk_box7(36, &DAE_Exp_MATCHEXPRESSION__desc, _elabMatchTy, _elabExps, _inputAliases, _matchDecls, _elabCases, _et);
_exp = tmpMeta[3];
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = _exp;
tmpMeta[0+2] = _prop;
goto tmp3_done;
}
case 1: {
modelica_boolean tmp6;
tmp6 = (_numError == omc_Error_getNumErrorMessages(threadData));
if (1 != tmp6) goto goto_2;
_str = omc_Dump_printExpStr(threadData, _matchExp);
tmpMeta[3] = mmc_mk_cons(_str, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_addSourceMessage(threadData, _OMC_LIT139, tmpMeta[3], _info);
goto goto_2;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 2) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outCache = tmpMeta[0+0];
_outExp = tmpMeta[0+1];
_outProperties = tmpMeta[0+2];
_return: OMC_LABEL_UNUSED
if (out_outExp) { *out_outExp = _outExp; }
if (out_outProperties) { *out_outProperties = _outProperties; }
return _outCache;
}
modelica_metatype boxptr_Patternm_elabMatchExpression(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _inEnv, modelica_metatype _matchExp, modelica_metatype _impl, modelica_metatype _performVectorization, modelica_metatype _inPrefix, modelica_metatype _info, modelica_metatype *out_outExp, modelica_metatype *out_outProperties)
{
modelica_integer tmp1;
modelica_integer tmp2;
modelica_metatype _outCache = NULL;
tmp1 = mmc_unbox_integer(_impl);
tmp2 = mmc_unbox_integer(_performVectorization);
_outCache = omc_Patternm_elabMatchExpression(threadData, _inCache, _inEnv, _matchExp, tmp1, tmp2, _inPrefix, _info, out_outExp, out_outProperties);
return _outCache;
}
DLLExport
modelica_string omc_Patternm_patternStr(threadData_t *threadData, modelica_metatype _pattern)
{
modelica_string _str = NULL;
modelica_string tmp1 = 0;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;
tmp4_1 = _pattern;
{
modelica_metatype _pats = NULL;
modelica_metatype _fields = NULL;
modelica_metatype _patsStr = NULL;
modelica_metatype _exp = NULL;
modelica_metatype _pat = NULL;
modelica_metatype _head = NULL;
modelica_metatype _tail = NULL;
modelica_string _id = NULL;
modelica_metatype _namedpats = NULL;
modelica_metatype _name = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 13; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,0) == 0) goto tmp3_end;
tmp4 += 11;
tmp1 = _OMC_LIT140;
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],0,0) == 0) goto tmp3_end;
_id = tmpMeta[0];
tmp4 += 8;
tmp1 = _id;
goto tmp3_done;
}
case 2: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,2) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[1],0,0) == 0) goto tmp3_end;
_id = tmpMeta[0];
tmp4 += 8;
tmp1 = _id;
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,9,1) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_pat = tmpMeta[0];
tmp4 += 8;
_str = omc_Patternm_patternStr(threadData, _pat);
tmpMeta[0] = stringAppend(_OMC_LIT141,_str);
tmpMeta[1] = stringAppend(tmpMeta[0],_OMC_LIT142);
tmp1 = tmpMeta[1];
goto tmp3_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,1) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_pats = tmpMeta[0];
tmp4 += 7;
_str = stringDelimitList(omc_List_map(threadData, _pats, boxvar_Patternm_patternStr), _OMC_LIT143);
tmpMeta[0] = stringAppend(_OMC_LIT144,_str);
tmpMeta[1] = stringAppend(tmpMeta[0],_OMC_LIT142);
tmp1 = tmpMeta[1];
goto tmp3_done;
}
case 5: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,1) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
_pats = tmpMeta[0];
tmp4 += 6;
_str = stringDelimitList(omc_List_map(threadData, _pats, boxvar_Patternm_patternStr), _OMC_LIT143);
tmpMeta[0] = stringAppend(_OMC_LIT144,_str);
tmpMeta[1] = stringAppend(tmpMeta[0],_OMC_LIT142);
tmp1 = tmpMeta[1];
goto tmp3_done;
}
case 6: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,6) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
_name = tmpMeta[0];
_pats = tmpMeta[1];
tmp4 += 5;
_id = omc_AbsynUtil_pathString(threadData, _name, _OMC_LIT145, 1, 0);
_str = stringDelimitList(omc_List_map(threadData, _pats, boxvar_Patternm_patternStr), _OMC_LIT143);
tmpMeta[0] = mmc_mk_cons(_id, mmc_mk_cons(_OMC_LIT144, mmc_mk_cons(_str, mmc_mk_cons(_OMC_LIT142, MMC_REFSTRUCTLIT(mmc_nil)))));
tmp1 = stringAppendList(tmpMeta[0]);
goto tmp3_done;
}
case 7: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,8,2) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
_name = tmpMeta[0];
_namedpats = tmpMeta[1];
tmp4 += 4;
_id = omc_AbsynUtil_pathString(threadData, _name, _OMC_LIT145, 1, 0);
_fields = omc_List_map(threadData, _namedpats, boxvar_Util_tuple32);
_patsStr = omc_List_map1r(threadData, omc_List_mapMap(threadData, _namedpats, boxvar_Util_tuple31, boxvar_Patternm_patternStr), boxvar_stringAppend, _OMC_LIT146);
_str = stringDelimitList(omc_List_threadMap(threadData, _fields, _patsStr, boxvar_stringAppend), _OMC_LIT143);
tmpMeta[0] = mmc_mk_cons(_id, mmc_mk_cons(_OMC_LIT144, mmc_mk_cons(_str, mmc_mk_cons(_OMC_LIT142, MMC_REFSTRUCTLIT(mmc_nil)))));
tmp1 = stringAppendList(tmpMeta[0]);
goto tmp3_done;
}
case 8: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,2) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
_head = tmpMeta[0];
_tail = tmpMeta[1];
tmp4 += 3;
tmpMeta[0] = stringAppend(omc_Patternm_patternStr(threadData, _head),_OMC_LIT147);
tmpMeta[1] = stringAppend(tmpMeta[0],omc_Patternm_patternStr(threadData, _tail));
tmp1 = tmpMeta[1];
goto tmp3_done;
}
case 9: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,2) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
_exp = tmpMeta[0];
tmp4 += 2;
tmp1 = omc_ExpressionDump_printExpStr(threadData, _exp);
goto tmp3_done;
}
case 10: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,4) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
_id = tmpMeta[0];
_pat = tmpMeta[1];
tmp4 += 1;
tmpMeta[0] = stringAppend(_id,_OMC_LIT148);
tmpMeta[1] = stringAppend(tmpMeta[0],omc_Patternm_patternStr(threadData, _pat));
tmp1 = tmpMeta[1];
goto tmp3_done;
}
case 11: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,2) == 0) goto tmp3_end;
tmpMeta[0] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
_id = tmpMeta[0];
_pat = tmpMeta[1];
tmpMeta[0] = stringAppend(_id,_OMC_LIT148);
tmpMeta[1] = stringAppend(tmpMeta[0],omc_Patternm_patternStr(threadData, _pat));
tmp1 = tmpMeta[1];
goto tmp3_done;
}
case 12: {
omc_Error_addMessage(threadData, _OMC_LIT65, _OMC_LIT150);
tmp1 = _OMC_LIT151;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 13) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_str = tmp1;
_return: OMC_LABEL_UNUSED
return _str;
}
PROTECTED_FUNCTION_STATIC void omc_Patternm_validUniontype(threadData_t *threadData, modelica_metatype _path1, modelica_metatype _path2, modelica_metatype _info, modelica_metatype _lhs)
{
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
{
modelica_string _s = NULL;
modelica_string _s1 = NULL;
modelica_string _s2 = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
modelica_boolean tmp5;
tmp5 = omc_AbsynUtil_pathEqual(threadData, _path1, _path2);
if (1 != tmp5) goto goto_1;
goto tmp2_done;
}
case 1: {
_s = omc_Dump_printExpStr(threadData, _lhs);
_s1 = omc_AbsynUtil_pathString(threadData, _path1, _OMC_LIT145, 1, 0);
_s2 = omc_AbsynUtil_pathString(threadData, _path2, _OMC_LIT145, 1, 0);
tmpMeta[0] = mmc_mk_cons(_s, mmc_mk_cons(_s1, mmc_mk_cons(_s2, MMC_REFSTRUCTLIT(mmc_nil))));
omc_Error_addSourceMessage(threadData, _OMC_LIT154, tmpMeta[0], _info);
goto goto_1;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 2) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
;
_return: OMC_LABEL_UNUSED
return;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_validPatternType(threadData_t *threadData, modelica_metatype _inTy1, modelica_metatype _inTy2, modelica_metatype _lhs, modelica_metatype _info)
{
modelica_metatype _ty = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp3_1;volatile modelica_metatype tmp3_2;
tmp3_1 = _inTy1;
tmp3_2 = _inTy2;
{
modelica_metatype _et = NULL;
modelica_string _s = NULL;
modelica_string _s1 = NULL;
modelica_string _s2 = NULL;
modelica_metatype _cr = NULL;
modelica_metatype _crefExp = NULL;
modelica_metatype _ty1 = NULL;
modelica_metatype _ty2 = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp2_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp3 < 3; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,23,1) == 0) goto tmp2_end;
tmpMeta[1] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 2));
_ty1 = tmpMeta[1];
_ty2 = tmp3_2;
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
_cr = omc_ComponentReference_makeCrefIdent(threadData, _OMC_LIT155, _OMC_LIT121, tmpMeta[1]);
_crefExp = omc_Expression_crefExp(threadData, _cr);
omc_Types_matchType(threadData, _crefExp, _ty1, _ty2, 1 ,&_ty1);
_et = omc_Types_simplifyType(threadData, _ty1);
tmpMeta[0] = mmc_mk_some(_et);
goto tmp2_done;
}
case 1: {
_ty1 = tmp3_1;
_ty2 = tmp3_2;
tmpMeta[1] = MMC_REFSTRUCTLIT(mmc_nil);
_cr = omc_ComponentReference_makeCrefIdent(threadData, _OMC_LIT155, _OMC_LIT121, tmpMeta[1]);
_crefExp = omc_Expression_crefExp(threadData, _cr);
omc_Types_matchType(threadData, _crefExp, _ty1, _ty2, 1, NULL);
tmpMeta[0] = mmc_mk_none();
goto tmp2_done;
}
case 2: {
_ty1 = tmp3_1;
_ty2 = tmp3_2;
_s = omc_Dump_printExpStr(threadData, _lhs);
_s1 = omc_Types_unparseType(threadData, _ty1);
_s2 = omc_Types_unparseType(threadData, _ty2);
tmpMeta[1] = mmc_mk_cons(_s, mmc_mk_cons(_s1, mmc_mk_cons(_s2, MMC_REFSTRUCTLIT(mmc_nil))));
omc_Error_addSourceMessage(threadData, _OMC_LIT158, tmpMeta[1], _info);
goto goto_1;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
tmp2_done:
(void)tmp3;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp2_done2;
goto_1:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp3 < 3) {
goto tmp2_top;
}
MMC_THROW_INTERNAL();
tmp2_done2:;
}
}
_ty = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _ty;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_checkForAllWildCall(threadData_t *threadData, modelica_metatype _args, modelica_metatype _named, modelica_integer _numFields, modelica_metatype *out_outNamed)
{
modelica_metatype _outArgs = NULL;
modelica_metatype _outNamed = NULL;
modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;
tmp4_1 = _args;
tmp4_2 = _named;
{
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_2)) goto tmp3_end;
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_1);
tmpMeta[3] = MMC_CDR(tmp4_1);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],2,1) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[4],4,0) == 0) goto tmp3_end;
if (!listEmpty(tmpMeta[3])) goto tmp3_end;
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[3] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0+0] = tmpMeta[2];
tmpMeta[0+1] = tmpMeta[3];
goto tmp3_done;
}
case 1: {
tmpMeta[0+0] = _args;
tmpMeta[0+1] = _named;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outArgs = tmpMeta[0+0];
_outNamed = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_outNamed) { *out_outNamed = _outNamed; }
return _outArgs;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_checkForAllWildCall(threadData_t *threadData, modelica_metatype _args, modelica_metatype _named, modelica_metatype _numFields, modelica_metatype *out_outNamed)
{
modelica_integer tmp1;
modelica_metatype _outArgs = NULL;
tmp1 = mmc_unbox_integer(_numFields);
_outArgs = omc_Patternm_checkForAllWildCall(threadData, _args, _named, tmp1, out_outNamed);
return _outArgs;
}
PROTECTED_FUNCTION_STATIC void omc_Patternm_checkMissingArgs(threadData_t *threadData, modelica_metatype _path, modelica_integer _numPosArgs, modelica_metatype _missingFieldNames, modelica_integer _numNamedArgs, modelica_metatype _info)
{
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;modelica_integer tmp3_2;
tmp3_1 = _missingFieldNames;
tmp3_2 = _numNamedArgs;
{
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (0 != tmp3_2) goto tmp2_end;
if (!listEmpty(tmp3_1)) goto tmp2_end;
goto tmp2_done;
}
case 1: {
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
;
_return: OMC_LABEL_UNUSED
return;
}
PROTECTED_FUNCTION_STATIC void boxptr_Patternm_checkMissingArgs(threadData_t *threadData, modelica_metatype _path, modelica_metatype _numPosArgs, modelica_metatype _missingFieldNames, modelica_metatype _numNamedArgs, modelica_metatype _info)
{
modelica_integer tmp1;
modelica_integer tmp2;
tmp1 = mmc_unbox_integer(_numPosArgs);
tmp2 = mmc_unbox_integer(_numNamedArgs);
omc_Patternm_checkMissingArgs(threadData, _path, tmp1, _missingFieldNames, tmp2, _info);
return;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabPatternCall(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _env, modelica_metatype _callPath, modelica_metatype _fargs, modelica_metatype _utPath, modelica_metatype _info, modelica_metatype _lhs, modelica_metatype *out_pattern)
{
modelica_metatype _outCache = NULL;
modelica_metatype _pattern = NULL;
modelica_metatype tmpMeta[10] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;volatile modelica_metatype tmp4_3;
tmp4_1 = _inCache;
tmp4_2 = _fargs;
tmp4_3 = _utPath;
{
modelica_string _s = NULL;
modelica_metatype _utPath1 = NULL;
modelica_metatype _utPath2 = NULL;
modelica_metatype _fqPath = NULL;
modelica_integer _index;
modelica_integer _numPosArgs;
modelica_metatype _namedArgList = NULL;
modelica_metatype _invalidArgs = NULL;
modelica_metatype _funcArgsNamedFixed = NULL;
modelica_metatype _funcArgs = NULL;
modelica_metatype _funcArgs2 = NULL;
modelica_metatype _fieldNameList = NULL;
modelica_metatype _fieldNamesNamed = NULL;
modelica_metatype _fieldTypeList = NULL;
modelica_metatype _typeVars = NULL;
modelica_metatype _fieldVarList = NULL;
modelica_metatype _patterns = NULL;
modelica_metatype _namedPatterns = NULL;
modelica_boolean _knownSingleton;
modelica_metatype _cache = NULL;
modelica_boolean _allWild;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 4; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
if (listEmpty(tmpMeta[2])) goto tmp3_end;
tmpMeta[3] = MMC_CAR(tmpMeta[2]);
tmpMeta[4] = MMC_CDR(tmpMeta[2]);
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
if (listEmpty(tmpMeta[5])) goto tmp3_end;
tmpMeta[6] = MMC_CAR(tmpMeta[5]);
tmpMeta[7] = MMC_CDR(tmpMeta[5]);
tmpMeta[2] = mmc_mk_cons(omc_AbsynUtil_pathString(threadData, _callPath, _OMC_LIT145, 1, 0), MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_addSourceMessage(threadData, _OMC_LIT162, tmpMeta[2], _info);
goto goto_2;
goto tmp3_done;
}
case 1: {
modelica_integer tmp6;
modelica_integer tmp7;
modelica_boolean tmp12 = 0;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
_funcArgs = tmpMeta[2];
_namedArgList = tmpMeta[3];
_cache = tmp4_1;
_utPath2 = tmp4_3;
_cache = omc_Lookup_lookupType(threadData, _cache, _env, _callPath, mmc_mk_none(), NULL, NULL);
tmpMeta[9] = omc_Lookup_lookupType(threadData, _cache, _env, _callPath, mmc_mk_none(), &tmpMeta[2], NULL);
_cache = tmpMeta[9];
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],21,6) == 0) goto goto_2;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 4));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 5));
tmp6 = mmc_unbox_integer(tmpMeta[6]);
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 6));
tmpMeta[8] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 7));
tmp7 = mmc_unbox_integer(tmpMeta[8]);
_fqPath = tmpMeta[3];
_utPath1 = tmpMeta[4];
_typeVars = tmpMeta[5];
_index = tmp6;
_fieldVarList = tmpMeta[7];
_knownSingleton = tmp7;
omc_Patternm_validUniontype(threadData, _utPath1, _utPath2, _info, _lhs);
_fieldTypeList = omc_List_map(threadData, _fieldVarList, boxvar_Types_getVarType);
_fieldNameList = omc_List_map(threadData, _fieldVarList, boxvar_Types_getVarName);
if(omc_Flags_isSet(threadData, _OMC_LIT3))
{
{
modelica_metatype _namedArg;
for (tmpMeta[2] = _namedArgList; !listEmpty(tmpMeta[2]); tmpMeta[2]=MMC_CDR(tmpMeta[2]))
{
_namedArg = MMC_CAR(tmpMeta[2]);
{
modelica_metatype tmp10_1;
tmp10_1 = _namedArg;
{
volatile mmc_switch_type tmp10;
int tmp11;
tmp10 = 0;
for (; tmp10 < 2; tmp10++) {
switch (MMC_SWITCH_CAST(tmp10)) {
case 0: {
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp10_1), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[3],2,1) == 0) goto tmp9_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[4],3,0) == 0) goto tmp9_end;
tmpMeta[3] = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_namedArg), 2))), MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_addSourceMessage(threadData, _OMC_LIT165, tmpMeta[3], _info);
goto tmp9_done;
}
case 1: {
goto tmp9_done;
}
}
goto tmp9_end;
tmp9_end: ;
}
goto goto_8;
goto_8:;
goto goto_2;
goto tmp9_done;
tmp9_done:;
}
}
;
}
}
if((listEmpty(_namedArgList) && (!listEmpty(_funcArgs))))
{
_allWild = 1;
{
modelica_metatype _arg;
for (tmpMeta[2] = _funcArgs; !listEmpty(tmpMeta[2]); tmpMeta[2]=MMC_CDR(tmpMeta[2]))
{
_arg = MMC_CAR(tmpMeta[2]);
{
modelica_metatype tmp15_1;
tmp15_1 = _arg;
{
volatile mmc_switch_type tmp15;
int tmp16;
tmp15 = 0;
for (; tmp15 < 2; tmp15++) {
switch (MMC_SWITCH_CAST(tmp15)) {
case 0: {
if (mmc__uniontype__metarecord__typedef__equal(tmp15_1,2,1) == 0) goto tmp14_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp15_1), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[3],3,0) == 0) goto tmp14_end;
tmp12 = 1;
goto tmp14_done;
}
case 1: {
tmp12 = 0;
goto tmp14_done;
}
}
goto tmp14_end;
tmp14_end: ;
}
goto goto_13;
goto_13:;
goto goto_2;
goto tmp14_done;
tmp14_done:;
}
}
_allWild = tmp12;
if((!_allWild))
{
break;
}
}
}
if(_allWild)
{
tmpMeta[2] = mmc_mk_cons(omc_AbsynUtil_pathString(threadData, _callPath, _OMC_LIT145, 1, 0), MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_addSourceMessage(threadData, _OMC_LIT168, tmpMeta[2], _info);
}
}
}
_funcArgs = omc_Patternm_checkForAllWildCall(threadData, _funcArgs, _namedArgList, listLength(_fieldNameList) ,&_namedArgList);
_numPosArgs = listLength(_funcArgs);
omc_List_split(threadData, _fieldNameList, _numPosArgs ,&_fieldNamesNamed);
omc_Patternm_checkMissingArgs(threadData, _fqPath, _numPosArgs, _fieldNamesNamed, listLength(_namedArgList), _info);
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
_funcArgsNamedFixed = omc_Patternm_generatePositionalArgs(threadData, _fieldNamesNamed, _namedArgList, tmpMeta[2] ,&_invalidArgs);
_funcArgs2 = listAppend(_funcArgs, _funcArgsNamedFixed);
tmpMeta[2] = omc_Patternm_checkInvalidPatternNamedArgs(threadData, _invalidArgs, _fieldNameList, _OMC_LIT169, _info);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],0,0) == 0) goto goto_2;
_cache = omc_Patternm_elabPatternTuple(threadData, _cache, _env, _funcArgs2, _fieldTypeList, _info, _lhs ,&_patterns);
tmpMeta[2] = mmc_mk_box7(10, &DAE_Pattern_PAT__CALL__desc, _fqPath, mmc_mk_integer(_index), _patterns, _fieldVarList, _typeVars, mmc_mk_boolean(_knownSingleton));
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[2];
goto tmp3_done;
}
case 2: {
modelica_boolean tmp17;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
_funcArgs = tmpMeta[2];
_namedArgList = tmpMeta[3];
_cache = tmp4_1;
_utPath2 = tmp4_3;
tmpMeta[7] = omc_Lookup_lookupType(threadData, _cache, _env, _callPath, mmc_mk_none(), &tmpMeta[2], NULL);
_cache = tmpMeta[7];
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],11,4) == 0) goto goto_2;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[3],9,3) == 0) goto goto_2;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[4],3,1) == 0) goto goto_2;
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 3));
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 5));
_fieldVarList = tmpMeta[5];
_fqPath = tmpMeta[6];
tmp17 = omc_AbsynUtil_pathEqual(threadData, _fqPath, _utPath2);
if (1 != tmp17) goto goto_2;
_fieldTypeList = omc_List_map(threadData, _fieldVarList, boxvar_Types_getVarType);
_fieldNameList = omc_List_map(threadData, _fieldVarList, boxvar_Types_getVarName);
_funcArgs = omc_Patternm_checkForAllWildCall(threadData, _funcArgs, _namedArgList, listLength(_fieldNameList) ,&_namedArgList);
_numPosArgs = listLength(_funcArgs);
omc_List_split(threadData, _fieldNameList, _numPosArgs ,&_fieldNamesNamed);
omc_Patternm_checkMissingArgs(threadData, _fqPath, _numPosArgs, _fieldNamesNamed, listLength(_namedArgList), _info);
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
_funcArgsNamedFixed = omc_Patternm_generatePositionalArgs(threadData, _fieldNamesNamed, _namedArgList, tmpMeta[2] ,&_invalidArgs);
_funcArgs2 = listAppend(_funcArgs, _funcArgsNamedFixed);
tmpMeta[2] = omc_Patternm_checkInvalidPatternNamedArgs(threadData, _invalidArgs, _fieldNameList, _OMC_LIT169, _info);
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],0,0) == 0) goto goto_2;
_cache = omc_Patternm_elabPatternTuple(threadData, _cache, _env, _funcArgs2, _fieldTypeList, _info, _lhs ,&_patterns);
_namedPatterns = omc_List_zip3(threadData, _patterns, _fieldNameList, omc_List_map(threadData, _fieldTypeList, boxvar_Types_simplifyType));
_namedPatterns = omc_List_filterOnTrue(threadData, _namedPatterns, boxvar_Patternm_filterEmptyPattern);
tmpMeta[2] = mmc_mk_box3(11, &DAE_Pattern_PAT__CALL__NAMED__desc, _fqPath, _namedPatterns);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[2];
goto tmp3_done;
}
case 3: {
modelica_boolean tmp18;
_cache = tmp4_1;
tmp18 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
omc_Lookup_lookupType(threadData, _cache, _env, _callPath, mmc_mk_none(), NULL, NULL);
tmp18 = 1;
goto goto_19;
goto_19:;
MMC_CATCH_INTERNAL(mmc_jumper)
if (tmp18) {goto goto_2;}
_s = omc_AbsynUtil_pathString(threadData, _callPath, _OMC_LIT145, 1, 0);
tmpMeta[2] = mmc_mk_cons(_s, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_addSourceMessage(threadData, _OMC_LIT172, tmpMeta[2], _info);
goto goto_2;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 4) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outCache = tmpMeta[0+0];
_pattern = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_pattern) { *out_pattern = _pattern; }
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabPatternTuple(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _env, modelica_metatype _inExps, modelica_metatype _inTys, modelica_metatype _info, modelica_metatype _lhs, modelica_metatype *out_patterns)
{
modelica_metatype _outCache = NULL;
modelica_metatype _patterns = NULL;
modelica_metatype tmpMeta[6] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;modelica_metatype tmp4_3;
tmp4_1 = _inCache;
tmp4_2 = _inExps;
tmp4_3 = _inTys;
{
modelica_metatype _exp = NULL;
modelica_string _s = NULL;
modelica_metatype _pattern = NULL;
modelica_metatype _ty = NULL;
modelica_metatype _cache = NULL;
modelica_metatype _exps = NULL;
modelica_metatype _tys = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 3; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_2)) goto tmp3_end;
if (!listEmpty(tmp4_3)) goto tmp3_end;
_cache = tmp4_1;
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[2];
goto tmp3_done;
}
case 1: {
if (listEmpty(tmp4_2)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_2);
tmpMeta[3] = MMC_CDR(tmp4_2);
if (listEmpty(tmp4_3)) goto tmp3_end;
tmpMeta[4] = MMC_CAR(tmp4_3);
tmpMeta[5] = MMC_CDR(tmp4_3);
_exp = tmpMeta[2];
_exps = tmpMeta[3];
_ty = tmpMeta[4];
_tys = tmpMeta[5];
_cache = tmp4_1;
_cache = omc_Patternm_elabPattern(threadData, _cache, _env, _exp, _ty, _info ,&_pattern);
_cache = omc_Patternm_elabPatternTuple(threadData, _cache, _env, _exps, _tys, _info, _lhs ,&_patterns);
tmpMeta[2] = mmc_mk_cons(_pattern, _patterns);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[2];
goto tmp3_done;
}
case 2: {
_s = omc_Dump_printExpStr(threadData, _lhs);
tmpMeta[2] = stringAppend(_OMC_LIT173,_s);
_s = tmpMeta[2];
tmpMeta[2] = mmc_mk_cons(_s, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_addSourceMessage(threadData, _OMC_LIT176, tmpMeta[2], _info);
goto goto_2;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outCache = tmpMeta[0+0];
_patterns = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_patterns) { *out_patterns = _patterns; }
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabPattern2(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _env, modelica_metatype _inLhs, modelica_metatype _ty, modelica_metatype _info, modelica_integer _numError, modelica_metatype *out_pattern)
{
modelica_metatype _outCache = NULL;
modelica_metatype _pattern = NULL;
modelica_metatype tmpMeta[11] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;volatile modelica_metatype tmp4_3;
tmp4_1 = _inCache;
tmp4_2 = _inLhs;
tmp4_3 = _ty;
{
modelica_metatype _exps = NULL;
modelica_metatype _tys = NULL;
modelica_metatype _patterns = NULL;
modelica_metatype _exp = NULL;
modelica_metatype _head = NULL;
modelica_metatype _tail = NULL;
modelica_string _id = NULL;
modelica_string _s = NULL;
modelica_string _str = NULL;
modelica_integer _i;
modelica_real _r;
modelica_boolean _b;
modelica_metatype _ty1 = NULL;
modelica_metatype _ty2 = NULL;
modelica_metatype _tyHead = NULL;
modelica_metatype _tyTail = NULL;
modelica_metatype _et = NULL;
modelica_metatype _patternHead = NULL;
modelica_metatype _patternTail = NULL;
modelica_metatype _fcr = NULL;
modelica_metatype _fargs = NULL;
modelica_metatype _utPath = NULL;
modelica_metatype _cache = NULL;
modelica_metatype _lhs = NULL;
modelica_metatype _attr = NULL;
modelica_metatype _elabExp = NULL;
modelica_metatype _const = NULL;
modelica_metatype _val = NULL;
modelica_metatype _variability = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 24; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
modelica_integer tmp6;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmp6 = mmc_unbox_integer(tmpMeta[2]);
_i = tmp6;
_cache = tmp4_1;
tmp4 += 22;
_et = omc_Patternm_validPatternType(threadData, _ty, _OMC_LIT123, _inLhs, _info);
tmpMeta[2] = mmc_mk_box2(3, &DAE_Exp_ICONST__desc, mmc_mk_integer(_i));
tmpMeta[3] = mmc_mk_box3(4, &DAE_Pattern_PAT__CONSTANT__desc, _et, tmpMeta[2]);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[3];
goto tmp3_done;
}
case 1: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
_str = tmpMeta[2];
_cache = tmp4_1;
tmp4 += 21;
_et = omc_Patternm_validPatternType(threadData, _ty, _OMC_LIT177, _inLhs, _info);
_r = stringReal(_str);
tmpMeta[2] = mmc_mk_box2(4, &DAE_Exp_RCONST__desc, mmc_mk_real(_r));
tmpMeta[3] = mmc_mk_box3(4, &DAE_Pattern_PAT__CONSTANT__desc, _et, tmpMeta[2]);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[3];
goto tmp3_done;
}
case 2: {
modelica_integer tmp7;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,6,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],6,0) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[3],0,1) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 2));
tmp7 = mmc_unbox_integer(tmpMeta[4]);
_i = tmp7;
_cache = tmp4_1;
tmp4 += 20;
_et = omc_Patternm_validPatternType(threadData, _ty, _OMC_LIT123, _inLhs, _info);
_i = (-_i);
tmpMeta[2] = mmc_mk_box2(3, &DAE_Exp_ICONST__desc, mmc_mk_integer(_i));
tmpMeta[3] = mmc_mk_box3(4, &DAE_Pattern_PAT__CONSTANT__desc, _et, tmpMeta[2]);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[3];
goto tmp3_done;
}
case 3: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,6,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],6,0) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[3],1,1) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 2));
_str = tmpMeta[4];
_cache = tmp4_1;
tmp4 += 19;
_et = omc_Patternm_validPatternType(threadData, _ty, _OMC_LIT177, _inLhs, _info);
_r = stringReal(_str);
_r = (-_r);
tmpMeta[2] = mmc_mk_box2(4, &DAE_Exp_RCONST__desc, mmc_mk_real(_r));
tmpMeta[3] = mmc_mk_box3(4, &DAE_Pattern_PAT__CONSTANT__desc, _et, tmpMeta[2]);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[3];
goto tmp3_done;
}
case 4: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,3,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
_s = tmpMeta[2];
_cache = tmp4_1;
tmp4 += 18;
_et = omc_Patternm_validPatternType(threadData, _ty, _OMC_LIT120, _inLhs, _info);
_s = omc_System_unescapedString(threadData, _s);
tmpMeta[2] = mmc_mk_box2(5, &DAE_Exp_SCONST__desc, _s);
tmpMeta[3] = mmc_mk_box3(4, &DAE_Pattern_PAT__CONSTANT__desc, _et, tmpMeta[2]);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[3];
goto tmp3_done;
}
case 5: {
modelica_integer tmp8;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,4,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmp8 = mmc_unbox_integer(tmpMeta[2]);
_b = tmp8;
_cache = tmp4_1;
tmp4 += 17;
_et = omc_Patternm_validPatternType(threadData, _ty, _OMC_LIT75, _inLhs, _info);
tmpMeta[2] = mmc_mk_box2(6, &DAE_Exp_BCONST__desc, mmc_mk_boolean(_b));
tmpMeta[3] = mmc_mk_box3(4, &DAE_Pattern_PAT__CONSTANT__desc, _et, tmpMeta[2]);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[3];
goto tmp3_done;
}
case 6: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,13,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
if (!listEmpty(tmpMeta[2])) goto tmp3_end;
_cache = tmp4_1;
tmp4 += 16;
_et = omc_Patternm_validPatternType(threadData, _ty, _OMC_LIT178, _inLhs, _info);
tmpMeta[2] = mmc_mk_box3(4, &DAE_Pattern_PAT__CONSTANT__desc, _et, _OMC_LIT179);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[2];
goto tmp3_done;
}
case 7: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,13,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
if (listEmpty(tmpMeta[2])) goto tmp3_end;
tmpMeta[3] = MMC_CAR(tmpMeta[2]);
tmpMeta[4] = MMC_CDR(tmpMeta[2]);
_exps = tmpMeta[2];
_cache = tmp4_1;
tmp4 += 15;
_lhs = omc_List_fold(threadData, listReverse(_exps), boxvar_AbsynUtil_makeCons, _OMC_LIT180);
tmpMeta[0+0] = omc_Patternm_elabPattern(threadData, _cache, _env, _lhs, _ty, _info, &tmpMeta[0+1]);
goto tmp3_done;
}
case 8: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,11,3) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],2,2) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
if (4 != MMC_STRLEN(tmpMeta[3]) || strcmp(MMC_STRINGDATA(_OMC_LIT190), MMC_STRINGDATA(tmpMeta[3])) != 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
if (!listEmpty(tmpMeta[4])) goto tmp3_end;
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[5],0,2) == 0) goto tmp3_end;
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[5]), 2));
if (!listEmpty(tmpMeta[6])) goto tmp3_end;
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[5]), 3));
if (!listEmpty(tmpMeta[7])) goto tmp3_end;
_cache = tmp4_1;
tmp4 += 4;
omc_Patternm_validPatternType(threadData, _ty, _OMC_LIT181, _inLhs, _info);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = _OMC_LIT183;
goto tmp3_done;
}
case 9: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_3,19,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,11,3) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[3],2,2) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 2));
if (4 != MMC_STRLEN(tmpMeta[4]) || strcmp(MMC_STRINGDATA(_OMC_LIT198), MMC_STRINGDATA(tmpMeta[4])) != 0) goto tmp3_end;
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 3));
if (!listEmpty(tmpMeta[5])) goto tmp3_end;
tmpMeta[6] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[6],0,2) == 0) goto tmp3_end;
tmpMeta[7] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[6]), 2));
if (listEmpty(tmpMeta[7])) goto tmp3_end;
tmpMeta[8] = MMC_CAR(tmpMeta[7]);
tmpMeta[9] = MMC_CDR(tmpMeta[7]);
if (!listEmpty(tmpMeta[9])) goto tmp3_end;
tmpMeta[10] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[6]), 3));
if (!listEmpty(tmpMeta[10])) goto tmp3_end;
_ty2 = tmpMeta[2];
_exp = tmpMeta[8];
_cache = tmp4_1;
tmp4 += 13;
_cache = omc_Patternm_elabPattern(threadData, _cache, _env, _exp, _ty2, _info ,&_pattern);
tmpMeta[2] = mmc_mk_box2(12, &DAE_Pattern_PAT__SOME__desc, _pattern);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[2];
goto tmp3_done;
}
case 10: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,20,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_3,17,1) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 2));
_head = tmpMeta[2];
_tail = tmpMeta[3];
_tyTail = tmp4_3;
_tyHead = tmpMeta[4];
_cache = tmp4_1;
tmp4 += 12;
_tyHead = omc_Types_boxIfUnboxedType(threadData, _tyHead);
_cache = omc_Patternm_elabPattern(threadData, _cache, _env, _head, _tyHead, _info ,&_patternHead);
_cache = omc_Patternm_elabPattern(threadData, _cache, _env, _tail, _tyTail, _info ,&_patternTail);
tmpMeta[2] = mmc_mk_box3(9, &DAE_Pattern_PAT__CONS__desc, _patternHead, _patternTail);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[2];
goto tmp3_done;
}
case 11: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,16,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_3,18,1) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 2));
_exps = tmpMeta[2];
_tys = tmpMeta[3];
_cache = tmp4_1;
tmp4 += 11;
_tys = omc_List_map(threadData, _tys, boxvar_Types_boxIfUnboxedType);
_cache = omc_Patternm_elabPatternTuple(threadData, _cache, _env, _exps, _tys, _info, _inLhs ,&_patterns);
tmpMeta[2] = mmc_mk_box2(7, &DAE_Pattern_PAT__META__TUPLE__desc, _patterns);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[2];
goto tmp3_done;
}
case 12: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,16,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_3,14,2) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 2));
_exps = tmpMeta[2];
_tys = tmpMeta[3];
_cache = tmp4_1;
tmp4 += 10;
_cache = omc_Patternm_elabPatternTuple(threadData, _cache, _env, _exps, _tys, _info, _inLhs ,&_patterns);
tmpMeta[2] = mmc_mk_box2(8, &DAE_Pattern_PAT__CALL__TUPLE__desc, _patterns);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[2];
goto tmp3_done;
}
case 13: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,11,3) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_3,9,3) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[4],3,1) == 0) goto tmp3_end;
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[4]), 2));
_lhs = tmp4_2;
_fcr = tmpMeta[2];
_fargs = tmpMeta[3];
_utPath = tmpMeta[5];
_cache = tmp4_1;
tmp4 += 9;
tmpMeta[0+0] = omc_Patternm_elabPatternCall(threadData, _cache, _env, omc_AbsynUtil_crefToPath(threadData, _fcr), _fargs, _utPath, _info, _lhs, &tmpMeta[0+1]);
goto tmp3_done;
}
case 14: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,11,3) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_3,20,5) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 6));
_lhs = tmp4_2;
_fcr = tmpMeta[2];
_fargs = tmpMeta[3];
_utPath = tmpMeta[4];
_cache = tmp4_1;
tmp4 += 8;
tmpMeta[0+0] = omc_Patternm_elabPatternCall(threadData, _cache, _env, omc_AbsynUtil_crefToPath(threadData, _fcr), _fargs, _utPath, _info, _lhs, &tmpMeta[0+1]);
goto tmp3_done;
}
case 15: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,11,3) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
if (mmc__uniontype__metarecord__typedef__equal(tmp4_3,21,6) == 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 3));
_lhs = tmp4_2;
_fcr = tmpMeta[2];
_fargs = tmpMeta[3];
_utPath = tmpMeta[4];
_cache = tmp4_1;
tmp4 += 7;
tmpMeta[0+0] = omc_Patternm_elabPatternCall(threadData, _cache, _env, omc_AbsynUtil_crefToPath(threadData, _fcr), _fargs, _utPath, _info, _lhs, &tmpMeta[0+1]);
goto tmp3_done;
}
case 16: {
modelica_boolean tmp9;
modelica_boolean tmp10 = 0;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,1) == 0) goto tmp3_end;
_cache = tmp4_1;
_ty1 = tmp4_3;
{
modelica_metatype tmp13_1;
tmp13_1 = omc_Types_unboxedType(threadData, _ty1);
{
int tmp13;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp13_1))) {
case 8: {
tmp10 = 1;
goto tmp12_done;
}
case 3: {
tmp10 = 1;
goto tmp12_done;
}
case 4: {
tmp10 = 1;
goto tmp12_done;
}
case 5: {
tmp10 = 1;
goto tmp12_done;
}
case 6: {
tmp10 = 1;
goto tmp12_done;
}
default:
tmp12_default: OMC_LABEL_UNUSED; {
tmp10 = 0;
goto tmp12_done;
}
}
goto tmp12_end;
tmp12_end: ;
}
goto goto_11;
goto_11:;
goto goto_2;
goto tmp12_done;
tmp12_done:;
}
}
tmp4 += 1;
if (!(omc_Types_isBoxedType(threadData, _ty1) || tmp10)) goto tmp3_end;
tmpMeta[6] = omc_Static_elabExp(threadData, _cache, _env, _inLhs, 0, 0, _OMC_LIT50, _info, &tmpMeta[2], &tmpMeta[3]);
_cache = tmpMeta[6];
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[3],0,2) == 0) goto goto_2;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 2));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 3));
_elabExp = tmpMeta[2];
_ty2 = tmpMeta[4];
_const = tmpMeta[5];
_et = omc_Patternm_validPatternType(threadData, _ty1, _ty2, _inLhs, _info);
tmp9 = omc_Types_isConstant(threadData, _const);
if (1 != tmp9) goto goto_2;
tmpMeta[2] = mmc_mk_box2(3, &Absyn_Msg_MSG__desc, _info);
_cache = omc_Ceval_ceval(threadData, _cache, _env, _elabExp, 0, tmpMeta[2], ((modelica_integer) 0) ,&_val);
_elabExp = omc_ValuesUtil_valueExp(threadData, _val, mmc_mk_none());
tmpMeta[2] = mmc_mk_box3(4, &DAE_Pattern_PAT__CONSTANT__desc, _et, _elabExp);
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = tmpMeta[2];
goto tmp3_done;
}
case 17: {
modelica_boolean tmp14;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,19,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
_id = tmpMeta[2];
_exp = tmpMeta[3];
_cache = tmp4_1;
_ty2 = tmp4_3;
tmp4 += 1;
tmpMeta[5] = omc_Lookup_lookupIdent(threadData, _cache, _env, _id, &tmpMeta[2], NULL, NULL, NULL, NULL);
_cache = tmpMeta[5];
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 4));
_attr = tmpMeta[3];
_ty1 = tmpMeta[4];
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[3] = mmc_mk_box3(5, &Absyn_ComponentRef_CREF__IDENT__desc, _id, tmpMeta[2]);
tmpMeta[4] = mmc_mk_box2(5, &Absyn_Exp_CREF__desc, tmpMeta[3]);
_lhs = tmpMeta[4];
omc_Static_checkAssignmentToInput(threadData, _lhs, _attr, _env, 0, _info);
_et = omc_Patternm_validPatternType(threadData, _ty2, _ty1, _inLhs, _info);
_cache = omc_Patternm_elabPattern(threadData, _cache, _env, _exp, _ty2, _info ,&_pattern);
tmp14 = (modelica_boolean)omc_Types_isFunctionType(threadData, _ty2);
if(tmp14)
{
tmpMeta[2] = mmc_mk_box3(6, &DAE_Pattern_PAT__AS__FUNC__PTR__desc, _id, _pattern);
tmpMeta[4] = tmpMeta[2];
}
else
{
tmpMeta[3] = mmc_mk_box5(5, &DAE_Pattern_PAT__AS__desc, _id, _et, _attr, _pattern);
tmpMeta[4] = tmpMeta[3];
}
_pattern = tmpMeta[4];
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = _pattern;
goto tmp3_done;
}
case 18: {
modelica_boolean tmp15;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],2,2) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
if (!listEmpty(tmpMeta[4])) goto tmp3_end;
_id = tmpMeta[3];
_cache = tmp4_1;
_ty2 = tmp4_3;
tmp4 += 1;
tmpMeta[6] = omc_Lookup_lookupIdent(threadData, _cache, _env, _id, &tmpMeta[2], NULL, NULL, NULL, NULL);
_cache = tmpMeta[6];
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[3]), 4));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 4));
_attr = tmpMeta[3];
_variability = tmpMeta[4];
_ty1 = tmpMeta[5];
if(omc_SCodeUtil_isParameterOrConst(threadData, _variability))
{
tmpMeta[2] = mmc_mk_cons(_id, mmc_mk_cons(omc_SCodeDump_unparseVariability(threadData, _variability), MMC_REFSTRUCTLIT(mmc_nil)));
omc_Error_addSourceMessage(threadData, _OMC_LIT186, tmpMeta[2], _info);
goto goto_2;
}
omc_Static_checkAssignmentToInput(threadData, _inLhs, _attr, _env, 0, _info);
_et = omc_Patternm_validPatternType(threadData, _ty2, _ty1, _inLhs, _info);
tmp15 = (modelica_boolean)omc_Types_isFunctionType(threadData, _ty2);
if(tmp15)
{
tmpMeta[2] = mmc_mk_box3(6, &DAE_Pattern_PAT__AS__FUNC__PTR__desc, _id, _OMC_LIT113);
tmpMeta[4] = tmpMeta[2];
}
else
{
tmpMeta[3] = mmc_mk_box5(5, &DAE_Pattern_PAT__AS__desc, _id, _et, _attr, _OMC_LIT113);
tmpMeta[4] = tmpMeta[3];
}
_pattern = tmpMeta[4];
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = _pattern;
goto tmp3_done;
}
case 19: {
modelica_boolean tmp16;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,19,2) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
_id = tmpMeta[2];
_cache = tmp4_1;
tmp4 += 3;
tmp16 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
omc_Lookup_lookupIdent(threadData, _cache, _env, _id, NULL, NULL, NULL, NULL, NULL);
tmp16 = 1;
goto goto_17;
goto_17:;
MMC_CATCH_INTERNAL(mmc_jumper)
if (tmp16) {goto goto_2;}
tmpMeta[2] = mmc_mk_cons(_id, mmc_mk_cons(_OMC_LIT36, MMC_REFSTRUCTLIT(mmc_nil)));
omc_Error_addSourceMessage(threadData, _OMC_LIT189, tmpMeta[2], _info);
goto goto_2;
goto tmp3_done;
}
case 20: {
modelica_boolean tmp18;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],2,2) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
if (4 != MMC_STRLEN(tmpMeta[3]) || strcmp(MMC_STRINGDATA(_OMC_LIT190), MMC_STRINGDATA(tmpMeta[3])) != 0) goto tmp3_end;
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
if (!listEmpty(tmpMeta[4])) goto tmp3_end;
_cache = tmp4_1;
tmp18 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
omc_Lookup_lookupIdent(threadData, _cache, _env, _OMC_LIT190, NULL, NULL, NULL, NULL, NULL);
tmp18 = 1;
goto goto_19;
goto_19:;
MMC_CATCH_INTERNAL(mmc_jumper)
if (tmp18) {goto goto_2;}
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
omc_Error_addSourceMessage(threadData, _OMC_LIT193, tmpMeta[2], _info);
goto goto_2;
goto tmp3_done;
}
case 21: {
modelica_boolean tmp20;
modelica_boolean tmp22;
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],2,2) == 0) goto tmp3_end;
tmpMeta[3] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
if (!listEmpty(tmpMeta[4])) goto tmp3_end;
_id = tmpMeta[3];
_cache = tmp4_1;
tmp4 += 1;
tmp20 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
omc_Lookup_lookupIdent(threadData, _cache, _env, _id, NULL, NULL, NULL, NULL, NULL);
tmp20 = 1;
goto goto_21;
goto_21:;
MMC_CATCH_INTERNAL(mmc_jumper)
if (tmp20) {goto goto_2;}
tmp22 = (stringEqual(_OMC_LIT190, _id));
if (0 != tmp22) goto goto_2;
tmpMeta[2] = mmc_mk_cons(_id, mmc_mk_cons(_OMC_LIT36, MMC_REFSTRUCTLIT(mmc_nil)));
omc_Error_addSourceMessage(threadData, _OMC_LIT189, tmpMeta[2], _info);
goto goto_2;
goto tmp3_done;
}
case 22: {
if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,1) == 0) goto tmp3_end;
tmpMeta[2] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
if (mmc__uniontype__metarecord__typedef__equal(tmpMeta[2],3,0) == 0) goto tmp3_end;
_cache = tmp4_1;
tmpMeta[0+0] = _cache;
tmpMeta[0+1] = _OMC_LIT113;
goto tmp3_done;
}
case 23: {
modelica_boolean tmp23;
_lhs = tmp4_2;
tmp23 = (_numError == omc_Error_getNumErrorMessages(threadData));
if (1 != tmp23) goto goto_2;
tmpMeta[2] = stringAppend(omc_Dump_printExpStr(threadData, _lhs),_OMC_LIT194);
tmpMeta[3] = stringAppend(tmpMeta[2],omc_Types_unparseType(threadData, _ty));
_str = tmpMeta[3];
tmpMeta[2] = mmc_mk_cons(_str, MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_addSourceMessage(threadData, _OMC_LIT197, tmpMeta[2], _info);
goto goto_2;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 24) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outCache = tmpMeta[0+0];
_pattern = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_pattern) { *out_pattern = _pattern; }
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_Patternm_elabPattern2(threadData_t *threadData, modelica_metatype _inCache, modelica_metatype _env, modelica_metatype _inLhs, modelica_metatype _ty, modelica_metatype _info, modelica_metatype _numError, modelica_metatype *out_pattern)
{
modelica_integer tmp1;
modelica_metatype _outCache = NULL;
tmp1 = mmc_unbox_integer(_numError);
_outCache = omc_Patternm_elabPattern2(threadData, _inCache, _env, _inLhs, _ty, _info, tmp1, out_pattern);
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_findBoundVariables(threadData_t *threadData, modelica_metatype _pat, modelica_metatype _boundVars, modelica_metatype *out_outBoundVars)
{
modelica_metatype _outPat = NULL;
modelica_metatype _outBoundVars = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outPat = _pat;
{
modelica_metatype tmp3_1;
tmp3_1 = _pat;
{
int tmp3;
{
switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
case 5: {
tmpMeta[1] = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_pat), 2))), _boundVars);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
case 6: {
tmpMeta[1] = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_pat), 2))), _boundVars);
tmpMeta[0] = tmpMeta[1];
goto tmp2_done;
}
default:
tmp2_default: OMC_LABEL_UNUSED; {
tmpMeta[0] = _boundVars;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outBoundVars = tmpMeta[0];
_return: OMC_LABEL_UNUSED
if (out_outBoundVars) { *out_outBoundVars = _outBoundVars; }
return _outPat;
}
PROTECTED_FUNCTION_STATIC void omc_Patternm_checkPatternsDuplicateAsBindings(threadData_t *threadData, modelica_metatype _patterns, modelica_metatype _info)
{
modelica_metatype _usedVariables = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
tmpMeta[0] = MMC_REFSTRUCTLIT(mmc_nil);
omc_Patternm_traversePatternList(threadData, _patterns, boxvar_Patternm_findBoundVariables, tmpMeta[0] ,&_usedVariables);
_usedVariables = omc_List_sortedUniqueOnlyDuplicates(threadData, omc_List_sort(threadData, _usedVariables, boxvar_Util_strcmpBool), boxvar_stringEq);
if((!listEmpty(_usedVariables)))
{
tmpMeta[0] = mmc_mk_cons(stringDelimitList(_usedVariables, _OMC_LIT58), MMC_REFSTRUCTLIT(mmc_nil));
omc_Error_addSourceMessage(threadData, _OMC_LIT201, tmpMeta[0], _info);
MMC_THROW_INTERNAL();
}
_return: OMC_LABEL_UNUSED
return;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_elabPattern(threadData_t *threadData, modelica_metatype _cache, modelica_metatype _env, modelica_metatype _lhs, modelica_metatype _ty, modelica_metatype _info, modelica_metatype *out_pattern)
{
modelica_metatype _outCache = NULL;
modelica_metatype _pattern = NULL;
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outCache = omc_Patternm_elabPattern2(threadData, _cache, _env, _lhs, _ty, _info, omc_Error_getNumErrorMessages(threadData) ,&_pattern);
_return: OMC_LABEL_UNUSED
if (out_pattern) { *out_pattern = _pattern; }
return _outCache;
}
DLLExport
modelica_metatype omc_Patternm_elabPatternCheckDuplicateBindings(threadData_t *threadData, modelica_metatype _cache, modelica_metatype _env, modelica_metatype _lhs, modelica_metatype _ty, modelica_metatype _info, modelica_metatype *out_pattern)
{
modelica_metatype _outCache = NULL;
modelica_metatype _pattern = NULL;
modelica_metatype tmpMeta[1] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
_outCache = omc_Patternm_elabPattern2(threadData, _cache, _env, _lhs, _ty, _info, omc_Error_getNumErrorMessages(threadData) ,&_pattern);
tmpMeta[0] = mmc_mk_cons(_pattern, MMC_REFSTRUCTLIT(mmc_nil));
omc_Patternm_checkPatternsDuplicateAsBindings(threadData, tmpMeta[0], _info);
_return: OMC_LABEL_UNUSED
if (out_pattern) { *out_pattern = _pattern; }
return _outCache;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_checkInvalidPatternNamedArgs(threadData_t *threadData, modelica_metatype _args, modelica_metatype _fieldNameList, modelica_metatype _status, modelica_metatype _info)
{
modelica_metatype _outStatus = NULL;
modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp3_1;
tmp3_1 = _args;
{
modelica_metatype _argsNames = NULL;
modelica_string _str1 = NULL;
modelica_string _str2 = NULL;
volatile mmc_switch_type tmp3;
int tmp4;
tmp3 = 0;
for (; tmp3 < 2; tmp3++) {
switch (MMC_SWITCH_CAST(tmp3)) {
case 0: {
if (!listEmpty(tmp3_1)) goto tmp2_end;
tmpMeta[0] = _status;
goto tmp2_done;
}
case 1: {
_argsNames = omc_AbsynUtil_getNamedFuncArgNamesAndValues(threadData, _args, NULL);
_str1 = stringDelimitList(_argsNames, _OMC_LIT143);
_str2 = stringDelimitList(_fieldNameList, _OMC_LIT143);
tmpMeta[1] = mmc_mk_cons(_str1, mmc_mk_cons(_str2, MMC_REFSTRUCTLIT(mmc_nil)));
omc_Error_addSourceMessage(threadData, _OMC_LIT204, tmpMeta[1], _info);
tmpMeta[0] = _OMC_LIT205;
goto tmp2_done;
}
}
goto tmp2_end;
tmp2_end: ;
}
goto goto_1;
goto_1:;
MMC_THROW_INTERNAL();
goto tmp2_done;
tmp2_done:;
}
}
_outStatus = tmpMeta[0];
_return: OMC_LABEL_UNUSED
return _outStatus;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_findFieldExpInList(threadData_t *threadData, modelica_string _firstFieldName, modelica_metatype _namedArgList, modelica_metatype *out_outNamedArgList)
{
modelica_metatype _outExp = NULL;
modelica_metatype _outNamedArgList = NULL;
modelica_metatype tmpMeta[6] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
volatile modelica_string tmp4_1;volatile modelica_metatype tmp4_2;
tmp4_1 = _firstFieldName;
tmp4_2 = _namedArgList;
{
modelica_metatype _e = NULL;
modelica_string _localFieldName = NULL;
modelica_string _aName = NULL;
modelica_metatype _rest = NULL;
modelica_metatype _first = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
MMC_TRY_INTERNAL(mmc_jumper)
tmp3_top:
threadData->mmc_jumper = &new_mmc_jumper;
for (; tmp4 < 3; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_2)) goto tmp3_end;
tmp4 += 2;
tmpMeta[2] = MMC_REFSTRUCTLIT(mmc_nil);
tmpMeta[0+0] = _OMC_LIT94;
tmpMeta[0+1] = tmpMeta[2];
goto tmp3_done;
}
case 1: {
modelica_boolean tmp6;
if (listEmpty(tmp4_2)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_2);
tmpMeta[3] = MMC_CDR(tmp4_2);
tmpMeta[4] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 2));
tmpMeta[5] = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta[2]), 3));
_aName = tmpMeta[4];
_e = tmpMeta[5];
_rest = tmpMeta[3];
_localFieldName = tmp4_1;
tmp6 = (stringEqual(_localFieldName, _aName));
if (1 != tmp6) goto goto_2;
tmpMeta[0+0] = _e;
tmpMeta[0+1] = _rest;
goto tmp3_done;
}
case 2: {
if (listEmpty(tmp4_2)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_2);
tmpMeta[3] = MMC_CDR(tmp4_2);
_first = tmpMeta[2];
_rest = tmpMeta[3];
_localFieldName = tmp4_1;
_e = omc_Patternm_findFieldExpInList(threadData, _localFieldName, _rest ,&_rest);
tmpMeta[2] = mmc_mk_cons(_first, _rest);
tmpMeta[0+0] = _e;
tmpMeta[0+1] = tmpMeta[2];
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
tmp3_done:
(void)tmp4;
MMC_RESTORE_INTERNAL(mmc_jumper);
goto tmp3_done2;
goto_2:;
MMC_CATCH_INTERNAL(mmc_jumper);
if (++tmp4 < 3) {
goto tmp3_top;
}
MMC_THROW_INTERNAL();
tmp3_done2:;
}
}
_outExp = tmpMeta[0+0];
_outNamedArgList = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_outNamedArgList) { *out_outNamedArgList = _outNamedArgList; }
return _outExp;
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_Patternm_generatePositionalArgs(threadData_t *threadData, modelica_metatype _fieldNameList, modelica_metatype _namedArgList, modelica_metatype _accList, modelica_metatype *out_outInvalidNames)
{
modelica_metatype _outList = NULL;
modelica_metatype _outInvalidNames = NULL;
modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
MMC_SO();
_tailrecursive: OMC_LABEL_UNUSED
{
modelica_metatype tmp4_1;modelica_metatype tmp4_2;modelica_metatype tmp4_3;
tmp4_1 = _fieldNameList;
tmp4_2 = _namedArgList;
tmp4_3 = _accList;
{
modelica_metatype _localAccList = NULL;
modelica_metatype _restFieldNames = NULL;
modelica_string _firstFieldName = NULL;
modelica_metatype _exp = NULL;
modelica_metatype _localNamedArgList = NULL;
volatile mmc_switch_type tmp4;
int tmp5;
tmp4 = 0;
for (; tmp4 < 2; tmp4++) {
switch (MMC_SWITCH_CAST(tmp4)) {
case 0: {
if (!listEmpty(tmp4_1)) goto tmp3_end;
_localAccList = tmp4_3;
tmpMeta[0+0] = listReverse(_localAccList);
tmpMeta[0+1] = _namedArgList;
goto tmp3_done;
}
case 1: {
if (listEmpty(tmp4_1)) goto tmp3_end;
tmpMeta[2] = MMC_CAR(tmp4_1);
tmpMeta[3] = MMC_CDR(tmp4_1);
_firstFieldName = tmpMeta[2];
_restFieldNames = tmpMeta[3];
_localNamedArgList = tmp4_2;
_localAccList = tmp4_3;
_exp = omc_Patternm_findFieldExpInList(threadData, _firstFieldName, _localNamedArgList ,&_localNamedArgList);
tmpMeta[2] = mmc_mk_cons(_exp, _localAccList);
_fieldNameList = _restFieldNames;
_namedArgList = _localNamedArgList;
_accList = tmpMeta[2];
goto _tailrecursive;
goto tmp3_done;
}
}
goto tmp3_end;
tmp3_end: ;
}
goto goto_2;
goto_2:;
MMC_THROW_INTERNAL();
goto tmp3_done;
tmp3_done:;
}
}
_outList = tmpMeta[0+0];
_outInvalidNames = tmpMeta[0+1];
_return: OMC_LABEL_UNUSED
if (out_outInvalidNames) { *out_outInvalidNames = _outInvalidNames; }
return _outList;
}
