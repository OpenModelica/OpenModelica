TEST=../../../rtest -v

TESTFILES=\
arrfunc.mo \
Binding1.mo \
bindings1.mo \
bindings4.mo \
bindings5.mo \
bindings7.mo \
BooleanDim.mo \
builtinmod.mo \
builtinmod2.mo \
BuiltinTime.mo \
ceval1.mo \
ceval2.mo \
ceval3.mo \
ceval5.mo \
ceval6.mo \
ClassAsComponentError.mo \
ClassExtends1.mo \
ClassExtends2.mo \
ClassExtends3.mo \
ClassExtendsBuiltin1.mo \
ClassExtendsBuiltin2.mo \
ClassExtendsMissing1.mo \
ClassMod1.mo \
ClassMod2.mo \
CompAsFunc.mo \
ComponentAsTypeError.mo \
cond4.mo \
conn1.mo \
conn2.mo \
conn4.mo \
const1.mo \
const2.mo \
const10.mo \
const11.mo \
const13.mo \
const14.mo \
const15.mo \
const16.mo \
const17.mo \
const3.mo \
dim1.mo \
dim13.mo \
dim18.mo \
dim3.mo \
dim8.mo \
DuplicateElements1.mo \
DuplicateElements2.mo \
DuplicateElements3.mo \
DuplicateElements4.mo \
DuplicateElementsValid1.mo \
DuplicateMod1.mo \
DuplicateMod2.mo \
DuplicateMod3.mo \
DuplicateMod4.mo \
DuplicateMod5.mo \
enum1.mo \
enum2.mo \
enum3.mo \
enum4.mo \
enum5.mo \
enum7.mo \
enum8.mo \
eq1.mo \
eq10.mo \
Extends1.mo \
Extends2.mo \
Extends3.mo \
Extends4.mo \
ExtendImport1.mo \
ExtendImport2.mo \
ExtendReplaceable1.mo \
ExtendReplaceable2.mo \
ExtendReplaceable3.mo \
ExtendReplaceable4.mo \
ExtendSections.mo \
ExtendSelf1.mo \
ExtendSelf2.mo \
ExtendSelf3.mo \
ForEquation1.mo \
ForEquation2.mo \
ForEquation3.mo \
ForEquation4.mo \
ForEquation5.mo \
ForEquationEnum1.mo \
ForEquationNonParam.mo \
ForStatement1.mo \
ForStatement2.mo \
ForStatementArray.mo \
ForStatementNonVector.mo \
ForStatementPrefix.mo \
FuncBuiltinAbs.mo \
FuncBuiltinCeil.mo \
FuncBuiltinDelay.mo \
FuncBuiltinDer.mo \
FuncBuiltinDiv.mo \
FuncBuiltinEdge.mo \
FuncBuiltinFloor.mo \
FuncBuiltinGetInstanceName.mo \
FuncBuiltinHomotopy.mo \
FuncBuiltinInitial.mo \
FuncBuiltinInteger.mo \
FuncBuiltinMath.mo \
FuncBuiltinMod.mo \
FuncBuiltinRem.mo \
FuncBuiltinSemiLinear.mo \
FuncBuiltinSign.mo \
FuncBuiltinSqrt.mo \
FuncBuiltinTerminal.mo \
FuncClassParam.mo \
FuncExtends.mo \
FuncInnerParam.mo \
FuncInteger.mo \
FuncIntegerWrongType.mo \
FuncLocals.mo \
FuncMissingDefault1.mo \
FuncMissingDefault2.mo \
FuncOverloadAmbiguousDefault.mo \
FuncOverloadExactPrefer.mo \
FuncOverloadMulti.mo \
FuncOverloadNoMatch.mo \
FuncOverloadSimple.mo \
FuncSimple.mo \
FuncString.mo \
FuncStringInvalid1.mo \
FuncStringInvalid2.mo \
FuncVariability.mo \
FuncViaComp.mo \
FuncWildcard.mo \
FuncWrongType.mo \
ih1.mo \
ih2.mo \
ih3.mo \
ImportNamed1.mo \
ImportNamed2.mo \
ImportNamedInvalid1.mo \
ImportNested1.mo \
ImportNested2.mo \
ImportQualified1.mo \
ImportQualifiedInvalid1.mo \
ImportQualifiedInvalid2.mo \
ImportUnqualified1.mo \
ImportUnqualified2.mo \
ImportUnqualified3.mo \
inst2.mo \
inst3.mo \
inst4.mo \
inst5.mo \
inst8.mo \
lookup1.mo \
lookup2.mo \
lookup3.mo \
lookup4.mo \
loop2.mo \
mod1.mo \
mod10.mo \
mod11.mo \
mod12.mo \
mod4.mo \
mod5.mo \
mod6.mo \
mod8.mo \
mod9.mo \
ModClass1.mo \
ModClass3.mo \
ModClass6.mo \
NonexistentRedeclareModifier1.mo \
NonexistentRedeclareModifier2.mo \
PackageConstant1.mo \
ParameterBug.mos \
PropagateExtends.mo \
RangeInvalidStep1.mo \
RangeInvalidStep2.mo \
RangeInvalidStep3.mo \
RangeTypeError1.mo \
RangeTypeError1.mo \
RangeTypeError2.mo \
RangeTypeError2.mo \
RangeTypeError3.mo \
RecursiveExtends1.mo \
RedeclareClass1.mo \
RedeclareElementMissing1.mo \
RedeclareElementMissing2.mo \
redeclare1.mo \
redeclare11.mo \
redeclare12.mo \
redeclare13.mo \
redeclare2.mo \
redeclare6.mo \
redeclare7.mo \
redeclare9.mo \
Size1.mo \
SizeInvalidArgs1.mo \
SizeInvalidArgs2.mo \
SizeInvalidType1.mo \
SizeInvalidType2.mo \
Subscript1.mo \
type2.mo \
usertype1.mo \
usertype2.mo \
usertype3.mo \
usertype4.mo \
usertype5.mo \
usertype6.mo \
when1.mo \

# test that currently fail. Move up when fixed.
# Run make testfailing
FAILINGTESTFILES=\
DuplicateElements5.mo \
DuplicateElements6.mo \
DuplicateElements7.mo \
DuplicateElements8.mo \
DuplicateElementsValid2.mo \
classextends3.mo \
ModClass2.mo \
ModClass4.mo \
ModClass5.mo \
DuplicateElementsCond1.mo \
bindings2.mo \
bindings3.mo \
ceval4.mo \
compfunc.mo \
cond1.mo \
cond2.mo \
cond3.mo \
conn10.mo \
conn11.mo \
conn3.mo \
conn5.mo \
conn6.mo \
conn7.mo \
conn8.mo \
conngraph1.mo \
conngraph2.mo \
const12.mo \
const4.mo \
const5.mo \
const6.mo \
const7.mo \
const8.mo \
ConstantConnector1.mo \
ConstantConnector2.mo \
ConstantConnector3.mo \
dim10.mo \
dim12.mo \
dim14.mo \
dim15.mo \
dim16.mo \
dim17.mo \
dim19.mo \
dim2.mo \
dim4.mo \
dim5.mo \
dim6.mo \
dim7.mo \
enum6.mo \
eq2.mo \
eq3.mo \
eq4.mo \
eq5.mo \
eq6.mo \
eq7.mo \
eq8.mo \
eq9.mo \
expconn1.mo \
expconn2.mo \
expconn3.mo \
expconn4.mo \
expconn5.mo \
expconn6.mo \
expconn7.mo \
extends1.mo \
extends2.mo \
ExtendsVisibility.mo \
ForEquationEnum2.mo \
func1.mo \
func2.mo \
func4.mo \
func8.mo \
FuncBuiltinCardinality.mo \
FuncBuiltinChange.mo \
FuncBuiltinCross.mo \
FuncBuiltinDiagonal.mo \
FuncBuiltinEnumTypeName.mo \
FuncBuiltinFill.mo \
FuncBuiltinIdentity.mo \
FuncBuiltinLinspace.mo \
FuncBuiltinMatrix.mo \
FuncBuiltinMax.mo \
FuncBuiltinMin.mo \
FuncBuiltinNdims.mo \
FuncBuiltinNoEvent.mo \
FuncBuiltinOnes.mo \
FuncBuiltinOuterProduct.mo \
FuncBuiltinPre.mo \
FuncBuiltinProduct.mo \
FuncBuiltinReduction.mo \
FuncBuiltinReinit.mo \
FuncBuiltinSample.mo \
FuncBuiltinScalar.mo \
FuncBuiltinSize.mo \
FuncBuiltinSkew.mo \
FuncBuiltinSmooth.mo \
FuncBuiltinSpatialDistribution.mo \
FuncBuiltinSum.mo \
FuncBuiltinSymmetric.mo \
FuncBuiltinTranspose.mo \
FuncBuiltinVector.mo \
FuncBuiltinZeros.mo \
function1.mo \
FunctionRecordArg1.mo \
ImportConflict1.mo \
ImportShadowing1.mo \
inst1.mo \
inst6.mo \
inst7.mo \
InvalidComplexConnectorType1.mo \
InvalidComplexConnectorType2.mo \
InvalidComplexConnectorType3.mo \
InvalidComplexConnectorType4.mo \
InvalidComplexConnectorType5.mo \
InvalidConnectorDirection1.mo \
InvalidConnectorDirection2.mo \
InvalidConnectorDirection3.mo \
InvalidConnectorDirection4.mo \
InvalidConnectorType1.mo \
InvalidConnectorType2.mo \
InvalidConnectorType3.mo \
InvalidConnectorType4.mo \
InvalidConnectorType5.mo \
InvalidConnectorType6.mo \
InvalidExpandableConnector1.mo \
InvalidVariability1.mo \
InvalidVariability2.mo \
loop1.mo \
loop3.mo \
loop4.mo \
MissingRedeclare1.mo \
mod13.mo \
mod7.mo \
MultiInheritanceRedeclare1.mo \
MultiInheritanceRedeclare2.mo \
noretcall1.mo \
PartialInst.mo \
PropagateRedeclareMod1.mo \
Range1.mo \
RecursiveExtends2.mo \
redeclare10.mo \
redeclare3.mo \
redeclare4.mo \
redeclare5.mo \
redeclare8.mo \
RedeclaredFunction1.mo \
type1.mo \
type3.mo \
type4.mo \
type5.mo \

# Dependency files that are not .mo .mos or Makefile
# Add them here or they will be cleaned.
DEPENDENCIES = \
*.mo \
*.mos \
Makefile \
CMakeLists.txt \
ExternalFunction1_f.c \
ExternalFunction2_f.c \
ExternalFunction3-addmatrices.c \
FlatParse.mof \
SmallPlantModified.mof \
VERSION.texi \
addReal1_.c \
drmodelica \
modtest.info \
modtest.texi \
msl

CLEAN = `ls | grep -w -v -f deps.tmp`

.PHONY : test failingtest clean getdeps

test :
	@echo
	@echo Running tests...
	@echo
	@$(TEST) $(TESTFILES)

failingtest :
	@echo
	@echo Running failing tests...
	@echo
	@$(TEST) $(FAILINGTESTFILES)
